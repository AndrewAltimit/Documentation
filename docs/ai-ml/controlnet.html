<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ControlNet Guide | Andrews Notebook</title>
  <meta name="description" content="Technology and Physics notes">
  
  <link rel="canonical" href="https://andrewaltimit.github.io/Documentation/docs/ai-ml/controlnet.html">
  
  <link rel="stylesheet" href="/Documentation/assets/css/main.css">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ControlNet Guide | Andrews Notebook</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="ControlNet Guide" />
<meta name="author" content="Andrew" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Technology and Physics notes" />
<meta property="og:description" content="Technology and Physics notes" />
<link rel="canonical" href="https://andrewaltimit.github.io/Documentation/docs/ai-ml/controlnet.html" />
<meta property="og:url" content="https://andrewaltimit.github.io/Documentation/docs/ai-ml/controlnet.html" />
<meta property="og:site_name" content="Andrews Notebook" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ControlNet Guide" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Andrew"},"description":"Technology and Physics notes","headline":"ControlNet Guide","url":"https://andrewaltimit.github.io/Documentation/docs/ai-ml/controlnet.html"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://andrewaltimit.github.io/Documentation/feed.xml" title="Andrews Notebook" />
</head>
<body>
  <div class="site">
    


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://andrewaltimit.github.io/Documentation/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/Documentation/docs" itemprop="item"><span itemprop="name">Docs</span></a>
          <meta itemprop="position" content="2">
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/Documentation/ai-ml" itemprop="item"><span itemprop="name">Ai ml</span></a>
          <meta itemprop="position" content="3">
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">ControlNet Guide</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="ControlNet Guide">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">ControlNet Guide
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-cog"></i> On This Page</h4></header>
              <ul class="toc__menu">
<li><a href="#how-controlnet-works">How ControlNet Works</a></li>
<li>
<a href="#pose-control">Pose Control</a><ul>
<li><a href="#openpose">OpenPose</a></li>
<li><a href="#dwpose">DWPose</a></li>
</ul>
</li>
<li>
<a href="#edge-detection">Edge Detection</a><ul>
<li><a href="#canny-edge">Canny Edge</a></li>
<li><a href="#mlsd-m-lsd">MLSD (M-LSD)</a></li>
<li><a href="#softedge-hedpidi">SoftEdge (HED/PIDI)</a></li>
</ul>
</li>
<li>
<a href="#depth-control">Depth Control</a><ul>
<li><a href="#midas">MiDaS</a></li>
<li><a href="#zoe-depth">Zoe Depth</a></li>
<li><a href="#leres">LeReS</a></li>
</ul>
</li>
<li>
<a href="#semantic-control">Semantic Control</a><ul>
<li><a href="#segmentation">Segmentation</a></li>
<li><a href="#normal-maps">Normal Maps</a></li>
</ul>
</li>
<li>
<a href="#line-art-control">Line Art Control</a><ul>
<li><a href="#anime-line-art">Anime Line Art</a></li>
<li><a href="#scribble">Scribble</a></li>
</ul>
</li>
<li>
<a href="#special-controls">Special Controls</a><ul>
<li><a href="#shuffle">Shuffle</a></li>
<li><a href="#tile">Tile</a></li>
<li><a href="#inpaint">Inpaint</a></li>
</ul>
</li>
<li><a href="#comfyui-installation">ComfyUI Installation</a></li>
<li><a href="#required-components">Required Components</a></li>
<li><a href="#simple-controlnet-workflow">Simple ControlNet Workflow</a></li>
<li><a href="#multi-controlnet-setup">Multi-ControlNet Setup</a></li>
<li><a href="#controlnet-parameters">ControlNet Parameters</a></li>
<li><a href="#strength-scheduling">Strength Scheduling</a></li>
<li>
<a href="#multiple-control-combinations">Multiple Control Combinations</a><ul>
<li><a href="#pose--depth">Pose + Depth</a></li>
<li><a href="#edge--segmentation">Edge + Segmentation</a></li>
</ul>
</li>
<li><a href="#control-mode-selection">Control Mode Selection</a></li>
<li><a href="#resolution-considerations">Resolution Considerations</a></li>
<li><a href="#image-preparation">Image Preparation</a></li>
<li><a href="#preprocessor-selection">Preprocessor Selection</a></li>
<li><a href="#custom-preprocessing">Custom Preprocessing</a></li>
<li><a href="#controlnet-versions">ControlNet Versions</a></li>
<li><a href="#t2i-adapter">T2I-Adapter</a></li>
<li><a href="#character-consistency">Character Consistency</a></li>
<li><a href="#architecture-visualization">Architecture Visualization</a></li>
<li><a href="#style-transfer-with-structure">Style Transfer with Structure</a></li>
<li>
<a href="#common-issues">Common Issues</a><ul>
<li><a href="#preprocessor-not-detecting-features">Preprocessor Not Detecting Features</a></li>
<li><a href="#over-controlling-generation">Over-controlling Generation</a></li>
<li><a href="#artifacts-at-edges">Artifacts at Edges</a></li>
</ul>
</li>
<li><a href="#performance-optimization">Performance Optimization</a></li>
<li><a href="#hybrid-controls">Hybrid Controls</a></li>
<li><a href="#temporal-consistency">Temporal Consistency</a></li>
<li><a href="#interactive-control">Interactive Control</a></li>
<li><a href="#dos">Do‚Äôs</a></li>
<li><a href="#donts">Don‚Äôts</a></li>
<li><a href="#emerging-controlnet-technologies">Emerging ControlNet Technologies</a></li>
<li><a href="#integration-trends">Integration Trends</a></li>
</ul>

            </nav>
          </aside>
        
        <aside class="sidebar sticky">
  <nav class="nav__list">
    
      
        <h3 class="nav__title">Getting Started</h3>
        
          <ul class="nav__items">
            
              <li>
                <a href="/Documentation/docs/topic-map/">
                  <span class="nav__sub-title">üó∫Ô∏è Interactive Topic Map</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/git-crash-course.html">
                  <span class="nav__sub-title">üå± Git in 5 Minutes</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/docker-crash-course.html">
                  <span class="nav__sub-title">üå± Docker in 5 Minutes</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/database-crash-course.html">
                  <span class="nav__sub-title">üå± Databases in 5 Minutes</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/ai-fundamentals-simple.html">
                  <span class="nav__sub-title">üå± AI Fundamentals Simple</span>
                </a>
              </li>
            
          </ul>
        
      
        <h3 class="nav__title">Technology</h3>
        
          <ul class="nav__items">
            
              <li>
                <a href="/Documentation/docs/technology/index.html">
                  <span class="nav__sub-title">Technology Overview</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/terraform.html">
                  <span class="nav__sub-title">Terraform</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/docker.html">
                  <span class="nav__sub-title">Docker Containers</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/aws.html">
                  <span class="nav__sub-title">AWS</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/kubernetes.html">
                  <span class="nav__sub-title">Kubernetes</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/database-design.html">
                  <span class="nav__sub-title">Database Design</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/networking.html">
                  <span class="nav__sub-title">Networking</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/cybersecurity.html">
                  <span class="nav__sub-title">Cybersecurity</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/git.html">
                  <span class="nav__sub-title">Git Version Control</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/branching.html">
                  <span class="nav__sub-title">Branching Strategies</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/unreal.html">
                  <span class="nav__sub-title">Unreal Engine</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/quantumcomputing.html">
                  <span class="nav__sub-title">Quantum Computing</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/ai.html">
                  <span class="nav__sub-title">Artificial Intelligence</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/ai-lecture-2023.html">
                  <span class="nav__sub-title">AI Lecture 2023</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/technology/please-build.html">
                  <span class="nav__sub-title">Please Build</span>
                </a>
              </li>
            
          </ul>
        
      
        <h3 class="nav__title">AI/ML - Generative AI</h3>
        
          <ul class="nav__items">
            
              <li>
                <a href="/Documentation/docs/ai-ml/index.html">
                  <span class="nav__sub-title">AI/ML Overview</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/stable-diffusion-fundamentals.html">
                  <span class="nav__sub-title">Stable Diffusion Fundamentals</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/base-models-comparison.html">
                  <span class="nav__sub-title">Base Models Comparison</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/model-types.html">
                  <span class="nav__sub-title">Model Types</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/lora-training.html">
                  <span class="nav__sub-title">LoRA Training</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/controlnet.html" class="active">
                  <span class="nav__sub-title">ControlNet Guide</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/comfyui-guide.html">
                  <span class="nav__sub-title">ComfyUI Guide</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/output-formats.html">
                  <span class="nav__sub-title">Output Formats</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/ai-ml/advanced-techniques.html">
                  <span class="nav__sub-title">Advanced Techniques</span>
                </a>
              </li>
            
          </ul>
        
      
        <h3 class="nav__title">Physics</h3>
        
          <ul class="nav__items">
            
              <li>
                <a href="/Documentation/docs/physics/index.html">
                  <span class="nav__sub-title">Physics Overview</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/classical-mechanics.html">
                  <span class="nav__sub-title">Classical Mechanics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/thermodynamics.html">
                  <span class="nav__sub-title">Thermodynamics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/statistical-mechanics.html">
                  <span class="nav__sub-title">Statistical Mechanics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/relativity.html">
                  <span class="nav__sub-title">Relativity</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/quantum-mechanics.html">
                  <span class="nav__sub-title">Quantum Mechanics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/condensed-matter.html">
                  <span class="nav__sub-title">Condensed Matter Physics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/quantum-field-theory.html">
                  <span class="nav__sub-title">Quantum Field Theory</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/physics/string-theory.html">
                  <span class="nav__sub-title">String Theory</span>
                </a>
              </li>
            
          </ul>
        
      
        <h3 class="nav__title">Advanced Topics</h3>
        
          <ul class="nav__items">
            
              <li>
                <a href="/Documentation/docs/advanced/index.html">
                  <span class="nav__sub-title">Research Hub</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/advanced/ai-mathematics/">
                  <span class="nav__sub-title">AI Mathematics</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/advanced/distributed-systems-theory/">
                  <span class="nav__sub-title">Distributed Systems Theory</span>
                </a>
              </li>
            
              <li>
                <a href="/Documentation/docs/advanced/quantum-algorithms-research/">
                  <span class="nav__sub-title">Quantum Algorithms Research</span>
                </a>
              </li>
            
          </ul>
        
      
    
  </nav>
</aside>

<div class="hero-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 3rem 2rem; margin: -2rem -3rem 2rem -3rem; text-align: center;">
  <h1 style="color: white; margin: 0; font-size: 2.5rem;">ControlNet Guide</h1>
  <p style="font-size: 1.25rem; margin-top: 1rem; opacity: 0.9;">Master ControlNet for precise control over AI image generation using poses, edges, depth, and more.</p>
</div>

<h2 id="what-is-controlnet">What is ControlNet?</h2>

<p>ControlNet is a neural network architecture that adds spatial control to diffusion models. It allows you to guide image generation using various types of conditioning inputs like human poses, edge maps, depth maps, and more, while maintaining the quality and capabilities of the base model.</p>

<h3 id="how-controlnet-works">How ControlNet Works</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input Image ‚Üí Preprocessor ‚Üí Control Map
                                ‚Üì
Text Prompt ‚Üí Base Model + ControlNet ‚Üí Controlled Output
</code></pre></div></div>

<p>ControlNet creates a trainable copy of the diffusion model‚Äôs encoder blocks, which learns to respond to specific spatial conditions while preserving the original model‚Äôs generation capabilities.</p>

<h2 id="controlnet-types">ControlNet Types</h2>

<h3 id="pose-control">Pose Control</h3>

<h4 id="openpose">OpenPose</h4>
<p>Detects human body keypoints and skeleton structure.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Human pose transfer</span>
<span class="na">Keypoints</span><span class="pi">:</span> <span class="s">18-25 body points</span>
<span class="na">Includes</span><span class="pi">:</span> <span class="s">Body, hands, face</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Character consistency, pose reference</span>
</code></pre></div></div>

<p><strong>Preprocessor Options</strong>:</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">openpose_full</code>: Body + hands + face</li>
  <li>
<code class="language-plaintext highlighter-rouge">openpose_body</code>: Body only</li>
  <li>
<code class="language-plaintext highlighter-rouge">openpose_hand</code>: Hands focus</li>
  <li>
<code class="language-plaintext highlighter-rouge">openpose_face</code>: Face landmarks</li>
</ul>

<p><strong>Example Workflow</strong>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Reference</span> <span class="n">Image</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">OpenPose</span> <span class="n">Preprocessor</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Pose</span> <span class="n">Skeleton</span><span class="p">]</span>
                                                    <span class="err">‚Üì</span>
<span class="sh">"</span><span class="s">A warrior in armor</span><span class="sh">"</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">ControlNet</span> <span class="n">OpenPose</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Posed</span> <span class="n">Character</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="dwpose">DWPose</h4>
<p>More accurate pose estimation with better occlusion handling.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Advantages</span><span class="pi">:</span> <span class="s">Better accuracy, stable tracking</span>
<span class="na">Keypoints</span><span class="pi">:</span> <span class="s">More detailed skeleton</span>
<span class="na">Performance</span><span class="pi">:</span> <span class="s">Slower but more reliable</span>
<span class="na">Use case</span><span class="pi">:</span> <span class="s">Complex poses, partial visibility</span>
</code></pre></div></div>

<h3 id="edge-detection">Edge Detection</h3>

<h4 id="canny-edge">Canny Edge</h4>
<p>Classic edge detection algorithm for clean line extraction.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Preserve shapes and outlines</span>
<span class="na">Parameters</span><span class="pi">:</span> <span class="s">Low/High threshold</span>
<span class="na">Output</span><span class="pi">:</span> <span class="s">Binary edge map</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Architecture, objects, clean lines</span>
</code></pre></div></div>

<p><strong>Parameter Guide</strong>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="sh">"</span><span class="s">low_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>   <span class="c1"># Lower = more edges
</span>    <span class="sh">"</span><span class="s">high_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>  <span class="c1"># Higher = fewer edges
</span><span class="p">}</span>
</code></pre></div></div>

<h4 id="mlsd-m-lsd">MLSD (M-LSD)</h4>
<p>Detects straight lines and geometric structures.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Architectural elements</span>
<span class="na">Specialty</span><span class="pi">:</span> <span class="s">Straight line detection</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Buildings, interiors, technical drawings</span>
</code></pre></div></div>

<h4 id="softedge-hedpidi">SoftEdge (HED/PIDI)</h4>
<p>Preserves more subtle edge information.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Methods</span><span class="pi">:</span> <span class="s">HED, PIDI, PidiNet</span>
<span class="na">Purpose</span><span class="pi">:</span> <span class="s">Artistic edge preservation</span>  
<span class="na">Quality</span><span class="pi">:</span> <span class="s">Softer, more natural edges</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Organic subjects, artistic styles</span>
</code></pre></div></div>

<h3 id="depth-control">Depth Control</h3>

<h4 id="midas">MiDaS</h4>
<p>Monocular depth estimation for general scenes.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Versions</span><span class="pi">:</span> <span class="s">MiDaS v2.1, v3.0</span>
<span class="na">Resolution</span><span class="pi">:</span> <span class="s">Multiple model sizes</span>
<span class="na">Output</span><span class="pi">:</span> <span class="s">Relative depth map</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">General depth control</span>
</code></pre></div></div>

<h4 id="zoe-depth">Zoe Depth</h4>
<p>More accurate depth estimation with metric depth.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Accuracy</span><span class="pi">:</span> <span class="s">Superior to MiDaS</span>
<span class="na">Type</span><span class="pi">:</span> <span class="s">Metric depth (actual distances)</span>
<span class="na">Training</span><span class="pi">:</span> <span class="s">NYU Depth v2, KITTI</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Realistic depth, outdoor scenes</span>
</code></pre></div></div>

<h4 id="leres">LeReS</h4>
<p>Learning to Recover 3D Scene Shape.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Quality</span><span class="pi">:</span> <span class="s">High quality depth</span>
<span class="na">Features</span><span class="pi">:</span> <span class="s">Handles complex scenes</span>
<span class="na">Speed</span><span class="pi">:</span> <span class="s">Slower than MiDaS</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Complex compositions</span>
</code></pre></div></div>

<h3 id="semantic-control">Semantic Control</h3>

<h4 id="segmentation">Segmentation</h4>
<p>Uses semantic segmentation maps for region-based control.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Models</span><span class="pi">:</span> <span class="s">ADE20K, COCO, custom</span>
<span class="na">Classes</span><span class="pi">:</span> <span class="s">150+ object categories</span>
<span class="na">Control</span><span class="pi">:</span> <span class="s">Per-region styling</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Scene composition</span>
</code></pre></div></div>

<p><strong>Color Mapping Example</strong>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">segmentation_colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">sky</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">134</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">249</span><span class="p">],</span>
    <span class="sh">"</span><span class="s">building</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span>
    <span class="sh">"</span><span class="s">tree</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="sh">"</span><span class="s">person</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="sh">"</span><span class="s">ground</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="normal-maps">Normal Maps</h4>
<p>Surface normal information for 3D-aware generation.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">3D surface orientation</span>
<span class="na">Format</span><span class="pi">:</span> <span class="s">RGB encoded normals</span>
<span class="na">Use case</span><span class="pi">:</span> <span class="s">3D consistency, lighting</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Products, sculptures</span>
</code></pre></div></div>

<h3 id="line-art-control">Line Art Control</h3>

<h4 id="anime-line-art">Anime Line Art</h4>
<p>Extracts clean lines suitable for anime/manga style.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Anime/manga line extraction</span>
<span class="na">Cleanliness</span><span class="pi">:</span> <span class="s">Very clean lines</span>
<span class="na">Style</span><span class="pi">:</span> <span class="s">Manga-appropriate</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Anime characters, manga</span>
</code></pre></div></div>

<h4 id="scribble">Scribble</h4>
<p>Converts rough sketches to control inputs.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Modes</span><span class="pi">:</span> <span class="s">Scribble, Fake Scribble</span>
<span class="na">Input</span><span class="pi">:</span> <span class="s">Hand-drawn sketches</span>
<span class="na">Tolerance</span><span class="pi">:</span> <span class="s">High noise tolerance</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Quick ideation</span>
</code></pre></div></div>

<h3 id="special-controls">Special Controls</h3>

<h4 id="shuffle">Shuffle</h4>
<p>Rearranges image content while preserving style.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Style transfer with layout change</span>
<span class="na">Method</span><span class="pi">:</span> <span class="s">Spatial shuffling</span>
<span class="na">Randomness</span><span class="pi">:</span> <span class="s">Controllable</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Creative variations</span>
</code></pre></div></div>

<h4 id="tile">Tile</h4>
<p>Enables tiled/seamless generation and upscaling.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Purpose</span><span class="pi">:</span> <span class="s">Seamless textures, upscaling</span>
<span class="na">Method</span><span class="pi">:</span> <span class="s">Overlapping tiles</span>
<span class="na">Quality</span><span class="pi">:</span> <span class="s">Maintains consistency</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Patterns, super-resolution</span>
</code></pre></div></div>

<h4 id="inpaint">Inpaint</h4>
<p>Specialized control for masked region generation.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Input</span><span class="pi">:</span> <span class="s">Image + Mask</span>
<span class="na">Control</span><span class="pi">:</span> <span class="s">Only masked areas</span>
<span class="na">Blending</span><span class="pi">:</span> <span class="s">Seamless integration</span>
<span class="na">Best for</span><span class="pi">:</span> <span class="s">Object removal, editing</span>
</code></pre></div></div>

<h2 id="installation-and-setup">Installation and Setup</h2>

<h3 id="comfyui-installation">ComfyUI Installation</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Install ControlNet models</span>
<span class="nb">cd </span>ComfyUI/models/controlnet

<span class="c"># Download models (example)</span>
wget https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11p_sd15_openpose.pth
wget https://huggingface.co/lllyasviel/ControlNet-v1-1/resolve/main/control_v11f1p_sd15_depth.pth
</code></pre></div></div>

<h3 id="required-components">Required Components</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Core</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">ComfyUI-ControlNet-Aux (preprocessors)</span>
<span class="pi">-</span> <span class="s">ControlNet models (specific to base model)</span>
<span class="pi">-</span> <span class="s">Base diffusion model (SD 1.5, SDXL, etc.)</span>

<span class="na">Optional</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">Custom preprocessors</span>
<span class="pi">-</span> <span class="s">Additional ControlNet models</span>
</code></pre></div></div>

<h2 id="basic-workflows">Basic Workflows</h2>

<h3 id="simple-controlnet-workflow">Simple ControlNet Workflow</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ComfyUI nodes
</span><span class="p">[</span><span class="n">Load</span> <span class="n">Image</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">ControlNet</span> <span class="n">Preprocessor</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="n">Control</span> <span class="n">Image</span>
                                               <span class="err">‚Üì</span>
<span class="p">[</span><span class="n">Load</span> <span class="n">ControlNet</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Apply</span> <span class="n">ControlNet</span><span class="p">]</span> <span class="err">‚Üê</span> <span class="p">[</span><span class="n">Positive</span> <span class="n">Prompt</span><span class="p">]</span>
                            <span class="err">‚Üì</span>
                    <span class="p">[</span><span class="n">KSampler</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">VAE</span> <span class="n">Decode</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Save</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="multi-controlnet-setup">Multi-ControlNet Setup</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Stack multiple ControlNets
</span><span class="p">[</span><span class="n">OpenPose</span> <span class="n">Control</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Apply</span> <span class="n">ControlNet</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="err">‚Üì</span>
<span class="p">[</span><span class="n">Depth</span> <span class="n">Control</span><span class="p">]</span> <span class="err">‚Üí</span> <span class="p">[</span><span class="n">Apply</span> <span class="n">ControlNet</span> <span class="mi">2</span><span class="p">]</span>
                            <span class="err">‚Üì</span>
                    <span class="p">[</span><span class="n">KSampler</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="controlnet-parameters">ControlNet Parameters</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>        <span class="c1"># 0-2, control influence
</span>    <span class="sh">"</span><span class="s">start_percent</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>   <span class="c1"># When to start applying
</span>    <span class="sh">"</span><span class="s">end_percent</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>     <span class="c1"># When to stop applying
</span>    <span class="sh">"</span><span class="s">control_mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">balanced</span><span class="sh">"</span><span class="p">,</span> <span class="c1"># balanced/prompt/control
</span><span class="p">}</span>
</code></pre></div></div>

<h2 id="advanced-techniques">Advanced Techniques</h2>

<h3 id="strength-scheduling">Strength Scheduling</h3>

<p>Vary ControlNet influence during generation:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reduce control over time for more creativity
</span><span class="n">strength_schedule</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>    <span class="c1"># Full control at start
</span>    <span class="mf">0.5</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># Reduce midway
</span>    <span class="mf">0.8</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Minimal at end
</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="multiple-control-combinations">Multiple Control Combinations</h3>

<h4 id="pose--depth">Pose + Depth</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Character in specific pose with depth
</span><span class="n">controls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">openpose</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
    <span class="p">{</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">depth</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div></div>

<h4 id="edge--segmentation">Edge + Segmentation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Precise shapes with semantic regions
</span><span class="n">controls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">canny</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
    <span class="p">{</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">segmentation</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div></div>

<h3 id="control-mode-selection">Control Mode Selection</h3>

<table>
  <thead>
    <tr>
      <th>Mode</th>
      <th>Description</th>
      <th>Use Case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Balanced</td>
      <td>Equal weight to prompt and control</td>
      <td>General use</td>
    </tr>
    <tr>
      <td>Prompt</td>
      <td>Prioritize text prompt</td>
      <td>Creative freedom</td>
    </tr>
    <tr>
      <td>Control</td>
      <td>Prioritize ControlNet</td>
      <td>Exact matching</td>
    </tr>
  </tbody>
</table>

<h3 id="resolution-considerations">Resolution Considerations</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ControlNet resolution tips
</span><span class="k">if</span> <span class="n">base_model</span> <span class="o">==</span> <span class="sh">"</span><span class="s">SD1.5</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">control_res</span> <span class="o">=</span> <span class="mi">512</span>
<span class="k">elif</span> <span class="n">base_model</span> <span class="o">==</span> <span class="sh">"</span><span class="s">SDXL</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">control_res</span> <span class="o">=</span> <span class="mi">1024</span>
    
<span class="c1"># Preprocess to match
</span><span class="n">control_image</span> <span class="o">=</span> <span class="nf">resize_image</span><span class="p">(</span><span class="n">input_image</span><span class="p">,</span> <span class="n">control_res</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="preprocessing-best-practices">Preprocessing Best Practices</h2>

<h3 id="image-preparation">Image Preparation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">prepare_control_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">control_type</span><span class="p">):</span>
    <span class="c1"># Ensure correct resolution
</span>    <span class="n">image</span> <span class="o">=</span> <span class="nf">resize_to_model_resolution</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    
    <span class="c1"># Enhance contrast for edge detection
</span>    <span class="k">if</span> <span class="n">control_type</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">canny</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">mlsd</span><span class="sh">"</span><span class="p">]:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="nf">enhance_contrast</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    
    <span class="c1"># Denoise for cleaner extraction
</span>    <span class="k">if</span> <span class="n">control_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">openpose</span><span class="sh">"</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="nf">denoise</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">image</span>
</code></pre></div></div>

<h3 id="preprocessor-selection">Preprocessor Selection</h3>

<table>
  <thead>
    <tr>
      <th>Input Quality</th>
      <th>Recommended Preprocessor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Clean photo</td>
      <td>Standard preprocessor</td>
    </tr>
    <tr>
      <td>Noisy image</td>
      <td>Robust variants (DW, LeReS+)</td>
    </tr>
    <tr>
      <td>Artistic</td>
      <td>Soft variants (HED, PIDI)</td>
    </tr>
    <tr>
      <td>Technical</td>
      <td>Precise variants (MLSD)</td>
    </tr>
  </tbody>
</table>

<h3 id="custom-preprocessing">Custom Preprocessing</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create custom control maps
</span><span class="kn">import</span> <span class="n">cv2</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">custom_edge_detection</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c1"># Combine multiple edge detectors
</span>    <span class="n">canny</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nc">Canny</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">laplacian</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nc">Laplacian</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">CV_64F</span><span class="p">)</span>
    
    <span class="c1"># Weighted combination
</span>    <span class="n">combined</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">canny</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">laplacian</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combined</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="model-compatibility">Model Compatibility</h2>

<h3 id="controlnet-versions">ControlNet Versions</h3>

<table>
  <thead>
    <tr>
      <th>Base Model</th>
      <th>ControlNet Version</th>
      <th>File Pattern</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SD 1.5</td>
      <td>v1.1</td>
      <td>control_v11<em>_sd15_</em>.pth</td>
    </tr>
    <tr>
      <td>SD 2.1</td>
      <td>v1.1 SD2</td>
      <td>control_v11<em>_sd21_</em>.pth</td>
    </tr>
    <tr>
      <td>SDXL</td>
      <td>SDXL</td>
      <td>controlnet-<em>-sdxl-</em>.safetensors</td>
    </tr>
    <tr>
      <td>FLUX</td>
      <td>Coming Soon</td>
      <td>TBD</td>
    </tr>
  </tbody>
</table>

<h3 id="t2i-adapter">T2I-Adapter</h3>

<p>Alternative to ControlNet with different characteristics:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Advantages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">Smaller model size (~80MB vs ~1.4GB)</span>
<span class="pi">-</span> <span class="s">Faster inference</span>
<span class="pi">-</span> <span class="s">Multiple adapters combinable</span>

<span class="na">Disadvantages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">Sometimes less precise</span>
<span class="pi">-</span> <span class="s">Fewer available types</span>
</code></pre></div></div>

<h2 id="common-workflows">Common Workflows</h2>

<h3 id="character-consistency">Character Consistency</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Maintain character across poses
</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">reference_image</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">character_reference.png</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">preprocessor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">openpose_full</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">prompt_template</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">character_name, {pose_description}</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">seed</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">fixed_for_consistency</span><span class="sh">"</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="architecture-visualization">Architecture Visualization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Technical drawing to render
</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">line_drawing</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">floor_plan.png</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">preprocessor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">mlsd</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">prompt</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">modern house interior, photorealistic</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">control_strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">cfg_scale</span><span class="sh">"</span><span class="p">:</span> <span class="mf">7.5</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="style-transfer-with-structure">Style Transfer with Structure</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Preserve composition, change style
</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">content_image</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">photo.jpg</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">preprocessors</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">depth</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">softedge</span><span class="sh">"</span><span class="p">],</span>
    <span class="sh">"</span><span class="s">style_prompt</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">oil painting in the style of van gogh</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">control_balance</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">depth</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">softedge</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.5</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="common-issues">Common Issues</h3>

<h4 id="preprocessor-not-detecting-features">Preprocessor Not Detecting Features</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Solutions
</span><span class="o">-</span> <span class="n">Increase</span> <span class="n">image</span> <span class="n">contrast</span>
<span class="o">-</span> <span class="n">Try</span> <span class="n">different</span> <span class="n">preprocessor</span> <span class="n">variant</span>
<span class="o">-</span> <span class="n">Adjust</span> <span class="n">detection</span> <span class="n">thresholds</span>
<span class="o">-</span> <span class="n">Use</span> <span class="n">manual</span> <span class="n">annotation</span> <span class="n">tools</span>
</code></pre></div></div>

<h4 id="over-controlling-generation">Over-controlling Generation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reduce control influence
</span><span class="p">{</span>
    <span class="sh">"</span><span class="s">strength</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="c1"># Lower from 1.0
</span>    <span class="sh">"</span><span class="s">end_percent</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>  <span class="c1"># Stop control early
</span>    <span class="sh">"</span><span class="s">cfg_scale</span><span class="sh">"</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>  <span class="c1"># Increase prompt importance
</span><span class="p">}</span>
</code></pre></div></div>

<h4 id="artifacts-at-edges">Artifacts at Edges</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Edge artifact mitigation
</span><span class="o">-</span> <span class="n">Use</span> <span class="n">softedge</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">canny</span>
<span class="o">-</span> <span class="n">Blur</span> <span class="n">control</span> <span class="nb">map</span> <span class="n">slightly</span>
<span class="o">-</span> <span class="n">Reduce</span> <span class="n">control</span> <span class="n">strength</span> <span class="n">at</span> <span class="n">boundaries</span>
<span class="o">-</span> <span class="n">Enable</span> <span class="sh">"</span><span class="s">soft</span><span class="sh">"</span> <span class="n">control</span> <span class="n">mode</span>
</code></pre></div></div>

<h3 id="performance-optimization">Performance Optimization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Memory-efficient ControlNet
</span><span class="p">{</span>
    <span class="sh">"</span><span class="s">low_vram_mode</span><span class="sh">"</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">preprocessor_device</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">control_net_device</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">cuda</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">offload_when_unused</span><span class="sh">"</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="creative-applications">Creative Applications</h2>

<h3 id="hybrid-controls">Hybrid Controls</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Combine photo and sketch
</span><span class="n">photo_depth</span> <span class="o">=</span> <span class="nf">extract_depth</span><span class="p">(</span><span class="n">photo</span><span class="p">)</span>
<span class="n">sketch_lines</span> <span class="o">=</span> <span class="nf">process_sketch</span><span class="p">(</span><span class="n">drawing</span><span class="p">)</span>
<span class="n">combined_control</span> <span class="o">=</span> <span class="nf">blend_controls</span><span class="p">(</span><span class="n">photo_depth</span><span class="p">,</span> <span class="n">sketch_lines</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="temporal-consistency">Temporal Consistency</h3>

<p>For animations:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Frame-to-frame consistency
</span><span class="n">previous_control</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">video_frames</span><span class="p">:</span>
    <span class="n">current_control</span> <span class="o">=</span> <span class="nf">extract_pose</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">previous_control</span><span class="p">:</span>
        <span class="c1"># Smooth between frames
</span>        <span class="n">current_control</span> <span class="o">=</span> <span class="nf">interpolate_controls</span><span class="p">(</span>
            <span class="n">previous_control</span><span class="p">,</span> <span class="n">current_control</span><span class="p">,</span> <span class="mf">0.3</span>
        <span class="p">)</span>
    <span class="nf">generate_frame</span><span class="p">(</span><span class="n">current_control</span><span class="p">)</span>
    <span class="n">previous_control</span> <span class="o">=</span> <span class="n">current_control</span>
</code></pre></div></div>

<h3 id="interactive-control">Interactive Control</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Real-time adjustment
</span><span class="k">class</span> <span class="nc">InteractiveControl</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">update_strength</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">control_strength</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">regenerate</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">switch_preprocessor</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">new_type</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">control_map</span> <span class="o">=</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nb">input</span><span class="p">,</span> <span class="n">new_type</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">regenerate</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<h3 id="dos">Do‚Äôs</h3>
<p>‚úì Match control resolution to model resolution<br>
‚úì Use appropriate preprocessor for input type<br>
‚úì Experiment with strength values<br>
‚úì Combine multiple controls thoughtfully<br>
‚úì Save successful control maps for reuse</p>

<h3 id="donts">Don‚Äôts</h3>
<p>‚úó Don‚Äôt use 100% control strength always<br>
‚úó Don‚Äôt ignore prompt importance<br>
‚úó Don‚Äôt use incompatible model versions<br>
‚úó Don‚Äôt expect perfect results immediately<br>
‚úó Don‚Äôt overstack controls (3+ rarely helpful)</p>

<h2 id="future-developments">Future Developments</h2>

<h3 id="emerging-controlnet-technologies">Emerging ControlNet Technologies</h3>

<ol>
  <li>
<strong>3D-Aware Control</strong>: Full 3D scene understanding</li>
  <li>
<strong>Video ControlNet</strong>: Temporal consistency</li>
  <li>
<strong>Semantic Editing</strong>: Natural language control</li>
  <li>
<strong>Adaptive Control</strong>: Self-adjusting strength</li>
  <li>
<strong>Neural Controls</strong>: Learned control patterns</li>
</ol>

<h3 id="integration-trends">Integration Trends</h3>

<ul>
  <li>Real-time control preview</li>
  <li>Mobile-optimized controls</li>
  <li>Cloud-based preprocessing</li>
  <li>AI-assisted control creation</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>ControlNet transforms diffusion models from probabilistic generators into precision tools. By understanding the various control types and their optimal applications, you can achieve unprecedented control over AI image generation while maintaining the creative capabilities of the base models.</p>

<p>The key to mastery is experimentation: try different preprocessors, adjust strengths, and combine controls creatively. As the technology evolves, ControlNet continues to bridge the gap between artistic vision and AI capabilities.</p>




<div class="learning-mode-container" id="learning-mode-container">
  <button class="learning-mode-button" onclick="toggleLearningMode()" aria-label="Toggle learning mode">
    <svg class="mode-icon" width="20" height="20" fill="currentColor" viewbox="0 0 16 16">
      <path d="M8.211 2.047a.5.5 0 0 0-.422 0l-7.5 3.5a.5.5 0 0 0 .025.917l7.5 3a.5.5 0 0 0 .372 0L14 7.14V13a1 1 0 0 0-1 1v2h3v-2a1 1 0 0 0-1-1V6.739l.686-.275a.5.5 0 0 0 .025-.917l-7.5-3.5ZM8 8.46 1.758 5.965 8 3.052l6.242 2.913L8 8.46Z"></path>
      <path d="M4.176 9.032a.5.5 0 0 0-.656.327l-.5 1.7a.5.5 0 0 0 .294.605l4.5 1.8a.5.5 0 0 0 .372 0l4.5-1.8a.5.5 0 0 0 .294-.605l-.5-1.7a.5.5 0 0 0-.656-.327L8 10.466 4.176 9.032Zm-.068 1.873.86-.23a.5.5 0 0 0 .372 0l2.66-.71.66 2.246L8 11.98l-3.892.156.5-1.231Z"></path>
    </svg>
    <span class="mode-text">Learning Mode</span>
    <span class="mode-status" id="mode-status">OFF</span>
  </button>
  
  <div class="learning-mode-panel" id="learning-mode-panel" style="display: none;">
    <div class="panel-header">
      <h3>Personalized Learning Mode</h3>
      <button class="close-panel" onclick="closeLearningPanel()">√ó</button>
    </div>
    
    <div class="panel-content">
      <div class="skill-level-section">
        <h4>Select Your Skill Level</h4>
        <div class="level-cards">
          <label class="level-card">
            <input type="radio" name="skill-level" value="beginner" onchange="updateSkillLevel('beginner')">
            <div class="card-content">
              <span class="level-emoji">üå±</span>
              <span class="level-name">Beginner</span>
              <span class="level-desc">New to this topic</span>
            </div>
          </label>
          
          <label class="level-card">
            <input type="radio" name="skill-level" value="intermediate" onchange="updateSkillLevel('intermediate')">
            <div class="card-content">
              <span class="level-emoji">üåø</span>
              <span class="level-name">Intermediate</span>
              <span class="level-desc">Some experience</span>
            </div>
          </label>
          
          <label class="level-card">
            <input type="radio" name="skill-level" value="advanced" onchange="updateSkillLevel('advanced')">
            <div class="card-content">
              <span class="level-emoji">üå≥</span>
              <span class="level-name">Advanced</span>
              <span class="level-desc">Deep knowledge</span>
            </div>
          </label>
        </div>
      </div>
      
      <div class="learning-preferences">
        <h4>Learning Preferences</h4>
        <div class="preference-options">
          <label class="preference-option">
            <input type="checkbox" id="show-prerequisites" checked onchange="updatePreferences()">
            <span>Show prerequisites for each topic</span>
          </label>
          
          <label class="preference-option">
            <input type="checkbox" id="highlight-next-steps" checked onchange="updatePreferences()">
            <span>Highlight recommended next steps</span>
          </label>
          
          <label class="preference-option">
            <input type="checkbox" id="adaptive-difficulty" onchange="updatePreferences()">
            <span>Automatically adjust difficulty based on progress</span>
          </label>
          
          <label class="preference-option">
            <input type="checkbox" id="track-progress" checked onchange="updatePreferences()">
            <span>Track my learning progress</span>
          </label>
        </div>
      </div>
      
      <div class="progress-overview">
        <h4>Your Learning Journey</h4>
        <div class="journey-stats">
          <div class="stat-card">
            <span class="stat-value" id="pages-read">0</span>
            <span class="stat-label">Pages Read</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="topics-completed">0</span>
            <span class="stat-label">Topics Completed</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="current-streak">0</span>
            <span class="stat-label">Day Streak</span>
          </div>
        </div>
        
        <div class="recent-topics">
          <h5>Recently Viewed</h5>
          <ul id="recent-topics-list">
            <li class="empty-state">No topics viewed yet</li>
          </ul>
        </div>
      </div>
      
      <div class="panel-actions">
        <button class="action-btn secondary" onclick="resetProgress()">Reset Progress</button>
        <button class="action-btn primary" onclick="applyLearningMode()">Apply Settings</button>
      </div>
    </div>
  </div>
  
  <!-- Floating indicators when learning mode is active -->
  <div class="learning-indicators" id="learning-indicators" style="display: none;">
    <div class="indicator skill-level-indicator">
      <span class="indicator-label">Level:</span>
      <span class="indicator-value" id="current-skill-level">Intermediate</span>
    </div>
    
    <div class="indicator next-step-indicator" id="next-step-indicator" style="display: none;">
      <span class="indicator-label">Next:</span>
      <a href="#" class="indicator-link" id="next-step-link">Loading...</a>
    </div>
  </div>
</div>

<script>
// Learning mode state
let learningMode = {
  enabled: false,
  skillLevel: 'intermediate',
  preferences: {
    showPrerequisites: true,
    highlightNextSteps: true,
    adaptiveDifficulty: false,
    trackProgress: true
  },
  progress: {
    pagesRead: [],
    topicsCompleted: [],
    lastVisit: null,
    streak: 0
  }
};

// Initialize from localStorage
function initializeLearningMode() {
  const saved = localStorage.getItem('learningMode');
  if (saved) {
    learningMode = JSON.parse(saved);
    if (learningMode.enabled) {
      activateLearningMode();
    }
  }
  
  // Update UI
  updateLearningStats();
  updateRecentTopics();
}

// Toggle learning mode
function toggleLearningMode() {
  const panel = document.getElementById('learning-mode-panel');
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
}

// Close panel
function closeLearningPanel() {
  document.getElementById('learning-mode-panel').style.display = 'none';
}

// Update skill level
function updateSkillLevel(level) {
  learningMode.skillLevel = level;
  saveLearningMode();
}

// Update preferences
function updatePreferences() {
  learningMode.preferences = {
    showPrerequisites: document.getElementById('show-prerequisites').checked,
    highlightNextSteps: document.getElementById('highlight-next-steps').checked,
    adaptiveDifficulty: document.getElementById('adaptive-difficulty').checked,
    trackProgress: document.getElementById('track-progress').checked
  };
  saveLearningMode();
}

// Apply learning mode
function applyLearningMode() {
  learningMode.enabled = true;
  saveLearningMode();
  activateLearningMode();
  closeLearningPanel();
}

// Activate learning mode
function activateLearningMode() {
  document.getElementById('mode-status').textContent = 'ON';
  document.getElementById('learning-mode-button').classList.add('active');
  document.getElementById('learning-indicators').style.display = 'flex';
  
  // Apply content filtering
  filterContentByLevel();
  
  // Track current page
  if (learningMode.preferences.trackProgress) {
    trackPageVisit();
  }
  
  // Show next steps
  if (learningMode.preferences.highlightNextSteps) {
    showNextSteps();
  }
  
  // Apply visual indicators
  applyLevelIndicators();
}

// Filter content by skill level
function filterContentByLevel() {
  const currentLevel = learningMode.skillLevel;
  document.getElementById('current-skill-level').textContent = 
    currentLevel.charAt(0).toUpperCase() + currentLevel.slice(1);
  
  // Add class to body for CSS-based filtering
  document.body.setAttribute('data-learning-level', currentLevel);
  
  // Hide/show content based on level
  document.querySelectorAll('[data-difficulty]').forEach(element => {
    const difficulty = element.getAttribute('data-difficulty');
    if (shouldShowContent(difficulty, currentLevel)) {
      element.style.display = '';
      element.classList.add('learning-mode-visible');
    } else {
      element.style.display = 'none';
      element.classList.remove('learning-mode-visible');
    }
  });
}

// Determine if content should be shown
function shouldShowContent(contentLevel, userLevel) {
  const levels = ['beginner', 'intermediate', 'advanced'];
  const contentIndex = levels.indexOf(contentLevel);
  const userIndex = levels.indexOf(userLevel);
  
  // Show content at or below user level, plus one level up
  return contentIndex <= userIndex + 1;
}

// Track page visit
function trackPageVisit() {
  const currentPage = {
    path: window.location.pathname,
    title: document.title,
    timestamp: new Date().toISOString(),
    level: 'intermediate'
  };
  
  // Add to pages read
  if (!learningMode.progress.pagesRead.find(p => p.path === currentPage.path)) {
    learningMode.progress.pagesRead.push(currentPage);
  }
  
  // Update streak
  updateStreak();
  
  // Save progress
  saveLearningMode();
  updateLearningStats();
}

// Update learning streak
function updateStreak() {
  const today = new Date().toDateString();
  const lastVisit = learningMode.progress.lastVisit;
  
  if (!lastVisit) {
    learningMode.progress.streak = 1;
  } else {
    const lastDate = new Date(lastVisit).toDateString();
    const yesterday = new Date();
    yesterday.setDate(yesterday.getDate() - 1);
    
    if (lastDate === today) {
      // Already visited today
      return;
    } else if (lastDate === yesterday.toDateString()) {
      // Consecutive day
      learningMode.progress.streak++;
    } else {
      // Streak broken
      learningMode.progress.streak = 1;
    }
  }
  
  learningMode.progress.lastVisit = new Date().toISOString();
}

// Show next steps
function showNextSteps() {
  // This would be customized based on the current page and user's progress
  const nextSteps = getRecommendedNextSteps();
  
  if (nextSteps.length > 0) {
    const indicator = document.getElementById('next-step-indicator');
    const link = document.getElementById('next-step-link');
    
    indicator.style.display = 'block';
    link.href = nextSteps[0].url;
    link.textContent = nextSteps[0].title;
  }
}

// Get recommended next steps (mock implementation)
function getRecommendedNextSteps() {
  // In a real implementation, this would analyze the current page,
  // user's progress, and skill level to recommend appropriate next content
  return [
    {
      title: 'Advanced Concepts',
      url: '/docs/advanced/',
      reason: 'You\'ve completed the basics'
    }
  ];
}

// Apply visual indicators to content
function applyLevelIndicators() {
  // Add badges to links based on their difficulty
  document.querySelectorAll('a[data-difficulty]').forEach(link => {
    const difficulty = link.getAttribute('data-difficulty');
    if (!link.querySelector('.level-badge')) {
      const badge = document.createElement('span');
      badge.className = `level-badge inline-badge level-${difficulty}`;
      badge.textContent = difficulty.charAt(0).toUpperCase();
      link.appendChild(badge);
    }
  });
}

// Update learning statistics
function updateLearningStats() {
  document.getElementById('pages-read').textContent = learningMode.progress.pagesRead.length;
  document.getElementById('topics-completed').textContent = learningMode.progress.topicsCompleted.length;
  document.getElementById('current-streak').textContent = learningMode.progress.streak;
}

// Update recent topics list
function updateRecentTopics() {
  const list = document.getElementById('recent-topics-list');
  const recentPages = learningMode.progress.pagesRead.slice(-5).reverse();
  
  if (recentPages.length === 0) {
    return;
  }
  
  list.innerHTML = recentPages.map(page => `
    <li>
      <a href="${page.path}">${page.title}</a>
      <span class="topic-level">${page.level}</span>
    </li>
  `).join('');
}

// Reset progress
function resetProgress() {
  if (confirm('Are you sure you want to reset all your learning progress?')) {
    learningMode.progress = {
      pagesRead: [],
      topicsCompleted: [],
      lastVisit: null,
      streak: 0
    };
    saveLearningMode();
    updateLearningStats();
    updateRecentTopics();
  }
}

// Save learning mode to localStorage
function saveLearningMode() {
  localStorage.setItem('learningMode', JSON.stringify(learningMode));
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', initializeLearningMode);

// Listen for visibility changes to update content
document.addEventListener('visibilitychange', () => {
  if (!document.hidden && learningMode.enabled) {
    filterContentByLevel();
  }
});
</script>

<style>
/* Learning mode button */
.learning-mode-container {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  z-index: 900;
}

.learning-mode-button {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  background: var(--btn-bg, #fff);
  border: 2px solid var(--btn-border, #0066cc);
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: all 0.3s ease;
  font-weight: 500;
}

.learning-mode-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.2);
}

.learning-mode-button.active {
  background: var(--btn-active-bg, #0066cc);
  color: white;
}

.mode-icon {
  flex-shrink: 0;
}

.mode-status {
  font-size: 0.75rem;
  padding: 0.125rem 0.5rem;
  background: var(--status-bg, #e0e0e0);
  color: var(--status-color, #666);
  border-radius: 10px;
  font-weight: 600;
}

.learning-mode-button.active .mode-status {
  background: var(--status-active-bg, #28a745);
  color: white;
}

/* Learning mode panel */
.learning-mode-panel {
  position: fixed;
  bottom: 5rem;
  right: 2rem;
  width: 420px;
  max-width: calc(100vw - 4rem);
  max-height: 600px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  overflow: hidden;
  z-index: 901;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1.5rem;
  background: var(--header-bg, #f8f9fa);
  border-bottom: 1px solid var(--border-color, #e0e0e0);
}

.panel-header h3 {
  margin: 0;
  font-size: 1.25rem;
}

.close-panel {
  width: 32px;
  height: 32px;
  background: transparent;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--close-color, #6c757d);
  border-radius: 4px;
  transition: all 0.2s ease;
}

.close-panel:hover {
  background: var(--close-hover-bg, #e9ecef);
  color: var(--close-hover-color, #000);
}

.panel-content {
  padding: 1.5rem;
  max-height: 500px;
  overflow-y: auto;
}

/* Skill level cards */
.level-cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 2rem;
}

.level-card {
  cursor: pointer;
}

.level-card input {
  position: absolute;
  opacity: 0;
}

.card-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1.5rem 0.5rem;
  background: var(--card-bg, #f8f9fa);
  border: 2px solid var(--card-border, #e0e0e0);
  border-radius: 8px;
  transition: all 0.2s ease;
  text-align: center;
}

.level-card input:checked + .card-content {
  background: var(--card-selected-bg, #e6f2ff);
  border-color: var(--card-selected-border, #0066cc);
}

.level-card:hover .card-content {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.level-emoji {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.level-name {
  font-weight: 600;
  margin-bottom: 0.25rem;
}

.level-desc {
  font-size: 0.75rem;
  color: var(--desc-color, #6c757d);
}

/* Preferences */
.preference-option {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 0;
  cursor: pointer;
}

.preference-option input {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

/* Journey stats */
.journey-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin: 1rem 0;
}

.stat-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem;
  background: var(--stat-bg, #f8f9fa);
  border-radius: 8px;
  text-align: center;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--stat-color, #0066cc);
}

.stat-label {
  font-size: 0.75rem;
  color: var(--label-color, #6c757d);
  margin-top: 0.25rem;
}

/* Recent topics */
.recent-topics {
  margin-top: 1.5rem;
}

.recent-topics h5 {
  margin-bottom: 0.5rem;
  color: var(--heading-color, #495057);
}

#recent-topics-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

#recent-topics-list li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--list-border, #e0e0e0);
}

#recent-topics-list li:last-child {
  border-bottom: none;
}

.topic-level {
  font-size: 0.75rem;
  padding: 0.125rem 0.5rem;
  background: var(--level-bg, #e0e0e0);
  color: var(--level-color, #666);
  border-radius: 10px;
  text-transform: capitalize;
}

.empty-state {
  color: var(--empty-color, #6c757d);
  font-style: italic;
}

/* Panel actions */
.panel-actions {
  display: flex;
  gap: 1rem;
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--border-color, #e0e0e0);
}

.action-btn {
  flex: 1;
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.action-btn.primary {
  background: var(--primary-bg, #0066cc);
  color: white;
}

.action-btn.primary:hover {
  background: var(--primary-hover, #0052a3);
}

.action-btn.secondary {
  background: var(--secondary-bg, #6c757d);
  color: white;
}

.action-btn.secondary:hover {
  background: var(--secondary-hover, #5a6268);
}

/* Learning indicators */
.learning-indicators {
  position: fixed;
  top: 5rem;
  right: 2rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  z-index: 800;
}

.indicator {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: white;
  border: 1px solid var(--indicator-border, #e0e0e0);
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  font-size: 0.875rem;
}

.indicator-label {
  color: var(--label-color, #6c757d);
}

.indicator-value {
  font-weight: 600;
  color: var(--value-color, #0066cc);
}

.indicator-link {
  color: var(--link-color, #0066cc);
  text-decoration: none;
}

.indicator-link:hover {
  text-decoration: underline;
}

/* Content filtering styles */
body[data-learning-level="beginner"] .advanced-only,
body[data-learning-level="beginner"] .intermediate-only {
  display: none !important;
}

body[data-learning-level="intermediate"] .advanced-only {
  opacity: 0.6;
}

/* Level badges */
.level-badge.inline-badge {
  display: inline-block;
  margin-left: 0.5rem;
  font-size: 0.65rem;
  padding: 0.1rem 0.3rem;
  vertical-align: super;
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  .learning-mode-button {
    --btn-bg: #2a2a2a;
    --btn-border: #4d94ff;
  }
  
  .learning-mode-panel {
    background: #1a1a1a;
    color: #f0f0f0;
  }
  
  .panel-header {
    --header-bg: #2a2a2a;
    --border-color: #333;
  }
  
  .card-content {
    --card-bg: #2a2a2a;
    --card-border: #444;
    --card-selected-bg: #1a3d66;
    --card-selected-border: #4d94ff;
  }
  
  .stat-card {
    --stat-bg: #2a2a2a;
  }
  
  .indicator {
    background: #2a2a2a;
    --indicator-border: #444;
  }
  
  /* More dark mode variables... */
}

/* Responsive design */
@media (max-width: 768px) {
  .learning-mode-container {
    bottom: 1rem;
    right: 1rem;
  }
  
  .learning-mode-panel {
    right: 1rem;
    width: calc(100vw - 2rem);
  }
  
  .level-cards {
    grid-template-columns: 1fr;
  }
  
  .journey-stats {
    grid-template-columns: 1fr;
  }
}
</style>
        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

  </div>
</body>
</html>