<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

<!-- SEO Meta Tags -->
<meta name="description" content="Technology and Physics notes">
<meta name="author" content="{"name"=>"Andrew", "avatar"=>"/assets/images/avatar.png", "bio"=>"Technologist & Physics Enthusiast", "location"=>"Earth"}">

<!-- Open Graph -->
<meta property="og:title" content="Distributed Systems">
<meta property="og:description" content="Technology and Physics notes">
<meta property="og:type" content="website">
<meta property="og:url" content="https://andrewaltimit.github.io/Documentation/docs/distributed-systems/">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Distributed Systems">
<meta name="twitter:description" content="Technology and Physics notes">

<title>Distributed Systems | Andrews Notebook</title>


  <link href="/Documentation/feed.xml" type="application/atom+xml" rel="alternate" title="Andrews Notebook Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/Documentation/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>

<!-- Custom styles -->
<!-- Custom styles for documentation -->
<link rel="stylesheet" href="/Documentation/style.css?v=2.0.1">
<link rel="stylesheet" href="/Documentation/assets/css/condensed.css?v=2.0.1">
<style>
  /* Widescreen optimized layout */
  body {
    overflow-x: hidden;
    margin: 0;
    padding: 0;
  }
  
  /* Main container - full width */
  #main {
    display: flex;
    position: relative;
    min-height: 100vh;
    width: 100%;
    max-width: 100%;
  }
  
  /* Sidebar fixed to left edge */
  .sidebar.sticky {
    position: fixed;
    left: 0;
    top: 0;
    width: 280px;
    height: 100vh;
    overflow-y: auto;
    background-color: #f8f9fa;
    border-right: 1px solid #e1e4e8;
    padding: 2rem 1rem;
    z-index: 100;
  }
  
  /* Sidebar navigation styling */
  .nav__list {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  
  .nav__title {
    margin: 1.5rem 0 0.5rem;
    padding: 0.25rem 0;
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #666;
    border-bottom: 1px solid #e1e4e8;
  }
  
  .nav__items {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  
  .nav__items a {
    display: block;
    padding: 0.3rem 0.75rem;
    font-size: 0.875rem;
    color: #333;
    text-decoration: none;
    border-left: 3px solid transparent;
    transition: all 0.2s ease;
  }
  
  .nav__items a:hover {
    color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
    border-left-color: #0066cc;
  }
  
  .nav__items a.active {
    color: #0066cc;
    font-weight: 600;
    border-left-color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
  }
  
  /* Content area with left margin for sidebar */
  article.page {
    margin-left: 280px;
    min-height: 100vh;
    background: white;
    width: calc(100% - 280px);
    max-width: none;
  }
  
  /* Content wrapper - use full width */
  .page__inner-wrap {
    max-width: none;
    margin: 0;
    padding: 2rem 3rem;
  }
  
  .page__title {
    margin-top: 0;
    margin-bottom: 2rem;
    font-size: 2.5rem;
    font-weight: 700;
    line-height: 1.2;
  }
  
  /* Let content use available width */
  .page__content {
    max-width: none;
    width: 100%;
  }
  
  /* For optimal reading, constrain just the text paragraphs */
  .page__content > p,
  .page__content > ul,
  .page__content > ol {
    max-width: 65ch;
  }
  
  /* Let code blocks, tables, and special content use full width */
  .page__content pre,
  .page__content table,
  .page__content .noteBoxes,
  .page__content figure,
  .page__content .highlight {
    max-width: 100%;
  }
  
  /* Wide note boxes */
  .noteBoxes {
    width: 90% !important;
    max-width: 800px;
  }
  
  /* Tables use available width */
  table {
    width: 100%;
    max-width: 100%;
  }
  
  /* Code blocks optimization */
  pre {
    max-width: 100%;
    overflow-x: auto;
  }
  
  .highlight {
    max-width: 100%;
    margin: 1rem 0;
  }
  
  /* Responsive adjustments */
  @media (min-width: 2000px) {
    .sidebar.sticky {
      width: 320px;
    }
    
    article.page {
      margin-left: 320px;
      width: calc(100% - 320px);
    }
    
    .page__inner-wrap {
      padding: 2rem 4rem;
    }
    
    .page__content > p,
    .page__content > ul,
    .page__content > ol {
      max-width: 75ch;
    }
  }
  
  @media (min-width: 1024px) and (max-width: 1439px) {
    .sidebar.sticky {
      width: 250px;
    }
    
    article.page {
      margin-left: 250px;
      width: calc(100% - 250px);
    }
    
    .page__inner-wrap {
      padding: 2rem 2rem;
    }
  }
  
  /* Tablet and mobile */
  @media (max-width: 1023px) {
    #main {
      flex-direction: column;
    }
    
    .sidebar.sticky {
      position: relative;
      width: 100%;
      height: auto;
      border-right: none;
      border-bottom: 1px solid #e1e4e8;
      padding: 1rem;
    }
    
    article.page {
      margin-left: 0;
      width: 100%;
    }
    
    .page__inner-wrap {
      padding: 1rem;
    }
    
    .page__content > p,
    .page__content > ul,
    .page__content > ol {
      max-width: 100%;
    }
  }
  
  /* Mobile navigation toggle */
  .nav-toggle {
    display: none;
  }
  
  @media (max-width: 1023px) {
    .nav-toggle {
      display: block;
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 200;
      background: #0066cc;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .sidebar.sticky {
      position: fixed;
      left: -100%;
      top: 0;
      transition: left 0.3s ease;
      z-index: 150;
      height: 100vh;
      width: 280px;
    }
    
    .sidebar.sticky.active {
      left: 0;
    }
    
    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 140;
    }
    
    .sidebar-overlay.active {
      display: block;
    }
    
    article.page {
      margin-left: 0;
      width: 100%;
    }
  }
</style>

<!-- Mobile navigation toggle script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Mobile menu functionality
  if (window.innerWidth <= 1023) {
    if (!document.querySelector('.nav-toggle')) {
      const toggleBtn = document.createElement('button');
      toggleBtn.className = 'nav-toggle';
      toggleBtn.innerHTML = '‚ò∞ Menu';
      toggleBtn.setAttribute('aria-label', 'Toggle navigation menu');
      document.body.appendChild(toggleBtn);
      
      const overlay = document.createElement('div');
      overlay.className = 'sidebar-overlay';
      document.body.appendChild(overlay);
      
      toggleBtn.addEventListener('click', function() {
        const sidebar = document.querySelector('.sidebar.sticky');
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
      });
      
      overlay.addEventListener('click', function() {
        const sidebar = document.querySelector('.sidebar.sticky');
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
    }
  }
  
  // Handle window resize
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      const sidebar = document.querySelector('.sidebar.sticky');
      const overlay = document.querySelector('.sidebar-overlay');
      const toggle = document.querySelector('.nav-toggle');
      
      if (window.innerWidth > 1023) {
        if (sidebar) sidebar.classList.remove('active');
        if (overlay) overlay.classList.remove('active');
        if (toggle) toggle.style.display = 'none';
      } else {
        if (toggle) toggle.style.display = 'block';
      }
    }, 250);
  });
});
</script>


  
    <script src="/Documentation/assets/js/custom.js"></script>
  

</head>
<body>
  <div id="main" role="main">
  <aside class="sidebar sticky">
    <nav class="nav__list">
      
        
          <h3 class="nav__title">Navigation</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/topic-map/">
                    <span class="nav__sub-title">üó∫Ô∏è Topic Map</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/search.html">
                    <span class="nav__sub-title">üîç Search</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html">
                    <span class="nav__sub-title">üìã Reference Index</span>
                  </a>
                </li>
              
            </ul>
          
        
          <h3 class="nav__title">Technology</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/technology/index.html">
                    <span class="nav__sub-title">Technology Overview</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/git-reference.html">
                    <span class="nav__sub-title">Git Command Reference</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/docker-essentials.html">
                    <span class="nav__sub-title">Docker Essentials</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/terraform.html">
                    <span class="nav__sub-title">Terraform</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/docker.html">
                    <span class="nav__sub-title">Docker</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/aws.html">
                    <span class="nav__sub-title">AWS</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/kubernetes.html">
                    <span class="nav__sub-title">Kubernetes</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/database-design.html">
                    <span class="nav__sub-title">Database Design</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/networking.html">
                    <span class="nav__sub-title">Networking</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/cybersecurity.html">
                    <span class="nav__sub-title">Cybersecurity</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/git.html">
                    <span class="nav__sub-title">Git</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/branching.html">
                    <span class="nav__sub-title">Branching Strategies</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/ci-cd.html">
                    <span class="nav__sub-title">CI/CD</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/unreal.html">
                    <span class="nav__sub-title">Unreal Engine</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/quantumcomputing.html">
                    <span class="nav__sub-title">Quantum Computing</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/ai.html">
                    <span class="nav__sub-title">AI Fundamentals</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/ai-fundamentals-simple.html">
                    <span class="nav__sub-title">AI Fundamentals (Simple)</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/ai-lecture-2023.html">
                    <span class="nav__sub-title">AI Lecture 2023</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/technology/please-build.html">
                    <span class="nav__sub-title">Please Build</span>
                  </a>
                </li>
              
            </ul>
          
        
          <h3 class="nav__title">AI/ML - Generative AI</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/ai-ml/index.html">
                    <span class="nav__sub-title">AI/ML Overview</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/stable-diffusion-fundamentals.html">
                    <span class="nav__sub-title">Stable Diffusion Fundamentals</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/base-models-comparison.html">
                    <span class="nav__sub-title">Base Models Comparison</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/model-types.html">
                    <span class="nav__sub-title">Model Types</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/lora-training.html">
                    <span class="nav__sub-title">LoRA Training</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/controlnet.html">
                    <span class="nav__sub-title">ControlNet Guide</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/comfyui-guide.html">
                    <span class="nav__sub-title">ComfyUI Guide</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/output-formats.html">
                    <span class="nav__sub-title">Output Formats</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/ai-ml/advanced-techniques.html">
                    <span class="nav__sub-title">Advanced Techniques</span>
                  </a>
                </li>
              
            </ul>
          
        
          <h3 class="nav__title">Physics</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/physics/index.html">
                    <span class="nav__sub-title">Physics Overview</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/classical-mechanics.html">
                    <span class="nav__sub-title">Classical Mechanics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/thermodynamics.html">
                    <span class="nav__sub-title">Thermodynamics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/statistical-mechanics.html">
                    <span class="nav__sub-title">Statistical Mechanics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/relativity.html">
                    <span class="nav__sub-title">Relativity</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/quantum-mechanics.html">
                    <span class="nav__sub-title">Quantum Mechanics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/condensed-matter.html">
                    <span class="nav__sub-title">Condensed Matter Physics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/quantum-field-theory.html">
                    <span class="nav__sub-title">Quantum Field Theory</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/string-theory.html">
                    <span class="nav__sub-title">String Theory</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/physics/computational-physics.html">
                    <span class="nav__sub-title">Computational Physics</span>
                  </a>
                </li>
              
            </ul>
          
        
          <h3 class="nav__title">Advanced Topics</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/advanced/index.html">
                    <span class="nav__sub-title">Research Hub</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/advanced/ai-mathematics.html">
                    <span class="nav__sub-title">AI Mathematics</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/advanced/distributed-systems-theory.html">
                    <span class="nav__sub-title">Distributed Systems Theory</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/advanced/quantum-algorithms-research.html">
                    <span class="nav__sub-title">Quantum Algorithms Research</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/advanced/monorepo.html">
                    <span class="nav__sub-title">Monorepo Architecture</span>
                  </a>
                </li>
              
            </ul>
          
        
          <h3 class="nav__title">Quick Reference</h3>
          
            <ul class="nav__items">
              
                <li>
                  <a href="/Documentation/docs/reference/index.html">
                    <span class="nav__sub-title">Reference Guide</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#command-line-references">
                    <span class="nav__sub-title">Command Cheat Sheets</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#physics-formulas--constants">
                    <span class="nav__sub-title">Physics Formulas</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#algorithms--data-structures">
                    <span class="nav__sub-title">Algorithms &amp; Big O</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#api-reference-patterns">
                    <span class="nav__sub-title">API Patterns</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#troubleshooting-flowcharts">
                    <span class="nav__sub-title">Troubleshooting</span>
                  </a>
                </li>
              
                <li>
                  <a href="/Documentation/docs/reference/index.html#best-practices-checklists">
                    <span class="nav__sub-title">Best Practices</span>
                  </a>
                </li>
              
            </ul>
          
        
      
    </nav>
  </aside>

  <article class="page">
    <div class="page__inner-wrap">
      <header>
        <h1 id="page-title" class="page__title">Distributed Systems</h1>
      </header>
      
      <section class="page__content">
        <div class="code-example">
  <p>Comprehensive documentation for distributed systems architecture, design patterns, and implementation strategies. From consensus algorithms to microservices, from message queuing to service mesh.</p>
</div>

<h2 class="no_toc text-delta" id="table-of-contents">Table of contents</h2>

<ol id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li>
<a href="#quick-navigation" id="markdown-toc-quick-navigation">Quick Navigation</a>    <ol>
      <li><a href="#core-infrastructure" id="markdown-toc-core-infrastructure">Core Infrastructure</a></li>
      <li><a href="#key-concepts" id="markdown-toc-key-concepts">Key Concepts</a></li>
    </ol>
  </li>
  <li>
<a href="#getting-started" id="markdown-toc-getting-started">Getting Started</a>    <ol>
      <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
      <li>
<a href="#quick-start-examples" id="markdown-toc-quick-start-examples">Quick Start Examples</a>        <ol>
          <li><a href="#deploy-your-first-microservice" id="markdown-toc-deploy-your-first-microservice">Deploy Your First Microservice</a></li>
          <li><a href="#implement-basic-consensus" id="markdown-toc-implement-basic-consensus">Implement Basic Consensus</a></li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
<a href="#core-concepts" id="markdown-toc-core-concepts">Core Concepts</a>    <ol>
      <li><a href="#the-distributed-systems-challenge" id="markdown-toc-the-distributed-systems-challenge">The Distributed Systems Challenge</a></li>
      <li>
<a href="#fundamental-theorems" id="markdown-toc-fundamental-theorems">Fundamental Theorems</a>        <ol>
          <li><a href="#cap-theorem" id="markdown-toc-cap-theorem">CAP Theorem</a></li>
          <li><a href="#flp-impossibility" id="markdown-toc-flp-impossibility">FLP Impossibility</a></li>
        </ol>
      </li>
      <li><a href="#consistency-models" id="markdown-toc-consistency-models">Consistency Models</a></li>
    </ol>
  </li>
  <li>
<a href="#architecture-patterns" id="markdown-toc-architecture-patterns">Architecture Patterns</a>    <ol>
      <li><a href="#microservices-architecture" id="markdown-toc-microservices-architecture">Microservices Architecture</a></li>
      <li><a href="#event-driven-architecture" id="markdown-toc-event-driven-architecture">Event-Driven Architecture</a></li>
      <li><a href="#service-mesh-pattern" id="markdown-toc-service-mesh-pattern">Service Mesh Pattern</a></li>
    </ol>
  </li>
  <li>
<a href="#implementation-guide" id="markdown-toc-implementation-guide">Implementation Guide</a>    <ol>
      <li>
<a href="#building-reliable-services" id="markdown-toc-building-reliable-services">Building Reliable Services</a>        <ol>
          <li><a href="#health-checks-and-circuit-breakers" id="markdown-toc-health-checks-and-circuit-breakers">Health Checks and Circuit Breakers</a></li>
          <li><a href="#distributed-tracing" id="markdown-toc-distributed-tracing">Distributed Tracing</a></li>
        </ol>
      </li>
      <li>
<a href="#scaling-strategies" id="markdown-toc-scaling-strategies">Scaling Strategies</a>        <ol>
          <li><a href="#horizontal-scaling-with-load-balancing" id="markdown-toc-horizontal-scaling-with-load-balancing">Horizontal Scaling with Load Balancing</a></li>
          <li><a href="#database-sharding" id="markdown-toc-database-sharding">Database Sharding</a></li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
<a href="#common-patterns-and-solutions" id="markdown-toc-common-patterns-and-solutions">Common Patterns and Solutions</a>    <ol>
      <li><a href="#leader-election" id="markdown-toc-leader-election">Leader Election</a></li>
      <li><a href="#distributed-locking" id="markdown-toc-distributed-locking">Distributed Locking</a></li>
      <li><a href="#saga-pattern-for-distributed-transactions" id="markdown-toc-saga-pattern-for-distributed-transactions">Saga Pattern for Distributed Transactions</a></li>
    </ol>
  </li>
  <li>
<a href="#testing-distributed-systems" id="markdown-toc-testing-distributed-systems">Testing Distributed Systems</a>    <ol>
      <li><a href="#chaos-engineering" id="markdown-toc-chaos-engineering">Chaos Engineering</a></li>
      <li><a href="#property-based-testing" id="markdown-toc-property-based-testing">Property-Based Testing</a></li>
    </ol>
  </li>
  <li>
<a href="#performance-optimization" id="markdown-toc-performance-optimization">Performance Optimization</a>    <ol>
      <li><a href="#caching-strategies" id="markdown-toc-caching-strategies">Caching Strategies</a></li>
      <li><a href="#batch-processing" id="markdown-toc-batch-processing">Batch Processing</a></li>
    </ol>
  </li>
  <li>
<a href="#monitoring-and-observability" id="markdown-toc-monitoring-and-observability">Monitoring and Observability</a>    <ol>
      <li><a href="#metrics-collection" id="markdown-toc-metrics-collection">Metrics Collection</a></li>
      <li><a href="#distributed-logging" id="markdown-toc-distributed-logging">Distributed Logging</a></li>
    </ol>
  </li>
  <li>
<a href="#security-considerations" id="markdown-toc-security-considerations">Security Considerations</a>    <ol>
      <li><a href="#zero-trust-architecture" id="markdown-toc-zero-trust-architecture">Zero Trust Architecture</a></li>
      <li><a href="#encryption-in-transit" id="markdown-toc-encryption-in-transit">Encryption in Transit</a></li>
    </ol>
  </li>
  <li>
<a href="#tools-and-technologies" id="markdown-toc-tools-and-technologies">Tools and Technologies</a>    <ol>
      <li><a href="#container-orchestration" id="markdown-toc-container-orchestration">Container Orchestration</a></li>
      <li><a href="#service-mesh" id="markdown-toc-service-mesh">Service Mesh</a></li>
      <li><a href="#message-queuing" id="markdown-toc-message-queuing">Message Queuing</a></li>
      <li><a href="#distributed-databases" id="markdown-toc-distributed-databases">Distributed Databases</a></li>
      <li><a href="#monitoring-and-observability-1" id="markdown-toc-monitoring-and-observability-1">Monitoring and Observability</a></li>
    </ol>
  </li>
  <li>
<a href="#best-practices" id="markdown-toc-best-practices">Best Practices</a>    <ol>
      <li><a href="#design-principles" id="markdown-toc-design-principles">Design Principles</a></li>
      <li><a href="#operational-excellence" id="markdown-toc-operational-excellence">Operational Excellence</a></li>
      <li><a href="#development-practices" id="markdown-toc-development-practices">Development Practices</a></li>
    </ol>
  </li>
  <li>
<a href="#next-steps" id="markdown-toc-next-steps">Next Steps</a>    <ol>
      <li><a href="#advanced-topics" id="markdown-toc-advanced-topics">Advanced Topics</a></li>
    </ol>
  </li>
  <li>
<a href="#resources" id="markdown-toc-resources">Resources</a>    <ol>
      <li><a href="#books" id="markdown-toc-books">Books</a></li>
      <li><a href="#papers" id="markdown-toc-papers">Papers</a></li>
      <li><a href="#online-courses" id="markdown-toc-online-courses">Online Courses</a></li>
      <li><a href="#community" id="markdown-toc-community">Community</a></li>
    </ol>
  </li>
</ol>

<hr>

<h2 id="overview">Overview</h2>

<p>Distributed systems form the backbone of modern computing infrastructure, enabling applications to scale beyond single machines while maintaining reliability, consistency, and performance. This section provides comprehensive documentation for understanding, designing, and implementing distributed systems.</p>

<p>Whether you‚Äôre building microservices, implementing consensus algorithms, or deploying container orchestration platforms, you‚Äôll find detailed guides, theoretical foundations, and practical examples here.</p>

<h2 id="quick-navigation">Quick Navigation</h2>

<h3 id="core-infrastructure">Core Infrastructure</h3>
<ul>
  <li>
<a href="/docs/technology/kubernetes.html"><strong>Kubernetes</strong></a> - Container orchestration and cluster management</li>
  <li>
<a href="/docs/technology/docker.html"><strong>Docker</strong></a> - Containerization fundamentals and best practices</li>
  <li>
<a href="/docs/advanced/distributed-systems-theory.html"><strong>Distributed Systems Theory</strong></a> - Formal foundations and impossibility results</li>
</ul>

<h3 id="key-concepts">Key Concepts</h3>
<ul>
  <li>
<strong>Consensus Algorithms</strong> - Paxos, Raft, and Byzantine fault tolerance</li>
  <li>
<strong>Distributed Databases</strong> - Sharding, replication, and consistency models</li>
  <li>
<strong>Microservices Architecture</strong> - Service decomposition and communication patterns</li>
  <li>
<strong>Message Queuing Systems</strong> - Async communication and event-driven architectures</li>
  <li>
<strong>Service Mesh</strong> - Traffic management, security, and observability</li>
  <li>
<strong>Distributed Computing Frameworks</strong> - MapReduce, Spark, and stream processing</li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<h3 id="prerequisites">Prerequisites</h3>

<p>Before diving into distributed systems, ensure you have:</p>

<ol>
  <li>
<strong>Foundational Knowledge</strong>:
    <ul>
      <li>Networking fundamentals (TCP/IP, HTTP, DNS)</li>
      <li>Basic understanding of concurrency and parallelism</li>
      <li>Familiarity with Linux/Unix systems</li>
      <li>Programming experience in at least one language</li>
    </ul>
  </li>
  <li>
<strong>Development Environment</strong>:
    <ul>
      <li>Docker and Docker Compose installed</li>
      <li>Kubernetes cluster (local or cloud)</li>
      <li>Development tools (Git, IDE, terminal)</li>
      <li>Network analysis tools (curl, netcat, wireshark)</li>
    </ul>
  </li>
  <li>
<strong>Conceptual Understanding</strong>:
    <ul>
      <li>CAP theorem and trade-offs</li>
      <li>Synchronous vs asynchronous communication</li>
      <li>Failure modes and fault tolerance</li>
      <li>Scalability patterns</li>
    </ul>
  </li>
</ol>

<h3 id="quick-start-examples">Quick Start Examples</h3>

<h4 id="deploy-your-first-microservice">Deploy Your First Microservice</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. Create a simple microservice</span>
<span class="nb">cat</span> <span class="o">&gt;</span> app.py <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">'
from flask import Flask, jsonify
import os

app = Flask(__name__)

@app.route('/health')
def health():
    return jsonify({
        "status": "healthy",
        "service": "example-service",
        "node": os.environ.get('HOSTNAME', 'unknown')
    })

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
</span><span class="no">EOF

</span><span class="c"># 2. Containerize it</span>
<span class="nb">cat</span> <span class="o">&gt;</span> Dockerfile <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">'
FROM python:3.9-slim
WORKDIR /app
RUN pip install flask
COPY app.py .
CMD ["python", "app.py"]
</span><span class="no">EOF

</span><span class="c"># 3. Deploy to Kubernetes</span>
kubectl create deployment example-service <span class="nt">--image</span><span class="o">=</span>example-service:v1
kubectl expose deployment example-service <span class="nt">--port</span><span class="o">=</span>5000 <span class="nt">--type</span><span class="o">=</span>LoadBalancer
</code></pre></div></div>

<h4 id="implement-basic-consensus">Implement Basic Consensus</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Simple Raft-like leader election
</span><span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">peers</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="nb">id</span> <span class="o">=</span> <span class="n">node_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">peers</span> <span class="o">=</span> <span class="n">peers</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">"</span><span class="s">follower</span><span class="sh">"</span>
        <span class="n">self</span><span class="p">.</span><span class="n">term</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">voted_for</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">leader</span> <span class="o">=</span> <span class="bp">None</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">start_election</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">"</span><span class="s">candidate</span><span class="sh">"</span>
        <span class="n">self</span><span class="p">.</span><span class="n">term</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">self</span><span class="p">.</span><span class="n">voted_for</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nb">id</span>
        
        <span class="n">votes</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Vote for self
</span>        <span class="k">for</span> <span class="n">peer</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">peers</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">request_vote</span><span class="p">(</span><span class="n">peer</span><span class="p">):</span>
                <span class="n">votes</span> <span class="o">+=</span> <span class="mi">1</span>
                
        <span class="k">if</span> <span class="n">votes</span> <span class="o">&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">peers</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">become_leader</span><span class="p">()</span>
            
    <span class="k">def</span> <span class="nf">become_leader</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">"</span><span class="s">leader</span><span class="sh">"</span>
        <span class="n">self</span><span class="p">.</span><span class="n">leader</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nb">id</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Node </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="nb">id</span><span class="si">}</span><span class="s"> became leader for term </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">term</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="core-concepts">Core Concepts</h2>

<h3 id="the-distributed-systems-challenge">The Distributed Systems Challenge</h3>

<p>Building distributed systems introduces complexity in several dimensions:</p>

<ol>
  <li>
<strong>Network Partitions</strong>: Network failures can isolate parts of the system</li>
  <li>
<strong>Partial Failures</strong>: Some components fail while others continue operating</li>
  <li>
<strong>Concurrency</strong>: Multiple operations happen simultaneously without global coordination</li>
  <li>
<strong>No Global Clock</strong>: Each node has its own clock, making ordering events challenging</li>
  <li>
<strong>Byzantine Failures</strong>: Components may fail in arbitrary ways, including malicious behavior</li>
</ol>

<h3 id="fundamental-theorems">Fundamental Theorems</h3>

<h4 id="cap-theorem">CAP Theorem</h4>

<p>Every distributed system must choose between:</p>
<ul>
  <li>
<strong>Consistency</strong>: All nodes see the same data simultaneously</li>
  <li>
<strong>Availability</strong>: System remains operational</li>
  <li>
<strong>Partition Tolerance</strong>: System continues despite network failures</li>
</ul>

<p>In practice, partition tolerance is mandatory, so systems choose between CP (consistent but may be unavailable) or AP (available but may be inconsistent).</p>

<h4 id="flp-impossibility">FLP Impossibility</h4>

<p>The Fischer-Lynch-Paterson theorem proves that deterministic consensus is impossible in asynchronous systems with even one faulty process. This drives the need for:</p>
<ul>
  <li>Timeouts and failure detectors</li>
  <li>Randomized algorithms</li>
  <li>Synchrony assumptions</li>
</ul>

<h3 id="consistency-models">Consistency Models</h3>

<p>Different applications require different consistency guarantees:</p>

<ol>
  <li>
<strong>Strong Consistency</strong>:
    <ul>
      <li>
<strong>Linearizability</strong>: Operations appear atomic and instantaneous</li>
      <li>
<strong>Sequential Consistency</strong>: Operations appear in program order</li>
      <li>
<strong>Causal Consistency</strong>: Causally related operations are ordered</li>
    </ul>
  </li>
  <li>
<strong>Weak Consistency</strong>:
    <ul>
      <li>
<strong>Eventual Consistency</strong>: System converges to consistent state</li>
      <li>
<strong>Read Your Writes</strong>: Process sees its own writes</li>
      <li>
<strong>Monotonic Reads</strong>: Once seen, data doesn‚Äôt go backwards</li>
    </ul>
  </li>
</ol>

<h2 id="architecture-patterns">Architecture Patterns</h2>

<h3 id="microservices-architecture">Microservices Architecture</h3>

<p>Breaking monoliths into services requires careful design:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># docker-compose.yml for microservices</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">api-gateway</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:alpine</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./nginx.conf:/etc/nginx/nginx.conf</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">user-service</span>
      <span class="pi">-</span> <span class="s">order-service</span>
      
  <span class="na">user-service</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./user-service</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">DB_HOST=user-db</span>
      <span class="pi">-</span> <span class="s">REDIS_HOST=cache</span>
      
  <span class="na">order-service</span><span class="pi">:</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./order-service</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">DB_HOST=order-db</span>
      <span class="pi">-</span> <span class="s">KAFKA_BROKERS=kafka:9092</span>
</code></pre></div></div>

<h3 id="event-driven-architecture">Event-Driven Architecture</h3>

<p>Using message queues for loose coupling:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Producer
</span><span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">from</span> <span class="n">aiokafka</span> <span class="kn">import</span> <span class="n">AIOKafkaProducer</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">send_order_event</span><span class="p">(</span><span class="n">order_data</span><span class="p">):</span>
    <span class="n">producer</span> <span class="o">=</span> <span class="nc">AIOKafkaProducer</span><span class="p">(</span>
        <span class="n">bootstrap_servers</span><span class="o">=</span><span class="sh">'</span><span class="s">localhost:9092</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">value_serializer</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">v</span><span class="p">).</span><span class="nf">encode</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">producer</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">producer</span><span class="p">.</span><span class="nf">send_and_wait</span><span class="p">(</span>
            <span class="sh">"</span><span class="s">order-events</span><span class="sh">"</span><span class="p">,</span>
            <span class="p">{</span><span class="sh">"</span><span class="s">order_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">order_data</span><span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">],</span> <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">created</span><span class="sh">"</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">producer</span><span class="p">.</span><span class="nf">stop</span><span class="p">()</span>

<span class="c1"># Consumer
</span><span class="kn">from</span> <span class="n">aiokafka</span> <span class="kn">import</span> <span class="n">AIOKafkaConsumer</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">process_orders</span><span class="p">():</span>
    <span class="n">consumer</span> <span class="o">=</span> <span class="nc">AIOKafkaConsumer</span><span class="p">(</span>
        <span class="sh">'</span><span class="s">order-events</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">bootstrap_servers</span><span class="o">=</span><span class="sh">'</span><span class="s">localhost:9092</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">group_id</span><span class="o">=</span><span class="sh">"</span><span class="s">order-processor</span><span class="sh">"</span>
    <span class="p">)</span>
    <span class="k">await</span> <span class="n">consumer</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">consumer</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">await</span> <span class="nf">handle_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">consumer</span><span class="p">.</span><span class="nf">stop</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="service-mesh-pattern">Service Mesh Pattern</h3>

<p>Implementing cross-cutting concerns at the infrastructure level:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Istio service mesh configuration</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.istio.io/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualService</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">reviews</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">hosts</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">reviews</span>
  <span class="na">http</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">match</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">headers</span><span class="pi">:</span>
        <span class="na">end-user</span><span class="pi">:</span>
          <span class="na">exact</span><span class="pi">:</span> <span class="s">jason</span>
    <span class="na">route</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span>
        <span class="na">host</span><span class="pi">:</span> <span class="s">reviews</span>
        <span class="na">subset</span><span class="pi">:</span> <span class="s">v2</span>
  <span class="pi">-</span> <span class="na">route</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span>
        <span class="na">host</span><span class="pi">:</span> <span class="s">reviews</span>
        <span class="na">subset</span><span class="pi">:</span> <span class="s">v1</span>
      <span class="na">weight</span><span class="pi">:</span> <span class="m">80</span>
    <span class="pi">-</span> <span class="na">destination</span><span class="pi">:</span>
        <span class="na">host</span><span class="pi">:</span> <span class="s">reviews</span>
        <span class="na">subset</span><span class="pi">:</span> <span class="s">v2</span>
      <span class="na">weight</span><span class="pi">:</span> <span class="m">20</span>
</code></pre></div></div>

<h2 id="implementation-guide">Implementation Guide</h2>

<h3 id="building-reliable-services">Building Reliable Services</h3>

<h4 id="health-checks-and-circuit-breakers">Health Checks and Circuit Breakers</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">circuit_breaker</span> <span class="kn">import</span> <span class="n">CircuitBreaker</span>
<span class="kn">import</span> <span class="n">aiohttp</span>
<span class="kn">import</span> <span class="n">asyncio</span>

<span class="k">class</span> <span class="nc">ResilientService</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">circuit_breaker</span> <span class="o">=</span> <span class="nc">CircuitBreaker</span><span class="p">(</span>
            <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">recovery_timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
            <span class="n">expected_exception</span><span class="o">=</span><span class="n">aiohttp</span><span class="p">.</span><span class="n">ClientError</span>
        <span class="p">)</span>
        
    <span class="nd">@circuit_breaker</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">call_external_service</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="p">.</span><span class="nc">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
                
    <span class="k">async</span> <span class="k">def</span> <span class="nf">health_check</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">:</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_database</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">cache</span><span class="sh">"</span><span class="p">:</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_cache</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">dependencies</span><span class="sh">"</span><span class="p">:</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_dependencies</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="n">status</span> <span class="o">=</span> <span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span> <span class="k">if</span> <span class="nf">all</span><span class="p">(</span><span class="n">checks</span><span class="p">.</span><span class="nf">values</span><span class="p">())</span> <span class="k">else</span> <span class="sh">"</span><span class="s">unhealthy</span><span class="sh">"</span>
        <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span> <span class="sh">"</span><span class="s">checks</span><span class="sh">"</span><span class="p">:</span> <span class="n">checks</span><span class="p">}</span>
</code></pre></div></div>

<h4 id="distributed-tracing">Distributed Tracing</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">opentelemetry</span> <span class="kn">import</span> <span class="n">trace</span>
<span class="kn">from</span> <span class="n">opentelemetry.exporter.jaeger</span> <span class="kn">import</span> <span class="n">JaegerExporter</span>
<span class="kn">from</span> <span class="n">opentelemetry.sdk.trace</span> <span class="kn">import</span> <span class="n">TracerProvider</span>
<span class="kn">from</span> <span class="n">opentelemetry.sdk.trace.export</span> <span class="kn">import</span> <span class="n">BatchSpanProcessor</span>

<span class="c1"># Setup tracing
</span><span class="n">trace</span><span class="p">.</span><span class="nf">set_tracer_provider</span><span class="p">(</span><span class="nc">TracerProvider</span><span class="p">())</span>
<span class="n">tracer</span> <span class="o">=</span> <span class="n">trace</span><span class="p">.</span><span class="nf">get_tracer</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">jaeger_exporter</span> <span class="o">=</span> <span class="nc">JaegerExporter</span><span class="p">(</span>
    <span class="n">agent_host_name</span><span class="o">=</span><span class="sh">"</span><span class="s">localhost</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">agent_port</span><span class="o">=</span><span class="mi">6831</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">span_processor</span> <span class="o">=</span> <span class="nc">BatchSpanProcessor</span><span class="p">(</span><span class="n">jaeger_exporter</span><span class="p">)</span>
<span class="n">trace</span><span class="p">.</span><span class="nf">get_tracer_provider</span><span class="p">().</span><span class="nf">add_span_processor</span><span class="p">(</span><span class="n">span_processor</span><span class="p">)</span>

<span class="c1"># Use in application
</span><span class="k">async</span> <span class="k">def</span> <span class="nf">process_request</span><span class="p">(</span><span class="n">request_id</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tracer</span><span class="p">.</span><span class="nf">start_as_current_span</span><span class="p">(</span><span class="sh">"</span><span class="s">process_request</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">span</span><span class="p">:</span>
        <span class="n">span</span><span class="p">.</span><span class="nf">set_attribute</span><span class="p">(</span><span class="sh">"</span><span class="s">request.id</span><span class="sh">"</span><span class="p">,</span> <span class="n">request_id</span><span class="p">)</span>
        
        <span class="c1"># Process stages
</span>        <span class="k">with</span> <span class="n">tracer</span><span class="p">.</span><span class="nf">start_as_current_span</span><span class="p">(</span><span class="sh">"</span><span class="s">validate</span><span class="sh">"</span><span class="p">):</span>
            <span class="k">await</span> <span class="nf">validate_request</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
            
        <span class="k">with</span> <span class="n">tracer</span><span class="p">.</span><span class="nf">start_as_current_span</span><span class="p">(</span><span class="sh">"</span><span class="s">process</span><span class="sh">"</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
            
        <span class="k">with</span> <span class="n">tracer</span><span class="p">.</span><span class="nf">start_as_current_span</span><span class="p">(</span><span class="sh">"</span><span class="s">persist</span><span class="sh">"</span><span class="p">):</span>
            <span class="k">await</span> <span class="nf">save_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h3 id="scaling-strategies">Scaling Strategies</h3>

<h4 id="horizontal-scaling-with-load-balancing">Horizontal Scaling with Load Balancing</h4>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># nginx.conf for load balancing</span>
<span class="k">upstream</span> <span class="s">backend</span> <span class="p">{</span>
    <span class="kn">least_conn</span><span class="p">;</span>  <span class="c1"># Use least connection algorithm</span>
    
    <span class="kn">server</span> <span class="nf">backend1.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">weight=3</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">backend2.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">weight=2</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">backend3.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">weight=1</span><span class="p">;</span>
    
    <span class="c1"># Health checks</span>
    <span class="kn">server</span> <span class="nf">backend1.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">max_fails=3</span> <span class="s">fail_timeout=30s</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">backend2.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">max_fails=3</span> <span class="s">fail_timeout=30s</span><span class="p">;</span>
    <span class="kn">server</span> <span class="nf">backend3.example.com</span><span class="p">:</span><span class="mi">5000</span> <span class="s">max_fails=3</span> <span class="s">fail_timeout=30s</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span> <span class="s">http://backend</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
        
        <span class="c1"># Circuit breaker pattern</span>
        <span class="kn">proxy_next_upstream</span> <span class="s">error</span> <span class="s">timeout</span> <span class="s">invalid_header</span> <span class="s">http_500</span> <span class="s">http_502</span> <span class="s">http_503</span><span class="p">;</span>
        <span class="kn">proxy_next_upstream_tries</span> <span class="mi">3</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="database-sharding">Database Sharding</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>

<span class="k">class</span> <span class="nc">ShardedDatabase</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">shard_configs</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">shards</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">num_shards</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">shard_configs</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">shard_configs</span><span class="p">):</span>
            <span class="n">self</span><span class="p">.</span><span class="n">shards</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">create_connection</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">get_shard</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Consistent hashing for shard selection</span><span class="sh">"""</span>
        <span class="n">hash_value</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">shard_id</span> <span class="o">=</span> <span class="n">hash_value</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">num_shards</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">shards</span><span class="p">[</span><span class="n">shard_id</span><span class="p">]</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">shard</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_shard</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">shard</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">shard</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_shard</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">shard</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="common-patterns-and-solutions">Common Patterns and Solutions</h2>

<h3 id="leader-election">Leader Election</h3>

<p>Implementing leader election using etcd:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">etcd3</span>
<span class="kn">import</span> <span class="n">threading</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">class</span> <span class="nc">LeaderElection</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">etcd_host</span><span class="o">=</span><span class="sh">'</span><span class="s">localhost</span><span class="sh">'</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">node_id</span> <span class="o">=</span> <span class="n">node_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">etcd</span> <span class="o">=</span> <span class="n">etcd3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">etcd_host</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">lease</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">is_leader</span> <span class="o">=</span> <span class="bp">False</span>
        
    <span class="k">def</span> <span class="nf">campaign</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Run for leader position</span><span class="sh">"""</span>
        <span class="c1"># Create lease with TTL
</span>        <span class="n">self</span><span class="p">.</span><span class="n">lease</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">etcd</span><span class="p">.</span><span class="nf">lease</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5 second TTL
</span>        
        <span class="c1"># Try to create leader key
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">etcd</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span>
                <span class="sh">'</span><span class="s">/election/leader</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">self</span><span class="p">.</span><span class="n">node_id</span><span class="p">,</span>
                <span class="n">lease</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">lease</span>
            <span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">is_leader</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Node </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">node_id</span><span class="si">}</span><span class="s"> became leader</span><span class="sh">"</span><span class="p">)</span>
            
            <span class="c1"># Keep lease alive
</span>            <span class="n">self</span><span class="p">.</span><span class="n">lease</span><span class="p">.</span><span class="nf">refresh</span><span class="p">()</span>
            
        <span class="k">except</span> <span class="n">etcd3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">PreconditionFailedError</span><span class="p">:</span>
            <span class="c1"># Another node is leader
</span>            <span class="n">self</span><span class="p">.</span><span class="n">is_leader</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">watch_leader</span><span class="p">()</span>
            
    <span class="k">def</span> <span class="nf">watch_leader</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Watch for leader changes</span><span class="sh">"""</span>
        <span class="n">events_iterator</span><span class="p">,</span> <span class="n">cancel</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">etcd</span><span class="p">.</span><span class="nf">watch</span><span class="p">(</span><span class="sh">'</span><span class="s">/election/leader</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events_iterator</span><span class="p">:</span>
            <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">etcd3</span><span class="p">.</span><span class="n">events</span><span class="p">.</span><span class="n">DeleteEvent</span><span class="p">):</span>
                <span class="c1"># Leader stepped down, campaign again
</span>                <span class="n">self</span><span class="p">.</span><span class="nf">campaign</span><span class="p">()</span>
                <span class="k">break</span>
</code></pre></div></div>

<h3 id="distributed-locking">Distributed Locking</h3>

<p>Using Redis for distributed locks:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">redis</span>
<span class="kn">import</span> <span class="n">uuid</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">class</span> <span class="nc">RedisLock</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">redis_client</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">self</span><span class="p">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="n">self</span><span class="p">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="nf">uuid4</span><span class="p">())</span>
        
    <span class="k">def</span> <span class="nf">acquire</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Acquire lock with timeout</span><span class="sh">"""</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">timeout</span>
        <span class="k">while</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ex</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">timeout</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
        
    <span class="k">def</span> <span class="nf">release</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Release lock if we own it</span><span class="sh">"""</span>
        <span class="n">pipe</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="nf">pipeline</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pipe</span><span class="p">.</span><span class="nf">watch</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pipe</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">identifier</span><span class="p">:</span>
                    <span class="n">pipe</span><span class="p">.</span><span class="nf">multi</span><span class="p">()</span>
                    <span class="n">pipe</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">pipe</span><span class="p">.</span><span class="nf">execute</span><span class="p">()</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="n">pipe</span><span class="p">.</span><span class="nf">unwatch</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">redis</span><span class="p">.</span><span class="n">WatchError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">False</span>
        
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="nf">acquire</span><span class="p">():</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">Could not acquire lock</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span>
        
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">release</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="saga-pattern-for-distributed-transactions">Saga Pattern for Distributed Transactions</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SagaOrchestrator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">compensations</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">add_step</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">compensation</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">steps</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">compensations</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">compensation</span><span class="p">)</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">completed_steps</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Execute all steps
</span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">steps</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">step</span><span class="p">()</span>
                <span class="n">completed_steps</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Compensate in reverse order
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="n">completed_steps</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">compensations</span><span class="p">[</span><span class="n">i</span><span class="p">]()</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">comp_error</span><span class="p">:</span>
                    <span class="c1"># Log compensation failure
</span>                    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Compensation </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s"> failed: </span><span class="si">{</span><span class="n">comp_error</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>
            
<span class="c1"># Usage example
</span><span class="n">saga</span> <span class="o">=</span> <span class="nc">SagaOrchestrator</span><span class="p">()</span>

<span class="n">saga</span><span class="p">.</span><span class="nf">add_step</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">create_order</span><span class="p">(</span><span class="n">order_data</span><span class="p">),</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">cancel_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">saga</span><span class="p">.</span><span class="nf">add_step</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">charge_payment</span><span class="p">(</span><span class="n">payment_data</span><span class="p">),</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">refund_payment</span><span class="p">(</span><span class="n">payment_id</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">saga</span><span class="p">.</span><span class="nf">add_step</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">update_inventory</span><span class="p">(</span><span class="n">items</span><span class="p">),</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">restore_inventory</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">await</span> <span class="n">saga</span><span class="p">.</span><span class="nf">execute</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="testing-distributed-systems">Testing Distributed Systems</h2>

<h3 id="chaos-engineering">Chaos Engineering</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">asyncio</span>

<span class="k">class</span> <span class="nc">ChaosMonkey</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">failure_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">failure_rate</span> <span class="o">=</span> <span class="n">failure_rate</span>
        <span class="n">self</span><span class="p">.</span><span class="n">failures</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">network_delay</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">inject_network_delay</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">service_crash</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">inject_service_crash</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">disk_full</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">inject_disk_full</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">cpu_spike</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">inject_cpu_spike</span>
        <span class="p">}</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">inject_failure</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">failure_rate</span><span class="p">:</span>
            <span class="n">failure_type</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">failures</span><span class="p">.</span><span class="nf">keys</span><span class="p">()))</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">failures</span><span class="p">[</span><span class="n">failure_type</span><span class="p">]()</span>
            
    <span class="k">async</span> <span class="k">def</span> <span class="nf">inject_network_delay</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">inject_service_crash</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">Service crashed!</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="property-based-testing">Property-Based Testing</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">hypothesis</span> <span class="kn">import</span> <span class="n">given</span><span class="p">,</span> <span class="n">strategies</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="n">asyncio</span>

<span class="k">class</span> <span class="nc">DistributedCounter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">counters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">nodes</span>
        <span class="n">self</span><span class="p">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">):</span>
        <span class="c1"># Simulate network delay
</span>        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
        <span class="n">self</span><span class="p">.</span><span class="n">counters</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_total</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># Eventually consistent read
</span>        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">sum</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">counters</span><span class="p">)</span>

<span class="c1"># Property: Total equals number of increments
</span><span class="nd">@given</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="nf">lists</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="nf">integers</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">test_counter_consistency</span><span class="p">(</span><span class="n">operations</span><span class="p">):</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="nc">DistributedCounter</span><span class="p">()</span>
    
    <span class="c1"># Perform operations concurrently
</span>    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">counter</span><span class="p">.</span><span class="nf">increment</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">node_id</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">]</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
    
    <span class="c1"># Check eventual consistency
</span>    <span class="n">total</span> <span class="o">=</span> <span class="k">await</span> <span class="n">counter</span><span class="p">.</span><span class="nf">get_total</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">total</span> <span class="o">==</span> <span class="nf">len</span><span class="p">(</span><span class="n">operations</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="performance-optimization">Performance Optimization</h2>

<h3 id="caching-strategies">Caching Strategies</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">json</span>

<span class="k">class</span> <span class="nc">DistributedCache</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">redis_client</span><span class="p">,</span> <span class="n">default_ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">default_ttl</span> <span class="o">=</span> <span class="n">default_ttl</span>
        
    <span class="k">def</span> <span class="nf">cache_key</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Generate cache key from function and arguments</span><span class="sh">"""</span>
        <span class="n">key_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">func</span><span class="sh">'</span><span class="p">:</span> <span class="n">func_name</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">args</span><span class="sh">'</span><span class="p">:</span> <span class="n">args</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">kwargs</span><span class="sh">'</span><span class="p">:</span> <span class="n">kwargs</span>
        <span class="p">}</span>
        <span class="n">key_str</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">key_data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">cache:</span><span class="si">{</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">key_str</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">hexdigest</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span>
        
    <span class="k">def</span> <span class="nf">cached</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Decorator for caching function results</span><span class="sh">"""</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="k">async</span> <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">cache_key</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">cache_key</span><span class="p">(</span><span class="n">func</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                
                <span class="c1"># Try to get from cache
</span>                <span class="n">cached_value</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cached_value</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">cached_value</span><span class="p">)</span>
                    
                <span class="c1"># Compute and cache result
</span>                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span>
                    <span class="n">cache_key</span><span class="p">,</span>
                    <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">),</span>
                    <span class="n">ex</span><span class="o">=</span><span class="n">ttl</span> <span class="ow">or</span> <span class="n">self</span><span class="p">.</span><span class="n">default_ttl</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">return</span> <span class="n">wrapper</span>
        <span class="k">return</span> <span class="n">decorator</span>

<span class="c1"># Usage
</span><span class="n">cache</span> <span class="o">=</span> <span class="nc">DistributedCache</span><span class="p">(</span><span class="n">redis_client</span><span class="p">)</span>

<span class="nd">@cache.cached</span><span class="p">(</span><span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">expensive_computation</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="c1"># Simulate expensive operation
</span>    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">user_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span> <span class="sh">"</span><span class="s">score</span><span class="sh">"</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()}</span>
</code></pre></div></div>

<h3 id="batch-processing">Batch Processing</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">BatchProcessor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_timeout</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="n">self</span><span class="p">.</span><span class="n">batch_timeout</span> <span class="o">=</span> <span class="n">batch_timeout</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pending</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Lock</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">batch_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Event</span><span class="p">()</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">add_item</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Add item to batch and wait for result</span><span class="sh">"""</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Future</span><span class="p">()</span>
        
        <span class="k">async</span> <span class="k">with</span> <span class="n">self</span><span class="p">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">pending</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">future</span><span class="p">))</span>
            
            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pending</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">batch_size</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">batch_event</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
                
        <span class="c1"># Start batch timer if this is first item
</span>        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">_batch_timer</span><span class="p">())</span>
            
        <span class="k">return</span> <span class="k">await</span> <span class="n">future</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_batch_timer</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Trigger batch processing after timeout</span><span class="sh">"""</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">batch_timeout</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">batch_event</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">process_batch</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Process accumulated batch</span><span class="sh">"""</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">batch_event</span><span class="p">.</span><span class="nf">wait</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="n">batch_event</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
            
            <span class="k">async</span> <span class="k">with</span> <span class="n">self</span><span class="p">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">pending</span><span class="p">:</span>
                    <span class="k">continue</span>
                    
                <span class="n">batch</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">pending</span>
                <span class="n">self</span><span class="p">.</span><span class="n">pending</span> <span class="o">=</span> <span class="p">[]</span>
                
            <span class="c1"># Process batch
</span>            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">_do_batch_processing</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            
            <span class="c1"># Deliver results
</span>            <span class="nf">for </span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">future</span><span class="p">),</span> <span class="n">result</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
                <span class="n">future</span><span class="p">.</span><span class="nf">set_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="monitoring-and-observability">Monitoring and Observability</h2>

<h3 id="metrics-collection">Metrics Collection</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="c1"># Define metrics
</span><span class="n">request_count</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="sh">'</span><span class="s">http_requests_total</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Total HTTP requests</span><span class="sh">'</span><span class="p">,</span> <span class="p">[</span><span class="sh">'</span><span class="s">method</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">endpoint</span><span class="sh">'</span><span class="p">])</span>
<span class="n">request_duration</span> <span class="o">=</span> <span class="nc">Histogram</span><span class="p">(</span><span class="sh">'</span><span class="s">http_request_duration_seconds</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">HTTP request duration</span><span class="sh">'</span><span class="p">,</span> <span class="p">[</span><span class="sh">'</span><span class="s">method</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">endpoint</span><span class="sh">'</span><span class="p">])</span>
<span class="n">active_connections</span> <span class="o">=</span> <span class="nc">Gauge</span><span class="p">(</span><span class="sh">'</span><span class="s">active_connections</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Number of active connections</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Middleware for metrics collection
</span><span class="k">async</span> <span class="k">def</span> <span class="nf">metrics_middleware</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
    <span class="n">active_connections</span><span class="p">.</span><span class="nf">inc</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Process request
</span>        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">handler</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        
        <span class="c1"># Record metrics
</span>        <span class="n">request_count</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">method</span><span class="p">,</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">path</span>
        <span class="p">).</span><span class="nf">inc</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">response</span>
        
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Record duration
</span>        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">request_duration</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">method</span><span class="p">,</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">path</span>
        <span class="p">).</span><span class="nf">observe</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        
        <span class="n">active_connections</span><span class="p">.</span><span class="nf">dec</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="distributed-logging">Distributed Logging</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">pythonjsonlogger</span> <span class="kn">import</span> <span class="n">jsonlogger</span>

<span class="c1"># Configure structured logging
</span><span class="n">logHandler</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nc">StreamHandler</span><span class="p">()</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">jsonlogger</span><span class="p">.</span><span class="nc">JsonFormatter</span><span class="p">()</span>
<span class="n">logHandler</span><span class="p">.</span><span class="nf">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">logHandler</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">DistributedLogger</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">node_id</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">service_name</span> <span class="o">=</span> <span class="n">service_name</span>
        <span class="n">self</span><span class="p">.</span><span class="n">node_id</span> <span class="o">=</span> <span class="n">node_id</span>
        
    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Log with distributed context</span><span class="sh">"""</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span>
            <span class="n">level</span><span class="p">,</span>
            <span class="n">message</span><span class="p">,</span>
            <span class="n">extra</span><span class="o">=</span><span class="p">{</span>
                <span class="sh">"</span><span class="s">service</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">service_name</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">node_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">node_id</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">(),</span>
                <span class="sh">"</span><span class="s">trace_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">trace_id</span><span class="sh">"</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">span_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">span_id</span><span class="sh">"</span><span class="p">),</span>
                <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">}</span>
        <span class="p">)</span>
        
<span class="c1"># Usage
</span><span class="n">dist_logger</span> <span class="o">=</span> <span class="nc">DistributedLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">order-service</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">node-1</span><span class="sh">"</span><span class="p">)</span>
<span class="n">dist_logger</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Order processed</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">order_id</span><span class="o">=</span><span class="sh">"</span><span class="s">12345</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">user_id</span><span class="o">=</span><span class="sh">"</span><span class="s">user-789</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">trace_id</span><span class="o">=</span><span class="sh">"</span><span class="s">abc-def-ghi</span><span class="sh">"</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="security-considerations">Security Considerations</h2>

<h3 id="zero-trust-architecture">Zero Trust Architecture</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">jwt</span>
<span class="kn">from</span> <span class="n">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="n">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">padding</span>

<span class="k">class</span> <span class="nc">ZeroTrustAuth</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">private_key</span><span class="p">,</span> <span class="n">public_keys</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">private_key</span>
        <span class="n">self</span><span class="p">.</span><span class="n">public_keys</span> <span class="o">=</span> <span class="n">public_keys</span>  <span class="c1"># Dict of service_name -&gt; public_key
</span>        
    <span class="k">def</span> <span class="nf">create_service_token</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source_service</span><span class="p">,</span> <span class="n">target_service</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Create JWT for service-to-service auth</span><span class="sh">"""</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">iss</span><span class="sh">"</span><span class="p">:</span> <span class="n">source_service</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">aud</span><span class="sh">"</span><span class="p">:</span> <span class="n">target_service</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">exp</span><span class="sh">"</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">ttl</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">iat</span><span class="sh">"</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">jti</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="nf">uuid4</span><span class="p">())</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">jwt</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">private_key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="sh">"</span><span class="s">RS256</span><span class="sh">"</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">verify_service_token</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">expected_audience</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Verify incoming service token</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Decode without verification first to get issuer
</span>            <span class="n">unverified</span> <span class="o">=</span> <span class="n">jwt</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">verify_signature</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>
            <span class="n">issuer</span> <span class="o">=</span> <span class="n">unverified</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">iss</span><span class="sh">"</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">issuer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">public_keys</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Unknown issuer: </span><span class="si">{</span><span class="n">issuer</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                
            <span class="c1"># Verify with issuer's public key
</span>            <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span>
                <span class="n">token</span><span class="p">,</span>
                <span class="n">self</span><span class="p">.</span><span class="n">public_keys</span><span class="p">[</span><span class="n">issuer</span><span class="p">],</span>
                <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">RS256</span><span class="sh">"</span><span class="p">],</span>
                <span class="n">audience</span><span class="o">=</span><span class="n">expected_audience</span>
            <span class="p">)</span>
            
            <span class="k">return</span> <span class="n">payload</span>
            
        <span class="k">except</span> <span class="n">jwt</span><span class="p">.</span><span class="n">ExpiredSignatureError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">Token expired</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">jwt</span><span class="p">.</span><span class="n">InvalidTokenError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">Invalid token</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="encryption-in-transit">Encryption in Transit</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">ssl</span>
<span class="kn">import</span> <span class="n">aiohttp</span>

<span class="k">class</span> <span class="nc">SecureClient</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ca_cert_path</span><span class="p">,</span> <span class="n">client_cert_path</span><span class="p">,</span> <span class="n">client_key_path</span><span class="p">):</span>
        <span class="c1"># Create SSL context with mutual TLS
</span>        <span class="n">self</span><span class="p">.</span><span class="n">ssl_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="p">.</span><span class="nf">create_default_context</span><span class="p">(</span>
            <span class="n">ssl</span><span class="p">.</span><span class="n">Purpose</span><span class="p">.</span><span class="n">SERVER_AUTH</span><span class="p">,</span>
            <span class="n">cafile</span><span class="o">=</span><span class="n">ca_cert_path</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ssl_context</span><span class="p">.</span><span class="nf">load_cert_chain</span><span class="p">(</span>
            <span class="n">certfile</span><span class="o">=</span><span class="n">client_cert_path</span><span class="p">,</span>
            <span class="n">keyfile</span><span class="o">=</span><span class="n">client_key_path</span>
        <span class="p">)</span>
        
    <span class="k">async</span> <span class="k">def</span> <span class="nf">secure_request</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Make secure HTTPS request with mTLS</span><span class="sh">"""</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="p">.</span><span class="nc">TCPConnector</span><span class="p">(</span><span class="n">ssl</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">ssl_context</span><span class="p">)</span>
        
        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="p">.</span><span class="nc">ClientSession</span><span class="p">(</span><span class="n">connector</span><span class="o">=</span><span class="n">connector</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="tools-and-technologies">Tools and Technologies</h2>

<h3 id="container-orchestration">Container Orchestration</h3>
<ul>
  <li>
<strong>Kubernetes</strong>: Production-grade container orchestration</li>
  <li>
<strong>Docker Swarm</strong>: Simple container orchestration</li>
  <li>
<strong>Nomad</strong>: Flexible workload orchestrator</li>
</ul>

<h3 id="service-mesh">Service Mesh</h3>
<ul>
  <li>
<strong>Istio</strong>: Comprehensive service mesh with traffic management</li>
  <li>
<strong>Linkerd</strong>: Lightweight, security-focused service mesh</li>
  <li>
<strong>Consul Connect</strong>: Service mesh with service discovery</li>
</ul>

<h3 id="message-queuing">Message Queuing</h3>
<ul>
  <li>
<strong>Apache Kafka</strong>: High-throughput distributed streaming</li>
  <li>
<strong>RabbitMQ</strong>: Feature-rich message broker</li>
  <li>
<strong>Redis Streams</strong>: Lightweight message streaming</li>
</ul>

<h3 id="distributed-databases">Distributed Databases</h3>
<ul>
  <li>
<strong>Cassandra</strong>: Wide column store for big data</li>
  <li>
<strong>CockroachDB</strong>: Distributed SQL database</li>
  <li>
<strong>MongoDB</strong>: Document database with sharding</li>
</ul>

<h3 id="monitoring-and-observability-1">Monitoring and Observability</h3>
<ul>
  <li>
<strong>Prometheus + Grafana</strong>: Metrics and visualization</li>
  <li>
<strong>Jaeger</strong>: Distributed tracing</li>
  <li>
<strong>ELK Stack</strong>: Logging and analysis</li>
</ul>

<h2 id="best-practices">Best Practices</h2>

<h3 id="design-principles">Design Principles</h3>

<ol>
  <li>
<strong>Design for Failure</strong>: Assume components will fail</li>
  <li>
<strong>Stateless Services</strong>: Keep state in databases, not services</li>
  <li>
<strong>Idempotency</strong>: Operations should be safe to retry</li>
  <li>
<strong>Backward Compatibility</strong>: Version APIs carefully</li>
  <li>
<strong>Observability First</strong>: Build monitoring into the design</li>
</ol>

<h3 id="operational-excellence">Operational Excellence</h3>

<ol>
  <li>
<strong>Automate Everything</strong>: Infrastructure as code</li>
  <li>
<strong>Progressive Rollouts</strong>: Canary deployments and feature flags</li>
  <li>
<strong>Capacity Planning</strong>: Monitor and predict resource needs</li>
  <li>
<strong>Disaster Recovery</strong>: Regular backups and failover testing</li>
  <li>
<strong>Security by Default</strong>: Encrypt, authenticate, authorize</li>
</ol>

<h3 id="development-practices">Development Practices</h3>

<ol>
  <li>
<strong>Contract Testing</strong>: Verify service interfaces</li>
  <li>
<strong>Chaos Engineering</strong>: Test failure scenarios</li>
  <li>
<strong>Performance Testing</strong>: Load and stress testing</li>
  <li>
<strong>Documentation</strong>: API specs and runbooks</li>
  <li>
<strong>Code Reviews</strong>: Distributed systems expertise</li>
</ol>

<h2 id="next-steps">Next Steps</h2>

<p>Ready to dive deeper? Explore these resources:</p>

<ol>
  <li>
<strong><a href="/docs/advanced/distributed-systems-theory.html">Distributed Systems Theory</a></strong> - Formal foundations and proofs</li>
  <li>
<strong><a href="/docs/technology/kubernetes.html">Kubernetes Guide</a></strong> - Container orchestration in practice</li>
  <li>
<strong><a href="/docs/technology/docker.html">Docker Fundamentals</a></strong> - Containerization basics</li>
</ol>

<h3 id="advanced-topics">Advanced Topics</h3>

<ul>
  <li>
<strong>Blockchain and Consensus</strong>: Distributed ledgers and cryptocurrencies</li>
  <li>
<strong>Edge Computing</strong>: Pushing computation to the network edge</li>
  <li>
<strong>Serverless Architectures</strong>: Function-as-a-Service patterns</li>
  <li>
<strong>Multi-Region Deployments</strong>: Global scale architectures</li>
</ul>

<div class="code-example bg-yellow-000">
  <p><strong>Note</strong>: Distributed systems are inherently complex. Start with simple patterns and gradually increase sophistication as you gain experience. Always prioritize reliability and maintainability over premature optimization.</p>
</div>

<h2 id="resources">Resources</h2>

<h3 id="books">Books</h3>
<ul>
  <li>‚ÄúDesigning Data-Intensive Applications‚Äù by Martin Kleppmann</li>
  <li>‚ÄúDistributed Systems: Principles and Paradigms‚Äù by Tanenbaum &amp; Van Steen</li>
  <li>‚ÄúSite Reliability Engineering‚Äù by Google</li>
</ul>

<h3 id="papers">Papers</h3>
<ul>
  <li><a href="https://research.google/pubs/pub51/">The Google File System</a></li>
  <li><a href="https://research.google/pubs/pub62/">MapReduce: Simplified Data Processing</a></li>
  <li><a href="https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf">Dynamo: Amazon‚Äôs Highly Available Key-value Store</a></li>
</ul>

<h3 id="online-courses">Online Courses</h3>
<ul>
  <li><a href="https://pdos.csail.mit.edu/6.824/">MIT 6.824: Distributed Systems</a></li>
  <li><a href="https://www.cl.cam.ac.uk/teaching/2122/ConcDisSys/">Distributed Systems Course by Martin Kleppmann</a></li>
</ul>

<h3 id="community">Community</h3>
<ul>
  <li><a href="https://reddit.com/r/distributedsystems">/r/distributedsystems</a></li>
  <li><a href="https://dsrg.pdos.csail.mit.edu/">Distributed Systems Reading Group</a></li>
  <li><a href="http://highscalability.com/">High Scalability</a></li>
</ul>

<hr>

<p><em>Building distributed systems is a journey of continuous learning. Start with the fundamentals, practice with real implementations, and always be prepared for the unexpected failures that make distributed systems both challenging and fascinating.</em></p>

      </section>
    </div>
  </article>
</div>
</body>
</html>