<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

<!-- SEO Meta Tags -->
<meta name="description" content="Technology and Physics notes">
<meta name="author" content="Andrew">

<!-- Open Graph -->
<meta property="og:title" content="AWS Infrastructure & Operations">
<meta property="og:description" content="Technology and Physics notes">
<meta property="og:type" content="website">
<meta property="og:url" content="https://andrewaltimit.github.io/Documentation/docs/technology/aws/infrastructure.html">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AWS Infrastructure & Operations">
<meta name="twitter:description" content="Technology and Physics notes">

<title>AWS Infrastructure & Operations | Andrews Notebook</title>


  <link href="/Documentation/feed.xml" type="application/atom+xml" rel="alternate" title="Andrews Notebook Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/Documentation/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>

<!-- Custom styles -->
<!-- MathJax for LaTeX equation rendering -->
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<style>
/* MathJax equation styling */
mjx-container {
  overflow-x: auto;
  overflow-y: hidden;
  max-width: 100%;
}

mjx-container[display="true"] {
  display: block !important;
  margin: 1.5em 0 !important;
  text-align: center;
}

mjx-container[display="true"] svg {
  max-width: 100%;
  height: auto;
}

/* Inline equations */
mjx-container:not([display="true"]) {
  display: inline !important;
  margin: 0 0.1em;
}

/* Equation numbering (if used) */
.MathJax .mjx-mtr {
  margin: 0.25em 0;
}

/* Better scrolling for wide equations on mobile */
@media (max-width: 768px) {
  mjx-container[display="true"] {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
}
</style>

<!-- Custom styles for documentation -->
<link rel="stylesheet" href="/Documentation/style.css?v=2.0.1">
<link rel="stylesheet" href="/Documentation/assets/css/condensed.css?v=2.0.1">
<style>
  /* Widescreen optimized layout */
  body {
    overflow-x: hidden;
    margin: 0;
    padding: 0;
  }
  
  /* Main container - full width */
  #main {
    display: flex;
    position: relative;
    min-height: 100vh;
    width: 100%;
    max-width: 100%;
  }
  
  /* Sidebar fixed to left edge */
  .sidebar.sticky {
    position: fixed;
    left: 0;
    top: 0;
    width: 280px;
    height: 100vh;
    overflow-y: auto;
    background-color: #f8f9fa;
    border-right: 1px solid #e1e4e8;
    padding: 2rem 1rem;
    z-index: 100;
  }
  
  /* Sidebar navigation styling */
  .nav__list {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  
  .nav__title {
    margin: 1.5rem 0 0.5rem;
    padding: 0.25rem 0;
    font-size: 0.75rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #666;
    border-bottom: 1px solid #e1e4e8;
  }
  
  .nav__items {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  
  .nav__items a {
    display: block;
    padding: 0.3rem 0.75rem;
    font-size: 0.875rem;
    color: #333;
    text-decoration: none;
    border-left: 3px solid transparent;
    transition: all 0.2s ease;
  }
  
  .nav__items a:hover {
    color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
    border-left-color: #0066cc;
  }
  
  .nav__items a.active {
    color: #0066cc;
    font-weight: 600;
    border-left-color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
  }

  /* Collapsible navigation sections */
  .nav__item--collapsible {
    margin: 0.25rem 0;
  }

  .nav__item--collapsible details {
    margin: 0;
  }

  .nav__item--collapsible summary {
    display: flex;
    align-items: center;
    padding: 0.3rem 0.75rem;
    font-size: 0.875rem;
    color: #333;
    cursor: pointer;
    border-left: 3px solid transparent;
    transition: all 0.2s ease;
    list-style: none;
  }

  .nav__item--collapsible summary::-webkit-details-marker {
    display: none;
  }

  .nav__item--collapsible summary::before {
    content: "▸";
    display: inline-block;
    margin-right: 0.5rem;
    font-size: 0.7rem;
    transition: transform 0.2s ease;
  }

  .nav__item--collapsible details[open] > summary::before {
    transform: rotate(90deg);
  }

  .nav__item--collapsible summary:hover {
    color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
    border-left-color: #0066cc;
  }

  .nav__item--collapsible summary a {
    display: inline;
    padding: 0;
    border-left: none;
    font-weight: 500;
  }

  .nav__item--collapsible summary a:hover {
    background: none;
    border-left: none;
  }

  .nav__item--collapsible summary a.active {
    color: #0066cc;
    font-weight: 600;
    background: none;
    border-left: none;
  }

  /* Nested sub-items */
  .nav__subitems {
    margin: 0;
    padding: 0;
    list-style: none;
    padding-left: 1.25rem;
    border-left: 1px solid #e1e4e8;
    margin-left: 1rem;
  }

  .nav__subitems li {
    margin: 0;
  }

  .nav__subitems a {
    display: block;
    padding: 0.25rem 0.5rem;
    font-size: 0.8125rem;
    color: #555;
    text-decoration: none;
    border-left: 2px solid transparent;
    transition: all 0.2s ease;
  }

  .nav__subitems a:hover {
    color: #0066cc;
    background-color: rgba(0, 102, 204, 0.03);
    border-left-color: #0066cc;
  }

  .nav__subitems a.active {
    color: #0066cc;
    font-weight: 600;
    border-left-color: #0066cc;
    background-color: rgba(0, 102, 204, 0.05);
  }

  /* Content area with left margin for sidebar */
  article.page {
    margin-left: 280px;
    min-height: 100vh;
    background: white;
    width: calc(100% - 280px);
    max-width: none;
  }
  
  /* Content wrapper - use full width */
  .page__inner-wrap {
    max-width: none;
    margin: 0;
    padding: 2rem 3rem;
  }
  
  .page__title {
    margin-top: 0;
    margin-bottom: 2rem;
    font-size: 2.5rem;
    font-weight: 700;
    line-height: 1.2;
  }
  
  /* Let content use available width */
  .page__content {
    max-width: none;
    width: 100%;
  }
  
  /* For optimal reading, constrain just the text paragraphs */
  .page__content > p,
  .page__content > ul,
  .page__content > ol {
    max-width: 65ch;
  }
  
  /* Let code blocks, tables, and special content use full width */
  .page__content pre,
  .page__content table,
  .page__content .noteBoxes,
  .page__content figure,
  .page__content .highlight {
    max-width: 100%;
  }
  
  /* Wide note boxes */
  .noteBoxes {
    width: 90% !important;
    max-width: 800px;
  }
  
  /* Tables use available width */
  table {
    width: 100%;
    max-width: 100%;
  }
  
  /* Code blocks optimization */
  pre {
    max-width: 100%;
    overflow-x: auto;
  }
  
  .highlight {
    max-width: 100%;
    margin: 1rem 0;
  }
  
  /* Responsive adjustments */
  @media (min-width: 2000px) {
    .sidebar.sticky {
      width: 320px;
    }
    
    article.page {
      margin-left: 320px;
      width: calc(100% - 320px);
    }
    
    .page__inner-wrap {
      padding: 2rem 4rem;
    }
    
    .page__content > p,
    .page__content > ul,
    .page__content > ol {
      max-width: 75ch;
    }
  }
  
  @media (min-width: 1024px) and (max-width: 1439px) {
    .sidebar.sticky {
      width: 250px;
    }
    
    article.page {
      margin-left: 250px;
      width: calc(100% - 250px);
    }
    
    .page__inner-wrap {
      padding: 2rem 2rem;
    }
  }
  
  /* Tablet and mobile */
  @media (max-width: 1023px) {
    #main {
      flex-direction: column;
    }
    
    .sidebar.sticky {
      position: relative;
      width: 100%;
      height: auto;
      border-right: none;
      border-bottom: 1px solid #e1e4e8;
      padding: 1rem;
    }
    
    article.page {
      margin-left: 0;
      width: 100%;
    }
    
    .page__inner-wrap {
      padding: 1rem;
    }
    
    .page__content > p,
    .page__content > ul,
    .page__content > ol {
      max-width: 100%;
    }
  }
  
  /* Mobile navigation toggle */
  .nav-toggle {
    display: none;
  }
  
  @media (max-width: 1023px) {
    .nav-toggle {
      display: block;
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 200;
      background: #0066cc;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .sidebar.sticky {
      position: fixed;
      left: -100%;
      top: 0;
      transition: left 0.3s ease;
      z-index: 150;
      height: 100vh;
      width: 280px;
    }
    
    .sidebar.sticky.active {
      left: 0;
    }
    
    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 140;
    }
    
    .sidebar-overlay.active {
      display: block;
    }
    
    article.page {
      margin-left: 0;
      width: 100%;
    }
  }
</style>

<!-- Mobile navigation toggle script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Mobile menu functionality
  if (window.innerWidth <= 1023) {
    if (!document.querySelector('.nav-toggle')) {
      const toggleBtn = document.createElement('button');
      toggleBtn.className = 'nav-toggle';
      toggleBtn.innerHTML = '☰ Menu';
      toggleBtn.setAttribute('aria-label', 'Toggle navigation menu');
      document.body.appendChild(toggleBtn);
      
      const overlay = document.createElement('div');
      overlay.className = 'sidebar-overlay';
      document.body.appendChild(overlay);
      
      toggleBtn.addEventListener('click', function() {
        const sidebar = document.querySelector('.sidebar.sticky');
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
      });
      
      overlay.addEventListener('click', function() {
        const sidebar = document.querySelector('.sidebar.sticky');
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
    }
  }
  
  // Handle window resize
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      const sidebar = document.querySelector('.sidebar.sticky');
      const overlay = document.querySelector('.sidebar-overlay');
      const toggle = document.querySelector('.nav-toggle');
      
      if (window.innerWidth > 1023) {
        if (sidebar) sidebar.classList.remove('active');
        if (overlay) overlay.classList.remove('active');
        if (toggle) toggle.style.display = 'none';
      } else {
        if (toggle) toggle.style.display = 'block';
      }
    }, 250);
  });
});
</script>


  
    <script src="/Documentation/assets/js/custom.js"></script>
  

</head>
<body>
  <div id="main" role="main">
  <aside class="sidebar sticky">
    <nav class="nav__list">
      
        
          <h3 class="nav__title">Navigation</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/topic-map.html">
                      <span class="nav__sub-title">Topic Map</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/search.html">
                      <span class="nav__sub-title">Search</span>
                    </a>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">Technology</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/technology/index.html">
                      <span class="nav__sub-title">Technology Overview</span>
                    </a>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details open data-nav-section="aws">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/aws/">
                            AWS
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/compute.html">
                              Compute
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/storage.html">
                              Storage
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/databases.html">
                              Databases
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/networking.html">
                              Networking
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/security.html">
                              Security
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/aws/infrastructure.html" class="active">
                              Infrastructure
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="terraform">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/terraform/">
                            Terraform
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/terraform/core-concepts.html">
                              Core Concepts
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/terraform/state-modules.html">
                              State &amp; Modules
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/terraform/patterns.html">
                              Enterprise Patterns
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/terraform/advanced.html">
                              Advanced Topics
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="kubernetes">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/kubernetes/">
                            Kubernetes
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/kubernetes/fundamentals.html">
                              Fundamentals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/kubernetes/workloads.html">
                              Workloads &amp; Storage
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/kubernetes/operations.html">
                              Operations
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/kubernetes/advanced.html">
                              Advanced Topics
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="docker">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/docker/">
                            Docker
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/docker/fundamentals.html">
                              Fundamentals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/docker/storage-security.html">
                              Storage &amp; Security
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/docker/dockerfiles.html">
                              Dockerfiles &amp; CI/CD
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/docker/advanced.html">
                              Advanced Patterns
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="version-control">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/git.html">
                            Version Control
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/git-crash-course.html">
                              Git Fundamentals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/git.html">
                              Git Internals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/git-reference.html">
                              Command Reference
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/branching.html">
                              Branching Strategies
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="devops-ci-cd">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/ci-cd.html">
                            DevOps &amp; CI/CD
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/ci-cd.html">
                              CI/CD Pipelines
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/please-build.html">
                              Please Build
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="infrastructure">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/networking.html">
                            Infrastructure
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/networking.html">
                              Networking
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/database-crash-course.html">
                              Database Fundamentals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/database-design.html">
                              Database Design
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/cybersecurity.html">
                              Cybersecurity
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="ai-foundations">
                      <summary>
                        
                          <a href="/Documentation/docs/technology/ai.html">
                            AI Foundations
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/technology/ai.html">
                              AI Fundamentals
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/ai-fundamentals-simple.html">
                              AI Simplified
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/ai-lecture-2023.html">
                              AI Lecture 2023
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/technology/unreal.html">
                      <span class="nav__sub-title">Unreal Engine</span>
                    </a>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">Specialized Topics</h3>
          
            <ul class="nav__items">
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="computing">
                      <summary>
                        
                          <a href="/Documentation/docs/distributed-systems/index.html">
                            Computing
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/distributed-systems/index.html">
                              Distributed Systems
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/technology/quantumcomputing.html">
                              Quantum Computing
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/quantum-computing/index.html">
                              Quantum Computing Hub
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/artificial-intelligence/index.html">
                              AI Hub
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="creative-development">
                      <summary>
                        
                          <a href="/Documentation/docs/gamedev/index.html">
                            Creative Development
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/gamedev/index.html">
                              Game Development
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/graphics/3d-rendering.html">
                              3D Graphics
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/vr-ar/index.html">
                              VR/AR Development
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/optimization/index.html">
                      <span class="nav__sub-title">Performance Optimization</span>
                    </a>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">AI/ML - Generative AI</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/ai-ml/index.html">
                      <span class="nav__sub-title">AI/ML Overview</span>
                    </a>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="fundamentals">
                      <summary>
                        
                          <a href="/Documentation/docs/ai-ml/stable-diffusion-fundamentals.html">
                            Fundamentals
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/stable-diffusion-fundamentals.html">
                              Stable Diffusion
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/base-models-comparison.html">
                              Base Models
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/model-types.html">
                              Model Types
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="training-tools">
                      <summary>
                        
                          <a href="/Documentation/docs/ai-ml/lora-training.html">
                            Training &amp; Tools
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/lora-training.html">
                              LoRA Training
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/controlnet.html">
                              ControlNet
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/comfyui-guide.html">
                              ComfyUI
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="production">
                      <summary>
                        
                          <a href="/Documentation/docs/ai-ml/output-formats.html">
                            Production
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/output-formats.html">
                              Output Formats
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/ai-ml/advanced-techniques.html">
                              Advanced Techniques
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">Physics</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/physics/index.html">
                      <span class="nav__sub-title">Physics Overview</span>
                    </a>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="classical-physics">
                      <summary>
                        
                          <a href="/Documentation/docs/physics/classical-mechanics.html">
                            Classical Physics
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/physics/classical-mechanics.html">
                              Classical Mechanics
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/thermodynamics.html">
                              Thermodynamics
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/statistical-mechanics.html">
                              Statistical Mechanics
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="quantum-modern">
                      <summary>
                        
                          <a href="/Documentation/docs/physics/quantum-mechanics.html">
                            Quantum &amp; Modern
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/physics/quantum-mechanics.html">
                              Quantum Mechanics
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/relativity.html">
                              Relativity
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/quantum-field-theory.html">
                              Quantum Field Theory
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
                
                  
                  
                  <li class="nav__item--collapsible">
                    <details data-nav-section="advanced-topics">
                      <summary>
                        
                          <a href="/Documentation/docs/physics/condensed-matter.html">
                            Advanced Topics
                          </a>
                        
                      </summary>
                      <ul class="nav__subitems">
                        
                          <li>
                            <a href="/Documentation/docs/physics/condensed-matter.html">
                              Condensed Matter
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/string-theory.html">
                              String Theory
                            </a>
                          </li>
                        
                          <li>
                            <a href="/Documentation/docs/physics/computational-physics.html">
                              Computational Physics
                            </a>
                          </li>
                        
                      </ul>
                    </details>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">Advanced Topics</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/advanced/index.html">
                      <span class="nav__sub-title">Research Hub</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/advanced/ai-mathematics/">
                      <span class="nav__sub-title">AI Mathematics</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/advanced/distributed-systems-theory/">
                      <span class="nav__sub-title">Distributed Systems Theory</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/advanced/quantum-algorithms-research/">
                      <span class="nav__sub-title">Quantum Algorithms Research</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/advanced/monorepo/">
                      <span class="nav__sub-title">Monorepo Architecture</span>
                    </a>
                  </li>
                
              
            </ul>
          
        
          <h3 class="nav__title">Quick Reference</h3>
          
            <ul class="nav__items">
              
                <li>
                    <a href="/Documentation/docs/reference/index.html">
                      <span class="nav__sub-title">Reference Guide</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#command-line-references">
                      <span class="nav__sub-title">Command Cheat Sheets</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#physics-formulas--constants">
                      <span class="nav__sub-title">Physics Formulas</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#algorithms--data-structures">
                      <span class="nav__sub-title">Algorithms &amp; Big O</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#api-reference-patterns">
                      <span class="nav__sub-title">API Patterns</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#troubleshooting-flowcharts">
                      <span class="nav__sub-title">Troubleshooting</span>
                    </a>
                  </li>
                
              
                <li>
                    <a href="/Documentation/docs/reference/index.html#best-practices-checklists">
                      <span class="nav__sub-title">Best Practices</span>
                    </a>
                  </li>
                
              
            </ul>
          
        
      
    </nav>
  </aside>

  <article class="page">
    <div class="page__inner-wrap">
      <header>
        
      </header>

      <section class="page__content">
        <div class="hero-section" style="background: linear-gradient(135deg, #ff9900 0%, #ffb84d 100%); color: white; padding: 3rem 2rem; margin: -2rem -3rem 2rem -3rem; text-align: center;">
  <h1 style="color: white; margin: 0; font-size: 2.5rem;">AWS Infrastructure &amp; Operations</h1>
  <p style="font-size: 1.25rem; margin-top: 1rem; opacity: 0.9;">Master CloudWatch monitoring, CloudFormation IaC, architecture patterns, cost optimization, and production troubleshooting.</p>
</div>

<p>This comprehensive guide covers CloudWatch monitoring, CloudFormation infrastructure as code, architecture patterns, cost optimization, and troubleshooting. Learn how to build, operate, and optimize production AWS environments.</p>

<h3 id="monitoring-and-management-your-cloud-operations-center">Monitoring and Management: Your Cloud Operations Center</h3>

<h4 id="amazon-cloudwatch---your-eyes-in-the-cloud">Amazon CloudWatch - Your Eyes in the Cloud</h4>
<p>CloudWatch is AWS’s monitoring service that collects and tracks metrics, logs, and events from every part of your infrastructure. Think of it as your 24/7 operations center.</p>

<p><strong>Key CloudWatch Features</strong>:</p>

<ol>
  <li>
<strong>Metrics and Alarms</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Create billing alarm to avoid surprises</span>
aws cloudwatch put-metric-alarm <span class="se">\</span>
  <span class="nt">--alarm-name</span> billing-alarm <span class="se">\</span>
  <span class="nt">--alarm-description</span> <span class="s2">"Alert when AWS charges exceed </span><span class="nv">$100</span><span class="s2">"</span> <span class="se">\</span>
  <span class="nt">--metric-name</span> EstimatedCharges <span class="se">\</span>
  <span class="nt">--namespace</span> AWS/Billing <span class="se">\</span>
  <span class="nt">--statistic</span> Maximum <span class="se">\</span>
  <span class="nt">--period</span> 86400 <span class="se">\</span>
  <span class="nt">--threshold</span> 100 <span class="se">\</span>
  <span class="nt">--comparison-operator</span> GreaterThanThreshold <span class="se">\</span>
  <span class="nt">--dimensions</span> <span class="nv">Name</span><span class="o">=</span>Currency,Value<span class="o">=</span>USD
</code></pre></div>    </div>
  </li>
  <li>
<strong>Custom Metrics for Application Monitoring</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">boto3</span>
<span class="kn">import</span> <span class="n">time</span>
   
<span class="n">cloudwatch</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">cloudwatch</span><span class="sh">'</span><span class="p">)</span>
   
<span class="c1"># Send custom metric
</span><span class="k">def</span> <span class="nf">track_user_login</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">cloudwatch</span><span class="p">.</span><span class="nf">put_metric_data</span><span class="p">(</span>
        <span class="n">Namespace</span><span class="o">=</span><span class="sh">'</span><span class="s">MyApp</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">MetricData</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span>
                <span class="sh">'</span><span class="s">MetricName</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">UserLogins</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">Dimensions</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="sh">'</span><span class="s">Name</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Environment</span><span class="sh">'</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">Value</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Production</span><span class="sh">'</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="sh">'</span><span class="s">Value</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">Unit</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Count</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">Timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Log Insights for Troubleshooting</strong>
    <div class="language-sql highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1">-- Find slowest API endpoints</span>
<span class="n">fields</span> <span class="o">@</span><span class="nb">timestamp</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">path</span>
<span class="o">|</span> <span class="n">filter</span> <span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">1000</span>
<span class="o">|</span> <span class="n">sort</span> <span class="n">duration</span> <span class="k">desc</span>
<span class="o">|</span> <span class="k">limit</span> <span class="mi">20</span>
   
<span class="c1">-- Count errors by type</span>
<span class="n">fields</span> <span class="o">@</span><span class="nb">timestamp</span><span class="p">,</span> <span class="n">error_type</span>
<span class="o">|</span> <span class="n">filter</span> <span class="o">@</span><span class="n">message</span> <span class="k">like</span> <span class="o">/</span><span class="n">ERROR</span><span class="o">/</span>
<span class="o">|</span> <span class="n">stats</span> <span class="k">count</span><span class="p">()</span> <span class="k">by</span> <span class="n">error_type</span>
</code></pre></div>    </div>
  </li>
</ol>

<p><strong>Common CloudWatch Pitfall</strong>: Not setting up log retention, leading to unexpected costs. Always set retention policies:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws logs put-retention-policy <span class="se">\</span>
  <span class="nt">--log-group-name</span> /aws/lambda/my-function <span class="se">\</span>
  <span class="nt">--retention-in-days</span> 30
</code></pre></div></div>

<h4 id="aws-cloudformation---infrastructure-as-code">AWS CloudFormation - Infrastructure as Code</h4>
<p>CloudFormation lets you define your entire infrastructure in JSON or YAML templates. Instead of clicking through the console, you describe what you want and CloudFormation builds it.</p>

<p><strong>Why CloudFormation Matters</strong>:</p>
<ul>
  <li>Version control your infrastructure</li>
  <li>Replicate environments exactly</li>
  <li>Roll back changes if something breaks</li>
  <li>Share templates with your team</li>
</ul>

<p><strong>Practical CloudFormation Example</strong>:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># template.yml - Complete web application stack</span>
<span class="na">AWSTemplateFormatVersion</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2010-09-09'</span>
<span class="na">Description</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Web</span><span class="nv"> </span><span class="s">application</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">auto-scaling'</span>

<span class="na">Parameters</span><span class="pi">:</span>
  <span class="na">KeyName</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::EC2::KeyPair::KeyName</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">EC2 Key Pair for SSH access</span>

<span class="na">Resources</span><span class="pi">:</span>
  <span class="c1"># Application Load Balancer</span>
  <span class="na">LoadBalancer</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::ElasticLoadBalancingV2::LoadBalancer</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">Subnets</span><span class="pi">:</span> 
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet1</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">PublicSubnet2</span>
      <span class="na">SecurityGroups</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">LoadBalancerSecurityGroup</span>

  <span class="c1"># Auto Scaling Group</span>
  <span class="na">AutoScalingGroup</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::AutoScaling::AutoScalingGroup</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">MinSize</span><span class="pi">:</span> <span class="m">2</span>
      <span class="na">MaxSize</span><span class="pi">:</span> <span class="m">10</span>
      <span class="na">DesiredCapacity</span><span class="pi">:</span> <span class="m">4</span>
      <span class="na">LaunchTemplate</span><span class="pi">:</span>
        <span class="na">LaunchTemplateId</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">LaunchTemplate</span>
        <span class="na">Version</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">LaunchTemplate.LatestVersionNumber</span>
      <span class="na">TargetGroupARNs</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="kt">!Ref</span> <span class="s">TargetGroup</span>
      <span class="na">HealthCheckType</span><span class="pi">:</span> <span class="s">ELB</span>
      <span class="na">HealthCheckGracePeriod</span><span class="pi">:</span> <span class="m">300</span>

  <span class="c1"># Scaling Policy</span>
  <span class="na">ScaleUpPolicy</span><span class="pi">:</span>
    <span class="na">Type</span><span class="pi">:</span> <span class="s">AWS::AutoScaling::ScalingPolicy</span>
    <span class="na">Properties</span><span class="pi">:</span>
      <span class="na">AutoScalingGroupName</span><span class="pi">:</span> <span class="kt">!Ref</span> <span class="s">AutoScalingGroup</span>
      <span class="na">PolicyType</span><span class="pi">:</span> <span class="s">TargetTrackingScaling</span>
      <span class="na">TargetTrackingConfiguration</span><span class="pi">:</span>
        <span class="na">PredefinedMetricSpecification</span><span class="pi">:</span>
          <span class="na">PredefinedMetricType</span><span class="pi">:</span> <span class="s">ASGAverageCPUUtilization</span>
        <span class="na">TargetValue</span><span class="pi">:</span> <span class="m">70</span>

<span class="na">Outputs</span><span class="pi">:</span>
  <span class="na">LoadBalancerDNS</span><span class="pi">:</span>
    <span class="na">Description</span><span class="pi">:</span> <span class="s">DNS name of load balancer</span>
    <span class="na">Value</span><span class="pi">:</span> <span class="kt">!GetAtt</span> <span class="s">LoadBalancer.DNSName</span>
    <span class="na">Export</span><span class="pi">:</span>
      <span class="na">Name</span><span class="pi">:</span> <span class="kt">!Sub</span> <span class="s">${AWS::StackName}-LoadBalancer-DNS</span>
</code></pre></div></div>

<p><strong>Deploy with</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws cloudformation create-stack <span class="se">\</span>
  <span class="nt">--stack-name</span> my-web-app <span class="se">\</span>
  <span class="nt">--template-body</span> file://template.yml <span class="se">\</span>
  <span class="nt">--parameters</span> <span class="nv">ParameterKey</span><span class="o">=</span>KeyName,ParameterValue<span class="o">=</span>my-key
</code></pre></div></div>

<h3 id="messaging-and-integration-connecting-your-services">Messaging and Integration: Connecting Your Services</h3>

<h4 id="amazon-sns---simple-notification-service">Amazon SNS - Simple Notification Service</h4>
<p>SNS is a pub/sub messaging service that lets you send messages to multiple subscribers. Think of it as a broadcasting system for your applications.</p>

<p><strong>Real-world SNS Patterns</strong>:</p>

<ol>
  <li>
<strong>Multi-Channel Notifications</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">boto3</span>
   
<span class="n">sns</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">sns</span><span class="sh">'</span><span class="p">)</span>
   
<span class="c1"># Create topic
</span><span class="n">topic</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="nf">create_topic</span><span class="p">(</span><span class="n">Name</span><span class="o">=</span><span class="sh">'</span><span class="s">order-updates</span><span class="sh">'</span><span class="p">)</span>
<span class="n">topic_arn</span> <span class="o">=</span> <span class="n">topic</span><span class="p">[</span><span class="sh">'</span><span class="s">TopicArn</span><span class="sh">'</span><span class="p">]</span>
   
<span class="c1"># Subscribe email
</span><span class="n">sns</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">(</span>
    <span class="n">TopicArn</span><span class="o">=</span><span class="n">topic_arn</span><span class="p">,</span>
    <span class="n">Protocol</span><span class="o">=</span><span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">Endpoint</span><span class="o">=</span><span class="sh">'</span><span class="s">customer@example.com</span><span class="sh">'</span>
<span class="p">)</span>
   
<span class="c1"># Subscribe SMS
</span><span class="n">sns</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">(</span>
    <span class="n">TopicArn</span><span class="o">=</span><span class="n">topic_arn</span><span class="p">,</span>
    <span class="n">Protocol</span><span class="o">=</span><span class="sh">'</span><span class="s">sms</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">Endpoint</span><span class="o">=</span><span class="sh">'</span><span class="s">+1234567890</span><span class="sh">'</span>
<span class="p">)</span>
   
<span class="c1"># Subscribe Lambda for processing
</span><span class="n">sns</span><span class="p">.</span><span class="nf">subscribe</span><span class="p">(</span>
    <span class="n">TopicArn</span><span class="o">=</span><span class="n">topic_arn</span><span class="p">,</span>
    <span class="n">Protocol</span><span class="o">=</span><span class="sh">'</span><span class="s">lambda</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">Endpoint</span><span class="o">=</span><span class="sh">'</span><span class="s">arn:aws:lambda:region:account:function:process-order</span><span class="sh">'</span>
<span class="p">)</span>
   
<span class="c1"># Send notification to all subscribers
</span><span class="n">sns</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span>
    <span class="n">TopicArn</span><span class="o">=</span><span class="n">topic_arn</span><span class="p">,</span>
    <span class="n">Message</span><span class="o">=</span><span class="sh">'</span><span class="s">Order #12345 has been shipped!</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">Subject</span><span class="o">=</span><span class="sh">'</span><span class="s">Order Update</span><span class="sh">'</span>
<span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Fan-out Pattern for Microservices</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Order service publishes once
</span><span class="k">def</span> <span class="nf">complete_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
    <span class="n">sns</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span>
        <span class="n">TopicArn</span><span class="o">=</span><span class="sh">'</span><span class="s">arn:aws:sns:region:account:order-completed</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">Message</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span>
            <span class="sh">'</span><span class="s">orderId</span><span class="sh">'</span><span class="p">:</span> <span class="n">order_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">isoformat</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">:</span> <span class="mf">99.99</span>
        <span class="p">})</span>
    <span class="p">)</span>
   
<span class="c1"># Multiple services subscribe and react
# - Inventory service updates stock
# - Email service sends confirmation
# - Analytics service records sale
# - Shipping service creates label
</span></code></pre></div>    </div>
  </li>
</ol>

<h4 id="amazon-sqs---simple-queue-service">Amazon SQS - Simple Queue Service</h4>
<p>SQS provides reliable, scalable message queues. Unlike SNS (push), SQS is pull-based - consumers request messages when ready to process them.</p>

<p><strong>SQS Best Practices</strong>:</p>

<ol>
  <li>
<strong>Decoupling with Standard Queues</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">boto3</span>
<span class="kn">import</span> <span class="n">json</span>
   
<span class="n">sqs</span> <span class="o">=</span> <span class="n">boto3</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="sh">'</span><span class="s">sqs</span><span class="sh">'</span><span class="p">)</span>
<span class="n">queue_url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://sqs.region.amazonaws.com/account/my-queue</span><span class="sh">'</span>
   
<span class="c1"># Producer: Send messages
</span><span class="k">def</span> <span class="nf">send_task</span><span class="p">(</span><span class="n">task_data</span><span class="p">):</span>
    <span class="n">sqs</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span>
        <span class="n">QueueUrl</span><span class="o">=</span><span class="n">queue_url</span><span class="p">,</span>
        <span class="n">MessageBody</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">task_data</span><span class="p">),</span>
        <span class="n">MessageAttributes</span><span class="o">=</span><span class="p">{</span>
            <span class="sh">'</span><span class="s">Priority</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">StringValue</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">High</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">DataType</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">String</span><span class="sh">'</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">)</span>
   
<span class="c1"># Consumer: Process messages
</span><span class="k">def</span> <span class="nf">process_messages</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">sqs</span><span class="p">.</span><span class="nf">receive_message</span><span class="p">(</span>
            <span class="n">QueueUrl</span><span class="o">=</span><span class="n">queue_url</span><span class="p">,</span>
            <span class="n">MaxNumberOfMessages</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">WaitTimeSeconds</span><span class="o">=</span><span class="mi">20</span>  <span class="c1"># Long polling
</span>        <span class="p">)</span>
           
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">Messages</span><span class="sh">'</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="c1"># Process message
</span>            <span class="nf">process_task</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="sh">'</span><span class="s">Body</span><span class="sh">'</span><span class="p">]))</span>
               
            <span class="c1"># Delete after successful processing
</span>            <span class="n">sqs</span><span class="p">.</span><span class="nf">delete_message</span><span class="p">(</span>
                <span class="n">QueueUrl</span><span class="o">=</span><span class="n">queue_url</span><span class="p">,</span>
                <span class="n">ReceiptHandle</span><span class="o">=</span><span class="n">message</span><span class="p">[</span><span class="sh">'</span><span class="s">ReceiptHandle</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>FIFO Queues for Order Guarantees</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Create FIFO queue for ordered processing
</span><span class="n">fifo_queue</span> <span class="o">=</span> <span class="n">sqs</span><span class="p">.</span><span class="nf">create_queue</span><span class="p">(</span>
    <span class="n">QueueName</span><span class="o">=</span><span class="sh">'</span><span class="s">payment-processing.fifo</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">Attributes</span><span class="o">=</span><span class="p">{</span>
        <span class="sh">'</span><span class="s">FifoQueue</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">ContentBasedDeduplication</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">true</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">)</span>
   
<span class="c1"># Send with message group ID for ordering
</span><span class="n">sqs</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span>
    <span class="n">QueueUrl</span><span class="o">=</span><span class="n">fifo_queue</span><span class="p">[</span><span class="sh">'</span><span class="s">QueueUrl</span><span class="sh">'</span><span class="p">],</span>
    <span class="n">MessageBody</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">payment_data</span><span class="p">),</span>
    <span class="n">MessageGroupId</span><span class="o">=</span><span class="n">user_id</span>  <span class="c1"># All messages for user processed in order
</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<p><strong>Common SQS + SNS Pattern</strong>: Fan-out with buffering</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SNS Topic → SQS Queue 1 → Lambda/EC2 processors
          → SQS Queue 2 → Different processors
          → SQS Queue 3 → Analytics pipeline
</code></pre></div></div>

<p>This pattern combines SNS’s broadcasting with SQS’s reliable delivery and buffering.</p>

<h3 id="essential-resources-for-your-journey">Essential Resources for Your Journey</h3>

<p>Key AWS resources and documentation:</p>

<h4 id="official-resources">Official Resources</h4>
<ul>
  <li>
<strong><a href="https://aws.amazon.com/free/">AWS Free Tier</a></strong>: Your risk-free playground with 12 months of free services</li>
  <li>
<strong><a href="https://aws.amazon.com/architecture/well-architected/">AWS Well-Architected Framework</a></strong>: Learn how AWS experts design systems</li>
  <li>
<strong><a href="https://aws.amazon.com/architecture/">AWS Architecture Center</a></strong>: Real-world reference architectures and patterns</li>
  <li>
<strong><a href="https://aws.amazon.com/training/">AWS Training and Certification</a></strong>: Structured learning paths from beginner to expert</li>
</ul>

<h4 id="developer-tools">Developer Tools</h4>
<ul>
  <li>
<strong><a href="https://aws.amazon.com/tools/">AWS SDKs</a></strong>: Integrate AWS services into your applications</li>
  <li>
<strong><a href="https://aws.amazon.com/cdk/">AWS CDK</a></strong>: Define infrastructure using TypeScript, Python, or Java</li>
  <li>
<strong><a href="https://aws.amazon.com/amplify/">AWS Amplify</a></strong>: Fastest way to build full-stack applications</li>
</ul>

<h4 id="stay-connected">Stay Connected</h4>
<ul>
  <li>
<strong><a href="https://aws.amazon.com/blogs/aws/">AWS Blog</a></strong>: Daily updates on new features and best practices</li>
  <li>
<strong><a href="https://forums.aws.amazon.com/index.jspa">AWS Developer Forums</a></strong>: Get help from the community</li>
  <li>
<strong><a href="https://reinvent.awsevents.com/">AWS re:Invent Videos</a></strong>: Hundreds of free technical sessions</li>
</ul>

<p>Pro tip: Start with the Free Tier and Well-Architected Framework. These two resources alone will accelerate your learning by months.</p>

<h3 id="key-aws-updates-2023-2024">Key AWS Updates (2023-2024)</h3>

<p>Stay current with the latest AWS innovations:</p>

<h4 id="generative-ai-services">Generative AI Services</h4>
<ul>
  <li>
<strong>Amazon Bedrock</strong>: Fully managed service for foundation models (Claude, Llama 2, Stable Diffusion)</li>
  <li>
<strong>Amazon Q</strong>: AI-powered assistant for developers and business users</li>
  <li>
<strong>Amazon CodeWhisperer</strong>: AI code companion (now part of Amazon Q Developer)</li>
  <li>
<strong>PartyRock</strong>: No-code playground for building AI apps</li>
</ul>

<h4 id="compute--serverless">Compute &amp; Serverless</h4>
<ul>
  <li>
<strong>Lambda SnapStart</strong>: Up to 10x faster cold starts for Java functions</li>
  <li>
<strong>Lambda Function URLs</strong>: HTTPS endpoints without API Gateway</li>
  <li>
<strong>EC2 Graviton3</strong>: 25% better performance than Graviton2</li>
  <li>
<strong>AWS App Runner</strong>: Automatic scaling for containerized web apps</li>
</ul>

<h4 id="storage--databases">Storage &amp; Databases</h4>
<ul>
  <li>
<strong>S3 Express One Zone</strong>: Single-digit millisecond latency storage class</li>
  <li>
<strong>Aurora Limitless Database</strong>: Scales beyond a single Aurora cluster</li>
  <li>
<strong>ElastiCache Serverless</strong>: Redis and Memcached without capacity planning</li>
  <li>
<strong>RDS Blue/Green Deployments</strong>: Safe database updates with minimal downtime</li>
</ul>

<h4 id="aiml-platforms">AI/ML Platforms</h4>
<ul>
  <li>
<strong>SageMaker Studio Code Editor</strong>: VS Code-based IDE for ML</li>
  <li>
<strong>SageMaker HyperPod</strong>: Managed infrastructure for training foundation models</li>
  <li>
<strong>AWS Trainium2</strong>: Next-gen ML training chips</li>
  <li>
<strong>SageMaker Canvas</strong>: No-code ML model building</li>
</ul>

<h4 id="developer-experience">Developer Experience</h4>
<ul>
  <li>
<strong>AWS Application Composer</strong>: Visual design for serverless apps</li>
  <li>
<strong>Amazon CodeCatalyst</strong>: Unified software development service</li>
  <li>
<strong>AWS CloudShell</strong>: Browser-based shell with AWS CLI pre-installed</li>
  <li>
<strong>Step Functions Workflow Studio</strong>: Low-code visual workflow designer</li>
</ul>

<h2 id="building-real-applications-architecture-patterns">Building Real Applications: Architecture Patterns</h2>

<p>Now that you understand individual services, let’s see how they work together to solve real problems. These patterns progress from simple to complex, each building on concepts from the previous ones.</p>

<h3 id="pattern-1-static-website-hosting-beginner">Pattern 1: Static Website Hosting (Beginner)</h3>

<p>Let’s start with the simplest cloud architecture - hosting a static website. This pattern introduces core concepts with minimal complexity.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>S3</strong>: Stores your HTML, CSS, and JavaScript files</li>
  <li>
<strong>CloudFront</strong>: Delivers content globally with low latency</li>
  <li>
<strong>Route 53</strong>: Manages your domain name</li>
</ul>

<p><strong>Why this architecture?</strong> It’s serverless (no EC2 instances to manage), globally distributed (CloudFront edge locations), and costs pennies per month for most sites. Perfect for portfolios, documentation, or marketing sites.</p>

<p><strong>Evolution path</strong>: Add API Gateway and Lambda for dynamic features, turning your static site into a full serverless application.</p>

<h3 id="pattern-2-traditional-web-application-intermediate">Pattern 2: Traditional Web Application (Intermediate)</h3>

<p>The classic three-tier architecture, modernized for the cloud. This pattern teaches you networking, security, and scaling concepts.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>VPC</strong>: Your isolated network with public/private subnets</li>
  <li>
<strong>EC2 + Auto Scaling</strong>: Web servers that scale based on traffic</li>
  <li>
<strong>Application Load Balancer</strong>: Distributes traffic across instances</li>
  <li>
<strong>RDS Multi-AZ</strong>: Managed database with automatic failover</li>
  <li>
<strong>ElastiCache</strong>: Redis/Memcached for session storage and caching</li>
</ul>

<p><strong>Why this architecture?</strong> It mirrors traditional on-premise setups but with cloud benefits - automatic scaling, managed databases, and high availability across multiple data centers.</p>

<p><strong>Real-world example</strong>: An e-commerce platform starts with 2 EC2 instances. During sales events, Auto Scaling launches up to 20 instances. RDS handles thousands of concurrent transactions while ElastiCache reduces database load by caching product catalogs.</p>

<h3 id="pattern-3-serverless-microservices-advanced">Pattern 3: Serverless Microservices (Advanced)</h3>

<p>Embrace modern cloud-native development. No servers to manage, automatic scaling, and pay-per-request pricing.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>API Gateway</strong>: RESTful API endpoint management</li>
  <li>
<strong>Lambda</strong>: Individual functions for each microservice</li>
  <li>
<strong>DynamoDB</strong>: NoSQL database with single-digit millisecond performance</li>
  <li>
<strong>Step Functions</strong>: Orchestrate complex workflows</li>
  <li>
<strong>EventBridge</strong>: Decouple services with event-driven architecture</li>
</ul>

<p><strong>Why this architecture?</strong> Each microservice scales independently, deploys separately, and costs nothing when idle. Perfect for variable workloads and rapid development.</p>

<p><strong>Real-world example</strong>: A food delivery app uses Lambda functions for order processing, restaurant notifications, and driver assignments. DynamoDB stores order data with automatic scaling. Step Functions coordinate the entire delivery workflow. During lunch rush, the system handles 10,000 orders per minute without any manual scaling.</p>

<h3 id="pattern-4-data-analytics-pipeline-advanced">Pattern 4: Data Analytics Pipeline (Advanced)</h3>

<p>Process massive amounts of data in real-time and batch modes. This pattern introduces big data concepts and tools.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>Kinesis Data Streams</strong>: Ingest real-time data from thousands of sources</li>
  <li>
<strong>Kinesis Data Firehose</strong>: Load streaming data into data stores</li>
  <li>
<strong>S3 Data Lake</strong>: Central repository for all your data</li>
  <li>
<strong>AWS Glue</strong>: ETL service for data preparation</li>
  <li>
<strong>Athena</strong>: Query data directly in S3 using SQL</li>
  <li>
<strong>QuickSight</strong>: Create dashboards and visualizations</li>
</ul>

<p><strong>Why this architecture?</strong> It separates data ingestion, storage, processing, and analysis into specialized services. Each component scales independently and you only pay for what you process.</p>

<p><strong>Real-world example</strong>: An IoT company collects sensor data from millions of devices. Kinesis ingests 1TB per hour, Glue transforms it for analysis, and data scientists query historical data with Athena. Business users create real-time dashboards in QuickSight showing device health and usage patterns.</p>

<h3 id="pattern-5-container-based-microservices-expert">Pattern 5: Container-Based Microservices (Expert)</h3>

<p>For teams needing more control than serverless offers. Containers provide consistency across development and production.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>ECS or EKS</strong>: Container orchestration (ECS for simplicity, EKS for Kubernetes)</li>
  <li>
<strong>Fargate</strong>: Serverless compute for containers</li>
  <li>
<strong>ECR</strong>: Container registry for your Docker images</li>
  <li>
<strong>App Mesh</strong>: Service mesh for microservice communication</li>
  <li>
<strong>CloudMap</strong>: Service discovery for dynamic environments</li>
</ul>

<p><strong>Why this architecture?</strong> Containers offer portability, consistency, and fine-grained resource control. Service mesh provides advanced traffic management and observability.</p>

<p><strong>Real-world example</strong>: A fintech platform runs 50+ microservices in EKS. Each team owns their services, deploying independently. App Mesh handles service-to-service authentication and implements canary deployments. During market hours, critical services auto-scale based on trading volume.</p>

<h3 id="pattern-6-multi-region-global-application-expert">Pattern 6: Multi-Region Global Application (Expert)</h3>

<p>For applications requiring global presence, low latency, and extreme availability.</p>

<p><strong>Components:</strong></p>
<ul>
  <li>
<strong>Route 53</strong>: Geolocation and latency-based routing</li>
  <li>
<strong>CloudFront</strong>: Global content delivery</li>
  <li>
<strong>DynamoDB Global Tables</strong>: Multi-region replication</li>
  <li>
<strong>Aurora Global Database</strong>: Cross-region read replicas</li>
  <li>
<strong>AWS Global Accelerator</strong>: Improve global application availability</li>
</ul>

<p><strong>Why this architecture?</strong> Users get low latency regardless of location. The application survives entire region failures. Data replicates globally in seconds.</p>

<p><strong>Real-world example</strong>: A social media platform serves users across continents. Route 53 directs users to the nearest region. DynamoDB Global Tables replicate user posts worldwide in under a second. If the US-East region fails, traffic automatically routes to US-West with minimal disruption.</p>

<h2 id="real-world-aws-case-studies-learning-from-production">Real-World AWS Case Studies: Learning from Production</h2>

<p>These detailed case studies show how real companies solved complex problems with AWS. Each includes architecture decisions, challenges faced, and lessons learned.</p>

<h3 id="case-study-1-netflix---streaming-at-planetary-scale">Case Study 1: Netflix - Streaming at Planetary Scale</h3>

<p><strong>The Challenge</strong>: Stream video to 200+ million subscribers worldwide with perfect reliability and quality.</p>

<p><strong>Architecture Overview</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Users → Route 53 → CloudFront (CDN) → Application Load Balancers
                                     ↓
                        EC2 Auto Scaling Groups (Microservices)
                                     ↓
                        DynamoDB (User Data) + S3 (Video Files)
                                     ↓
                        Kinesis (Real-time Analytics) → EMR (Big Data)
</code></pre></div></div>

<p><strong>Key AWS Services</strong>:</p>
<ul>
  <li>
<strong>EC2</strong>: Thousands of instances running microservices</li>
  <li>
<strong>S3</strong>: Stores the entire video catalog (petabytes)</li>
  <li>
<strong>DynamoDB</strong>: Handles billions of reads/writes for user data</li>
  <li>
<strong>CloudFront</strong>: Delivers video content globally</li>
  <li>
<strong>Kinesis</strong>: Processes billions of events for recommendations</li>
</ul>

<p><strong>Technical Decisions</strong>:</p>

<ol>
  <li>
<strong>Chaos Engineering with Chaos Monkey</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Randomly terminate instances to test resilience
</span><span class="k">def</span> <span class="nf">chaos_monkey</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>  <span class="c1"># 10% chance
</span>        <span class="n">instance</span> <span class="o">=</span> <span class="nf">select_random_instance</span><span class="p">()</span>
        <span class="nf">terminate_instance</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
        <span class="nf">log_termination</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Multi-Region Active-Active</strong>
    <ul>
      <li>Every region can serve any user</li>
      <li>Data replicates globally in seconds</li>
      <li>Automatic failover between regions</li>
    </ul>
  </li>
  <li>
<strong>Microservices Architecture</strong>
    <ul>
      <li>700+ microservices</li>
      <li>Each team owns their service completely</li>
      <li>Deploy hundreds of times per day</li>
    </ul>
  </li>
</ol>

<p><strong>Challenges and Solutions</strong>:</p>

<p><strong>Challenge</strong>: Thundering herd when popular shows release
<strong>Solution</strong>: Pre-scaling based on ML predictions</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">predict_and_scale</span><span class="p">(</span><span class="n">show_id</span><span class="p">):</span>
    <span class="n">predicted_viewers</span> <span class="o">=</span> <span class="n">ml_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">show_id</span><span class="p">)</span>
    <span class="n">required_capacity</span> <span class="o">=</span> <span class="nf">calculate_capacity</span><span class="p">(</span><span class="n">predicted_viewers</span><span class="p">)</span>
    
    <span class="c1"># Pre-scale 30 minutes before release
</span>    <span class="nf">schedule_scaling</span><span class="p">(</span>
        <span class="n">time</span><span class="o">=</span><span class="n">release_time</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">capacity</span><span class="o">=</span><span class="n">required_capacity</span>
    <span class="p">)</span>
</code></pre></div></div>

<p><strong>Challenge</strong>: Cost optimization at scale
<strong>Solution</strong>: Reserved Instances + Spot for batch processing</p>
<ul>
  <li>75% Reserved Instances for baseline</li>
  <li>20% On-Demand for peaks</li>
  <li>5% Spot for analytics workloads</li>
</ul>

<p><strong>Lessons Learned</strong>:</p>
<ol>
  <li>Design for failure - everything will fail eventually</li>
  <li>Automate everything - manual processes don’t scale</li>
  <li>Data-driven decisions - measure everything</li>
  <li>Small teams with full ownership work best</li>
</ol>

<h3 id="case-study-2-airbnb---global-marketplace-platform">Case Study 2: Airbnb - Global Marketplace Platform</h3>

<p><strong>The Challenge</strong>: Match millions of guests with hosts worldwide, handling payments, messaging, and trust.</p>

<p><strong>Architecture Evolution</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2008: Monolithic Ruby on Rails → Single MySQL database
2012: Added caching layer → Memcached
2015: Service-oriented architecture → Multiple databases
2020: Kubernetes on AWS → Microservices
</code></pre></div></div>

<p><strong>Current Architecture</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mobile/Web → API Gateway → ALB → EKS (Kubernetes)
                                    ↓
            Service Mesh (Envoy) → Microservices
                                    ↓
    RDS (Transactions) + DynamoDB (Sessions) + S3 (Images)
                                    ↓
            Kinesis → Data Lake (S3) → Athena/Spark
</code></pre></div></div>

<p><strong>Key Technical Innovations</strong>:</p>

<ol>
  <li>
<strong>Smart Pricing Algorithm</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Lambda function for dynamic pricing
</span><span class="k">def</span> <span class="nf">calculate_optimal_price</span><span class="p">(</span><span class="n">listing_id</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
    <span class="n">factors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">seasonality</span><span class="sh">'</span><span class="p">:</span> <span class="nf">get_seasonal_demand</span><span class="p">(</span><span class="n">date</span><span class="p">),</span>
        <span class="sh">'</span><span class="s">local_events</span><span class="sh">'</span><span class="p">:</span> <span class="nf">check_events_api</span><span class="p">(</span><span class="n">listing</span><span class="p">.</span><span class="n">location</span><span class="p">,</span> <span class="n">date</span><span class="p">),</span>
        <span class="sh">'</span><span class="s">competitor_prices</span><span class="sh">'</span><span class="p">:</span> <span class="nf">analyze_nearby_listings</span><span class="p">(</span><span class="n">listing_id</span><span class="p">),</span>
        <span class="sh">'</span><span class="s">historical_booking</span><span class="sh">'</span><span class="p">:</span> <span class="nf">get_booking_patterns</span><span class="p">(</span><span class="n">listing_id</span><span class="p">)</span>
    <span class="p">}</span>
       
    <span class="n">base_price</span> <span class="o">=</span> <span class="n">listing</span><span class="p">.</span><span class="n">base_price</span>
    <span class="n">optimal_price</span> <span class="o">=</span> <span class="n">ml_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">base_price</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
       
    <span class="k">return</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">price</span><span class="sh">'</span><span class="p">:</span> <span class="n">optimal_price</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">confidence</span><span class="sh">'</span><span class="p">:</span> <span class="n">ml_model</span><span class="p">.</span><span class="n">confidence</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">factors</span><span class="sh">'</span><span class="p">:</span> <span class="n">factors</span>
    <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Fraud Detection System</strong>
    <ul>
      <li>Real-time analysis with Kinesis Analytics</li>
      <li>Graph database for relationship mapping</li>
      <li>ML models retrained daily on EMR</li>
    </ul>
  </li>
  <li>
<strong>Image Processing Pipeline</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Step Functions workflow for image processing
</span><span class="p">{</span>
    <span class="sh">"</span><span class="s">ProcessListingImages</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Parallel</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Branches</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="sh">"</span><span class="s">StartAt</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">GenerateThumbnails</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">States</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">GenerateThumbnails</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Task</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">Resource</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">arn:aws:lambda:function:resize-images</span><span class="sh">"</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="sh">"</span><span class="s">StartAt</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">DetectInappropriateContent</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">States</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">DetectInappropriateContent</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Task</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">Resource</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">arn:aws:lambda:function:content-moderation</span><span class="sh">"</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="sh">"</span><span class="s">StartAt</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ExtractMetadata</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">States</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">ExtractMetadata</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Task</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">Resource</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">arn:aws:lambda:function:image-analysis</span><span class="sh">"</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<p><strong>Scaling Challenges</strong>:</p>

<ol>
  <li>
<strong>Search Performance</strong>
    <ul>
      <li>Solution: ElasticSearch with custom ranking</li>
      <li>Geographical sharding for faster queries</li>
      <li>Cache warming for popular destinations</li>
    </ul>
  </li>
  <li>
<strong>Payment Processing</strong>
    <ul>
      <li>Challenge: Handle payments in 190+ countries</li>
      <li>Solution: Step Functions for complex workflows</li>
      <li>SQS for reliable payment retry logic</li>
    </ul>
  </li>
</ol>

<p><strong>Key Metrics</strong>:</p>
<ul>
  <li>4 million listings worldwide</li>
  <li>1 billion+ searches per day</li>
  <li>99.99% uptime SLA</li>
</ul>

<h3 id="case-study-3-slack---real-time-messaging-at-scale">Case Study 3: Slack - Real-Time Messaging at Scale</h3>

<p><strong>The Challenge</strong>: Deliver messages instantly to millions of concurrent users with perfect reliability.</p>

<p><strong>Architecture Highlights</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WebSocket Connections → ELB → EC2 Fleet (Connection Servers)
                                        ↓
                    Message Queue (Kafka on EC2) 
                                        ↓
        Worker Fleet (Process messages, send notifications)
                                        ↓
            DynamoDB (Message history) + S3 (File uploads)
</code></pre></div></div>

<p><strong>Real-Time Architecture</strong>:</p>

<ol>
  <li>
<strong>WebSocket Management</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ConnectionManager</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connections</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># In Redis
</span>           
    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_connection</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">websocket</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="c1"># Register connection
</span>        <span class="n">connection_id</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="nf">uuid4</span><span class="p">())</span>
        <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">register</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">connection_id</span><span class="p">,</span> <span class="n">websocket</span><span class="p">)</span>
           
        <span class="c1"># Handle messages
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">websocket</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">route_message</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">unregister</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">connection_id</span><span class="p">)</span>
       
    <span class="k">async</span> <span class="k">def</span> <span class="nf">broadcast_to_channel</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">channel_id</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># Get all users in channel
</span>        <span class="n">users</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_channel_users</span><span class="p">(</span><span class="n">channel_id</span><span class="p">)</span>
           
        <span class="c1"># Send to all connected clients
</span>        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
            <span class="n">connections</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_user_connections</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">connections</span><span class="p">:</span>
                <span class="n">tasks</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
           
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Message Delivery Guarantees</strong>
    <ul>
      <li>At-least-once delivery with idempotency</li>
      <li>Message ordering per channel</li>
      <li>Offline queue for disconnected users</li>
    </ul>
  </li>
  <li>
<strong>Search Infrastructure</strong>
    <ul>
      <li>Every message indexed in near real-time</li>
      <li>Elasticsearch cluster per workspace</li>
      <li>Query optimization for emoji and reactions</li>
    </ul>
  </li>
</ol>

<p><strong>Scaling Milestones</strong>:</p>

<table>
  <thead>
    <tr>
      <th>Year</th>
      <th>Daily Active Users</th>
      <th>Messages/Day</th>
      <th>Architecture Change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014</td>
      <td>100K</td>
      <td>10M</td>
      <td>Single database</td>
    </tr>
    <tr>
      <td>2016</td>
      <td>4M</td>
      <td>100M</td>
      <td>Sharded MySQL</td>
    </tr>
    <tr>
      <td>2018</td>
      <td>8M</td>
      <td>1B</td>
      <td>DynamoDB migration</td>
    </tr>
    <tr>
      <td>2020</td>
      <td>12M</td>
      <td>5B</td>
      <td>Multi-region active</td>
    </tr>
  </tbody>
</table>

<p><strong>Performance Optimizations</strong>:</p>

<ol>
  <li>
<strong>Connection Pooling</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Efficient database connection management
</span><span class="k">class</span> <span class="nc">ShardedConnectionPool</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">shard_map</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pools</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">shard_id</span><span class="p">:</span> <span class="nc">ConnectionPool</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">shard_id</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">shard_map</span><span class="p">.</span><span class="nf">items</span><span class="p">()</span>
        <span class="p">}</span>
       
    <span class="k">def</span> <span class="nf">get_connection</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">workspace_id</span><span class="p">):</span>
        <span class="n">shard_id</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_shard</span><span class="p">(</span><span class="n">workspace_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">pools</span><span class="p">[</span><span class="n">shard_id</span><span class="p">].</span><span class="nf">get_connection</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Caching Strategy</strong>
    <ul>
      <li>User presence in Redis (15-second TTL)</li>
      <li>Channel membership in ElastiCache</li>
      <li>Recent messages in memory</li>
    </ul>
  </li>
</ol>

<p><strong>Lessons for Real-Time Apps</strong>:</p>
<ol>
  <li>Design for connection drops - mobile networks are unreliable</li>
  <li>Batch operations where possible</li>
  <li>Use backpressure to prevent overload</li>
  <li>Monitor everything - latency matters</li>
</ol>

<h3 id="case-study-4-robinhood---financial-services-platform">Case Study 4: Robinhood - Financial Services Platform</h3>

<p><strong>The Challenge</strong>: Process millions of stock trades with zero downtime and SEC compliance.</p>

<p><strong>Regulatory Requirements</strong>:</p>
<ul>
  <li>Every transaction must be logged</li>
  <li>Data retention for 7 years</li>
  <li>Disaster recovery with &lt; 1-hour RPO</li>
  <li>Encryption at rest and in transit</li>
</ul>

<p><strong>Architecture</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mobile Apps → API Gateway → WAF → ALB
                                   ↓
            ECS Fargate (Microservices)
                                   ↓
    Aurora (Transactions) + DynamoDB (Market Data)
                                   ↓
        Kinesis Data Firehose → S3 (Compliance Archive)
                                   ↓
                    Redshift (Analytics)
</code></pre></div></div>

<p><strong>Critical Components</strong>:</p>

<ol>
  <li>
<strong>Order Execution Engine</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">OrderExecutor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">market_connection</span> <span class="o">=</span> <span class="nc">MarketConnection</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">risk_checker</span> <span class="o">=</span> <span class="nc">RiskChecker</span><span class="p">()</span>
           
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_order</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="c1"># Pre-trade compliance checks
</span>        <span class="n">compliance_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_compliance</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">compliance_result</span><span class="p">.</span><span class="n">passed</span><span class="p">:</span>
            <span class="k">return</span> <span class="nc">OrderResult</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="sh">'</span><span class="s">rejected</span><span class="sh">'</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="n">compliance_result</span><span class="p">.</span><span class="n">reason</span><span class="p">)</span>
           
        <span class="c1"># Risk checks
</span>        <span class="n">risk_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">risk_checker</span><span class="p">.</span><span class="nf">check</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">risk_result</span><span class="p">.</span><span class="n">score</span> <span class="o">&gt;</span> <span class="n">RISK_THRESHOLD</span><span class="p">:</span>
            <span class="k">return</span> <span class="nc">OrderResult</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="sh">'</span><span class="s">rejected</span><span class="sh">'</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="sh">'</span><span class="s">risk_limit</span><span class="sh">'</span><span class="p">)</span>
           
        <span class="c1"># Execute with retry logic
</span>        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">market_connection</span><span class="p">.</span><span class="nf">submit</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">log_execution</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">except</span> <span class="n">MarketUnavailable</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
           
        <span class="k">return</span> <span class="nc">OrderResult</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="sh">'</span><span class="s">failed</span><span class="sh">'</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="sh">'</span><span class="s">market_unavailable</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Real-Time Market Data Pipeline</strong>
    <ul>
      <li>100,000+ price updates per second</li>
      <li>Sub-millisecond latency requirements</li>
      <li>DynamoDB with DAX for caching</li>
    </ul>
  </li>
  <li>
<strong>Compliance and Audit System</strong>
    <ul>
      <li>Every API call logged to Kinesis</li>
      <li>Immutable audit trail in S3</li>
      <li>Daily reports generated with Athena</li>
    </ul>
  </li>
</ol>

<p><strong>Scaling for Market Events</strong>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Auto-scaling based on market volatility
</span><span class="k">def</span> <span class="nf">calculate_required_capacity</span><span class="p">():</span>
    <span class="n">volatility</span> <span class="o">=</span> <span class="nf">get_market_volatility</span><span class="p">()</span>
    <span class="n">normal_capacity</span> <span class="o">=</span> <span class="mi">100</span>
    
    <span class="k">if</span> <span class="n">volatility</span> <span class="o">&gt;</span> <span class="n">HIGH_VOLATILITY_THRESHOLD</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">normal_capacity</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># 5x during high volatility
</span>    <span class="k">elif</span> <span class="n">volatility</span> <span class="o">&gt;</span> <span class="n">MEDIUM_VOLATILITY_THRESHOLD</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">normal_capacity</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">normal_capacity</span>

<span class="c1"># Pre-scale before market open
</span><span class="n">schedule</span><span class="p">.</span><span class="nf">every</span><span class="p">().</span><span class="n">day</span><span class="p">.</span><span class="nf">at</span><span class="p">(</span><span class="sh">"</span><span class="s">09:00</span><span class="sh">"</span><span class="p">).</span><span class="nf">do</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="nf">scale_to_capacity</span><span class="p">(</span><span class="nf">calculate_required_capacity</span><span class="p">())</span>
<span class="p">)</span>
</code></pre></div></div>

<p><strong>Security Architecture</strong>:</p>
<ul>
  <li>All data encrypted with KMS</li>
  <li>Network isolation with PrivateLink</li>
  <li>API Gateway with rate limiting</li>
  <li>WAF rules for common attacks</li>
</ul>

<h3 id="case-study-5-pinterest---visual-discovery-engine">Case Study 5: Pinterest - Visual Discovery Engine</h3>

<p><strong>The Challenge</strong>: Serve billions of images with personalized recommendations to 400+ million users.</p>

<p><strong>Data Scale</strong>:</p>
<ul>
  <li>300+ billion Pins</li>
  <li>5 billion boards</li>
  <li>600 million searches per month</li>
  <li>2 billion recommendations per day</li>
</ul>

<p><strong>Architecture</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CDN (CloudFront) → Image Servers (EC2 + S3)
        ↓
API Gateway → Service Mesh → Microservices (EKS)
        ↓
Graph Database (Neptune) + Feature Store (DynamoDB)
        ↓
ML Pipeline (SageMaker) → Recommendation Service
</code></pre></div></div>

<p><strong>Key Innovations</strong>:</p>

<ol>
  <li>
<strong>Visual Search System</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">VisualSearchEngine</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">feature_extractor</span> <span class="o">=</span> <span class="nf">load_model</span><span class="p">(</span><span class="sh">'</span><span class="s">resnet50</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="nc">FaissIndex</span><span class="p">()</span>  <span class="c1"># Billion-scale similarity search
</span>           
    <span class="k">def</span> <span class="nf">process_image</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">image_url</span><span class="p">):</span>
        <span class="c1"># Extract visual features
</span>        <span class="n">image</span> <span class="o">=</span> <span class="nf">download_image</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">feature_extractor</span><span class="p">.</span><span class="nf">extract</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
           
        <span class="c1"># Store in feature database
</span>        <span class="n">image_id</span> <span class="o">=</span> <span class="nf">generate_id</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">store_features</span><span class="p">(</span><span class="n">image_id</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
           
        <span class="c1"># Find similar images
</span>        <span class="n">similar</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">rank_results</span><span class="p">(</span><span class="n">similar</span><span class="p">)</span>
       
    <span class="k">def</span> <span class="nf">build_index_shard</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">shard_id</span><span class="p">):</span>
        <span class="c1"># Build index for billions of images
</span>        <span class="n">features</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">load_features_for_shard</span><span class="p">(</span><span class="n">shard_id</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nc">FaissIndex</span><span class="p">()</span>
           
        <span class="c1"># Add in batches for efficiency
</span>        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
            <span class="n">index</span><span class="p">.</span><span class="nf">add_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
           
        <span class="c1"># Save to S3
</span>        <span class="n">index</span><span class="p">.</span><span class="nf">save_to_s3</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">index/shard_</span><span class="si">{</span><span class="n">shard_id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Personalization Pipeline</strong>
    <ul>
      <li>User signals processed in real-time</li>
      <li>Graph neural networks for recommendations</li>
      <li>A/B testing framework for algorithms</li>
    </ul>
  </li>
  <li>
<strong>Content Moderation</strong>
    <ul>
      <li>ML models detect inappropriate content</li>
      <li>Human review queue with SQS</li>
      <li>Feedback loop to improve models</li>
    </ul>
  </li>
</ol>

<p><strong>Performance Optimizations</strong>:</p>
<ul>
  <li>Image serving through CloudFront</li>
  <li>Aggressive caching at every layer</li>
  <li>Progressive image loading</li>
  <li>WebP format for modern browsers</li>
</ul>

<p><strong>Lessons Learned</strong>:</p>
<ol>
  <li>
<strong>Cache Everything</strong>: 99% cache hit rate saves millions</li>
  <li>
<strong>Precompute When Possible</strong>: Recommendations generated offline</li>
  <li>
<strong>Shard by User</strong>: Better cache locality</li>
  <li>
<strong>Monitor User Experience</strong>: Not just system metrics</li>
</ol>

<h3 id="key-takeaways-from-all-case-studies">Key Takeaways from All Case Studies</h3>

<ol>
  <li>
<strong>Start Simple, Evolve Gradually</strong>
    <ul>
      <li>Every company started with basic architecture</li>
      <li>Complexity added only when needed</li>
      <li>Technical debt managed actively</li>
    </ul>
  </li>
  <li>
<strong>Data is Everything</strong>
    <ul>
      <li>Instrument everything from day one</li>
      <li>Use data to drive decisions</li>
      <li>Build data pipelines early</li>
    </ul>
  </li>
  <li>
<strong>Failure is Normal</strong>
    <ul>
      <li>Design for failure at every level</li>
      <li>Practice failure scenarios</li>
      <li>Automate recovery procedures</li>
    </ul>
  </li>
  <li>
<strong>Scale Horizontally</strong>
    <ul>
      <li>Vertical scaling hits limits quickly</li>
      <li>Design for distributed systems</li>
      <li>Embrace eventual consistency</li>
    </ul>
  </li>
  <li>
<strong>Security Cannot Be an Afterthought</strong>
    <ul>
      <li>Build security into architecture</li>
      <li>Automate security scanning</li>
      <li>Regular security audits</li>
    </ul>
  </li>
</ol>

<p>These case studies demonstrate that successful AWS architectures share common patterns: they start simple, measure everything, automate aggressively, and evolve based on real needs rather than predicted ones.</p>

<h2 id="cost-optimization-spending-smart-in-the-cloud">Cost Optimization: Spending Smart in the Cloud</h2>

<p>The cloud’s pay-as-you-go model is powerful, but without proper management, costs can spiral. The key is understanding how pricing works and implementing automated controls from the start.</p>

<h3 id="the-cost-evolution-pattern">The Cost Evolution Pattern</h3>

<p>Most teams follow this cost optimization journey:</p>

<ol>
  <li>
<strong>Shock Phase</strong>: First AWS bill surprises everyone</li>
  <li>
<strong>Panic Cuts</strong>: Turning off resources randomly</li>
  <li>
<strong>Understanding</strong>: Learning what actually drives costs</li>
  <li>
<strong>Optimization</strong>: Right-sizing and automated management</li>
  <li>
<strong>Mastery</strong>: Costs become predictable and optimized</li>
</ol>

<h3 id="understanding-your-bill">Understanding Your Bill</h3>

<p>AWS costs break down into three main categories:</p>

<h4 id="compute-costs">Compute Costs</h4>
<ul>
  <li>
<strong>On-Demand</strong>: Like hotel rooms - flexible but expensive</li>
  <li>
<strong>Reserved Instances</strong>: Like apartment leases - cheaper with commitment</li>
  <li>
<strong>Spot Instances</strong>: Like last-minute deals - up to 90% off but can be interrupted</li>
  <li>
<strong>Savings Plans</strong>: Flexible commitment across instance types</li>
</ul>

<p><strong>Real example</strong>: A startup’s API servers cost $5,000/month on-demand. After analyzing usage patterns, they buy Reserved Instances for baseline capacity and use Spot for batch processing, reducing costs to $2,000/month.</p>

<h4 id="storage-costs">Storage Costs</h4>
<ul>
  <li>
<strong>S3 Storage Classes</strong>: Match storage to access patterns
    <ul>
      <li>Standard: Frequently accessed data</li>
      <li>Infrequent Access: 50% cheaper for archived data</li>
      <li>Glacier: 90% cheaper for long-term archives</li>
    </ul>
  </li>
  <li>
<strong>Lifecycle Policies</strong>: Automatically move data to cheaper storage</li>
</ul>

<p><strong>Real example</strong>: A photo sharing app automatically moves photos older than 30 days to Infrequent Access, and after 1 year to Glacier. Storage costs drop 70% with no user impact.</p>

<h4 id="data-transfer-costs">Data Transfer Costs</h4>
<ul>
  <li>
<strong>Within Region</strong>: Free between services</li>
  <li>
<strong>Cross-Region</strong>: Charged per GB</li>
  <li>
<strong>Internet Egress</strong>: Most expensive</li>
</ul>

<h3 id="advanced-cost-management-tools">Advanced Cost Management Tools</h3>

<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># cost-optimization.tf - Cost management and optimization</span>

<span class="c1"># Cost anomaly detection</span>
<span class="nx">resource</span> <span class="s2">"aws_ce_anomaly_monitor"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">name</span>              <span class="o">=</span> <span class="s2">"${var.environment}-cost-anomaly-monitor"</span>
  <span class="nx">monitor_type</span>      <span class="o">=</span> <span class="s2">"DIMENSIONAL"</span>
  <span class="nx">monitor_dimension</span> <span class="o">=</span> <span class="s2">"SERVICE"</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_ce_anomaly_subscription"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">name</span>      <span class="o">=</span> <span class="s2">"${var.environment}-cost-anomaly-subscription"</span>
  <span class="nx">threshold</span> <span class="o">=</span> <span class="mf">100.0</span>  <span class="c1"># USD</span>
  <span class="nx">frequency</span> <span class="o">=</span> <span class="s2">"DAILY"</span>
  
  <span class="nx">monitor_arn_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">aws_ce_anomaly_monitor</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">arn</span>
  <span class="p">]</span>
  
  <span class="nx">subscriber</span> <span class="p">{</span>
    <span class="nx">type</span>    <span class="o">=</span> <span class="s2">"EMAIL"</span>
    <span class="nx">address</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">cost_alert_email</span>
  <span class="p">}</span>
  
  <span class="nx">subscriber</span> <span class="p">{</span>
    <span class="nx">type</span>    <span class="o">=</span> <span class="s2">"SNS"</span>
    <span class="nx">address</span> <span class="o">=</span> <span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_alerts</span><span class="p">.</span><span class="nx">arn</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Budget alerts</span>
<span class="nx">resource</span> <span class="s2">"aws_budgets_budget"</span> <span class="s2">"monthly"</span> <span class="p">{</span>
  <span class="nx">name</span>              <span class="o">=</span> <span class="s2">"${var.environment}-monthly-budget"</span>
  <span class="nx">budget_type</span>       <span class="o">=</span> <span class="s2">"COST"</span>
  <span class="nx">limit_amount</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">monthly_budget_limit</span>
  <span class="nx">limit_unit</span>        <span class="o">=</span> <span class="s2">"USD"</span>
  <span class="nx">time_unit</span>         <span class="o">=</span> <span class="s2">"MONTHLY"</span>
  <span class="nx">time_period_start</span> <span class="o">=</span> <span class="s2">"2024-01-01_00:00"</span>
  
  <span class="nx">cost_types</span> <span class="p">{</span>
    <span class="nx">include_credit</span>             <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">include_discount</span>           <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_other_subscription</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_recurring</span>          <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_refund</span>             <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">include_subscription</span>       <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_support</span>            <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_tax</span>                <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_upfront</span>            <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">use_blended</span>                <span class="o">=</span> <span class="kc">false</span>
  <span class="err">}</span>
  
  <span class="nx">notification</span> <span class="p">{</span>
    <span class="nx">comparison_operator</span>        <span class="o">=</span> <span class="s2">"GREATER_THAN"</span>
    <span class="nx">threshold</span>                  <span class="o">=</span> <span class="mi">80</span>
    <span class="nx">threshold_type</span>             <span class="o">=</span> <span class="s2">"PERCENTAGE"</span>
    <span class="nx">notification_type</span>          <span class="o">=</span> <span class="s2">"FORECASTED"</span>
    <span class="nx">subscriber_email_addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">var</span><span class="p">.</span><span class="nx">cost_alert_email</span><span class="p">]</span>
    <span class="nx">subscriber_sns_topic_arns</span>  <span class="o">=</span> <span class="p">[</span><span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_alerts</span><span class="p">.</span><span class="nx">arn</span><span class="p">]</span>
  <span class="p">}</span>
  
  <span class="nx">notification</span> <span class="p">{</span>
    <span class="nx">comparison_operator</span>        <span class="o">=</span> <span class="s2">"GREATER_THAN"</span>
    <span class="nx">threshold</span>                  <span class="o">=</span> <span class="mi">100</span>
    <span class="nx">threshold_type</span>             <span class="o">=</span> <span class="s2">"PERCENTAGE"</span>
    <span class="nx">notification_type</span>          <span class="o">=</span> <span class="s2">"ACTUAL"</span>
    <span class="nx">subscriber_email_addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">var</span><span class="p">.</span><span class="nx">cost_alert_email</span><span class="p">]</span>
    <span class="nx">subscriber_sns_topic_arns</span>  <span class="o">=</span> <span class="p">[</span><span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_alerts</span><span class="p">.</span><span class="nx">arn</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Service-specific budgets</span>
<span class="nx">resource</span> <span class="s2">"aws_budgets_budget"</span> <span class="s2">"service_budgets"</span> <span class="p">{</span>
  <span class="nx">for_each</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">service_budgets</span>
  
  <span class="nx">name</span>              <span class="o">=</span> <span class="s2">"${var.environment}-${each.key}-budget"</span>
  <span class="nx">budget_type</span>       <span class="o">=</span> <span class="s2">"COST"</span>
  <span class="nx">limit_amount</span>      <span class="o">=</span> <span class="nx">each</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">limit</span>
  <span class="nx">limit_unit</span>        <span class="o">=</span> <span class="s2">"USD"</span>
  <span class="nx">time_unit</span>         <span class="o">=</span> <span class="s2">"MONTHLY"</span>
  <span class="nx">time_period_start</span> <span class="o">=</span> <span class="s2">"2024-01-01_00:00"</span>
  
  <span class="nx">cost_filter</span> <span class="p">{</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="s2">"Service"</span>
    <span class="nx">values</span> <span class="o">=</span> <span class="p">[</span><span class="nx">each</span><span class="p">.</span><span class="nx">key</span><span class="p">]</span>
  <span class="p">}</span>
  
  <span class="nx">cost_types</span> <span class="p">{</span>
    <span class="nx">include_credit</span>             <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">include_discount</span>           <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_other_subscription</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_recurring</span>          <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_refund</span>             <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">include_subscription</span>       <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_support</span>            <span class="o">=</span> <span class="kc">false</span>
    <span class="nx">include_tax</span>                <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">include_upfront</span>            <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">use_blended</span>                <span class="o">=</span> <span class="kc">false</span>
  <span class="err">}</span>
  
  <span class="nx">notification</span> <span class="p">{</span>
    <span class="nx">comparison_operator</span>        <span class="o">=</span> <span class="s2">"GREATER_THAN"</span>
    <span class="nx">threshold</span>                  <span class="o">=</span> <span class="mi">90</span>
    <span class="nx">threshold_type</span>             <span class="o">=</span> <span class="s2">"PERCENTAGE"</span>
    <span class="nx">notification_type</span>          <span class="o">=</span> <span class="s2">"ACTUAL"</span>
    <span class="nx">subscriber_email_addresses</span> <span class="o">=</span> <span class="p">[</span><span class="nx">var</span><span class="p">.</span><span class="nx">cost_alert_email</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Compute Optimizer enrollment</span>
<span class="nx">resource</span> <span class="s2">"aws_organizations_policy"</span> <span class="s2">"compute_optimizer"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="o">=</span> <span class="s2">"ComputeOptimizerEnrollment"</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enable Compute Optimizer for all accounts"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="s2">"SERVICE_CONTROL_POLICY"</span>
  
  <span class="nx">content</span> <span class="o">=</span> <span class="nx">jsonencode</span><span class="p">({</span>
    <span class="nx">Version</span> <span class="o">=</span> <span class="s2">"2012-10-17"</span>
    <span class="nx">Statement</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">Effect</span> <span class="o">=</span> <span class="s2">"Allow"</span>
        <span class="nx">Action</span> <span class="o">=</span> <span class="s2">"compute-optimizer:*"</span>
        <span class="nx">Resource</span> <span class="o">=</span> <span class="s2">"*"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># Lambda for cost optimization recommendations</span>
<span class="nx">resource</span> <span class="s2">"aws_lambda_function"</span> <span class="s2">"cost_optimizer"</span> <span class="p">{</span>
  <span class="nx">filename</span>         <span class="o">=</span> <span class="s2">"cost_optimizer.zip"</span>
  <span class="nx">function_name</span>    <span class="o">=</span> <span class="s2">"${var.environment}-cost-optimizer"</span>
  <span class="nx">role</span>            <span class="o">=</span> <span class="nx">aws_iam_role</span><span class="p">.</span><span class="nx">cost_optimizer</span><span class="p">.</span><span class="nx">arn</span>
  <span class="nx">handler</span>         <span class="o">=</span> <span class="s2">"index.handler"</span>
  <span class="nx">runtime</span>         <span class="o">=</span> <span class="s2">"python3.9"</span>
  <span class="nx">timeout</span>         <span class="o">=</span> <span class="mi">900</span>
  <span class="nx">memory_size</span>     <span class="o">=</span> <span class="mi">3008</span>
  
  <span class="nx">environment</span> <span class="p">{</span>
    <span class="nx">variables</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">SNS_TOPIC_ARN</span>    <span class="o">=</span> <span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_recommendations</span><span class="p">.</span><span class="nx">arn</span>
      <span class="nx">S3_BUCKET</span>        <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="p">.</span><span class="nx">cost_reports</span><span class="p">.</span><span class="nx">id</span>
      <span class="nx">ENVIRONMENT</span>      <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">layers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"arn:aws:lambda:${var.aws_region}:336392948345:layer:AWSSDKPandas-Python39:1"</span>
  <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># EventBridge rule for weekly cost analysis</span>
<span class="nx">resource</span> <span class="s2">"aws_cloudwatch_event_rule"</span> <span class="s2">"cost_analysis"</span> <span class="p">{</span>
  <span class="nx">name</span>                <span class="o">=</span> <span class="s2">"${var.environment}-weekly-cost-analysis"</span>
  <span class="nx">description</span>         <span class="o">=</span> <span class="s2">"Trigger weekly cost analysis"</span>
  <span class="nx">schedule_expression</span> <span class="o">=</span> <span class="s2">"cron(0 9 ? * MON *)"</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_cloudwatch_event_target"</span> <span class="s2">"cost_optimizer"</span> <span class="p">{</span>
  <span class="nx">rule</span>      <span class="o">=</span> <span class="nx">aws_cloudwatch_event_rule</span><span class="p">.</span><span class="nx">cost_analysis</span><span class="p">.</span><span class="nx">name</span>
  <span class="nx">target_id</span> <span class="o">=</span> <span class="s2">"CostOptimizer"</span>
  <span class="nx">arn</span>       <span class="o">=</span> <span class="nx">aws_lambda_function</span><span class="p">.</span><span class="nx">cost_optimizer</span><span class="p">.</span><span class="nx">arn</span>
<span class="p">}</span>

<span class="c1"># Cost and Usage Report</span>
<span class="nx">resource</span> <span class="s2">"aws_s3_bucket"</span> <span class="s2">"cost_reports"</span> <span class="p">{</span>
  <span class="nx">bucket</span> <span class="o">=</span> <span class="s2">"${var.environment}-cost-reports-${data.aws_caller_identity.current.account_id}"</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_s3_bucket_policy"</span> <span class="s2">"cost_reports"</span> <span class="p">{</span>
  <span class="nx">bucket</span> <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="p">.</span><span class="nx">cost_reports</span><span class="p">.</span><span class="nx">id</span>
  
  <span class="nx">policy</span> <span class="o">=</span> <span class="nx">jsonencode</span><span class="p">({</span>
    <span class="nx">Version</span> <span class="o">=</span> <span class="s2">"2012-10-17"</span>
    <span class="nx">Statement</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nx">Effect</span> <span class="o">=</span> <span class="s2">"Allow"</span>
        <span class="nx">Principal</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">Service</span> <span class="o">=</span> <span class="s2">"billingreports.amazonaws.com"</span>
        <span class="p">}</span>
        <span class="nx">Action</span> <span class="o">=</span> <span class="p">[</span>
          <span class="s2">"s3:GetBucketAcl"</span><span class="p">,</span>
          <span class="s2">"s3:GetBucketPolicy"</span>
        <span class="p">]</span>
        <span class="nx">Resource</span> <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="p">.</span><span class="nx">cost_reports</span><span class="p">.</span><span class="nx">arn</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nx">Effect</span> <span class="o">=</span> <span class="s2">"Allow"</span>
        <span class="nx">Principal</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">Service</span> <span class="o">=</span> <span class="s2">"billingreports.amazonaws.com"</span>
        <span class="p">}</span>
        <span class="nx">Action</span> <span class="o">=</span> <span class="s2">"s3:PutObject"</span>
        <span class="nx">Resource</span> <span class="o">=</span> <span class="s2">"${aws_s3_bucket.cost_reports.arn}/*"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_cur_report_definition"</span> <span class="s2">"main"</span> <span class="p">{</span>
  <span class="nx">report_name</span>                <span class="o">=</span> <span class="s2">"${var.environment}-cost-usage-report"</span>
  <span class="nx">time_unit</span>                  <span class="o">=</span> <span class="s2">"DAILY"</span>
  <span class="nx">format</span>                     <span class="o">=</span> <span class="s2">"Parquet"</span>
  <span class="nx">compression</span>                <span class="o">=</span> <span class="s2">"Parquet"</span>
  <span class="nx">additional_schema_elements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"RESOURCES"</span><span class="p">]</span>
  <span class="nx">s3_bucket</span>                  <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="err">.</span><span class="nx">cost_reports</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">s3_prefix</span>                  <span class="o">=</span> <span class="s2">"cur"</span>
  <span class="nx">s3_region</span>                  <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">aws_region</span>
  <span class="nx">additional_artifacts</span>       <span class="o">=</span> <span class="p">[</span><span class="s2">"QUICKSIGHT"</span><span class="p">]</span>
  <span class="nx">report_versioning</span>          <span class="o">=</span> <span class="s2">"OVERWRITE_REPORT"</span>
<span class="p">}</span>

<span class="c1"># Reserved Instance utilization alerts</span>
<span class="nx">resource</span> <span class="s2">"aws_cloudwatch_metric_alarm"</span> <span class="s2">"ri_utilization"</span> <span class="p">{</span>
  <span class="nx">alarm_name</span>          <span class="o">=</span> <span class="s2">"${var.environment}-low-ri-utilization"</span>
  <span class="nx">comparison_operator</span> <span class="o">=</span> <span class="s2">"LessThanThreshold"</span>
  <span class="nx">evaluation_periods</span>  <span class="o">=</span> <span class="s2">"1"</span>
  <span class="nx">metric_name</span>         <span class="o">=</span> <span class="s2">"ReservedInstanceUtilization"</span>
  <span class="nx">namespace</span>           <span class="o">=</span> <span class="s2">"AWS/CE"</span>
  <span class="nx">period</span>              <span class="o">=</span> <span class="s2">"86400"</span>  <span class="c1"># 24 hours</span>
  <span class="nx">statistic</span>           <span class="o">=</span> <span class="s2">"Average"</span>
  <span class="nx">threshold</span>           <span class="o">=</span> <span class="s2">"75"</span>
  <span class="nx">alarm_description</span>   <span class="o">=</span> <span class="s2">"Reserved Instance utilization below 75%"</span>
  <span class="nx">alarm_actions</span>       <span class="o">=</span> <span class="p">[</span><span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_alerts</span><span class="p">.</span><span class="nx">arn</span><span class="p">]</span>
  
  <span class="nx">dimensions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Currency</span> <span class="o">=</span> <span class="s2">"USD"</span>
  <span class="p">}</span>
<span class="err">}</span>

<span class="c1"># Savings Plans utilization alerts</span>
<span class="nx">resource</span> <span class="s2">"aws_cloudwatch_metric_alarm"</span> <span class="s2">"sp_utilization"</span> <span class="p">{</span>
  <span class="nx">alarm_name</span>          <span class="o">=</span> <span class="s2">"${var.environment}-low-sp-utilization"</span>
  <span class="nx">comparison_operator</span> <span class="o">=</span> <span class="s2">"LessThanThreshold"</span>
  <span class="nx">evaluation_periods</span>  <span class="o">=</span> <span class="s2">"1"</span>
  <span class="nx">metric_name</span>         <span class="o">=</span> <span class="s2">"SavingsPlansUtilization"</span>
  <span class="nx">namespace</span>           <span class="o">=</span> <span class="s2">"AWS/CE"</span>
  <span class="nx">period</span>              <span class="o">=</span> <span class="s2">"86400"</span>
  <span class="nx">statistic</span>           <span class="o">=</span> <span class="s2">"Average"</span>
  <span class="nx">threshold</span>           <span class="o">=</span> <span class="s2">"90"</span>
  <span class="nx">alarm_description</span>   <span class="o">=</span> <span class="s2">"Savings Plans utilization below 90%"</span>
  <span class="nx">alarm_actions</span>       <span class="o">=</span> <span class="p">[</span><span class="nx">aws_sns_topic</span><span class="p">.</span><span class="nx">cost_alerts</span><span class="p">.</span><span class="nx">arn</span><span class="p">]</span>
<span class="err">}</span>

<span class="c1"># Cost allocation tags</span>
<span class="nx">resource</span> <span class="s2">"aws_organizations_policy"</span> <span class="s2">"tagging"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="o">=</span> <span class="s2">"MandatoryTaggingPolicy"</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Enforce cost allocation tags"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="s2">"TAG_POLICY"</span>
  
  <span class="nx">content</span> <span class="o">=</span> <span class="nx">jsonencode</span><span class="p">({</span>
    <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">Environment</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">tag_key</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="s2">"Environment"</span>
        <span class="p">}</span>
        <span class="nx">tag_value</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"Production"</span><span class="p">,</span> <span class="s2">"Staging"</span><span class="p">,</span> <span class="s2">"Development"</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="nx">enforced_for</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"ec2:instance"</span><span class="p">,</span> <span class="s2">"s3:bucket"</span><span class="p">,</span> <span class="s2">"rds:db"</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">CostCenter</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">tag_key</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="s2">"CostCenter"</span>
        <span class="p">}</span>
        <span class="nx">enforced_for</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"ec2:*"</span><span class="p">,</span> <span class="s2">"s3:*"</span><span class="p">,</span> <span class="s2">"rds:*"</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">Project</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">tag_key</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="s2">"Project"</span>
        <span class="p">}</span>
        <span class="nx">enforced_for</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s2">"@@assign"</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"ec2:*"</span><span class="p">,</span> <span class="s2">"s3:*"</span><span class="p">,</span> <span class="s2">"rds:*"</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="c1"># Attach tagging policy to organization</span>
<span class="nx">resource</span> <span class="s2">"aws_organizations_policy_attachment"</span> <span class="s2">"tagging"</span> <span class="p">{</span>
  <span class="nx">policy_id</span> <span class="o">=</span> <span class="nx">aws_organizations_policy</span><span class="p">.</span><span class="nx">tagging</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">target_id</span> <span class="o">=</span> <span class="nx">aws_organizations_organization</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">id</span>
<span class="p">}</span>

<span class="c1"># Instance Scheduler for non-production environments</span>
<span class="nx">module</span> <span class="s2">"instance_scheduler"</span> <span class="p">{</span>
  <span class="nx">source</span>  <span class="o">=</span> <span class="s2">"aws-ia/instance-scheduler/aws"</span>
  <span class="nx">version</span> <span class="o">=</span> <span class="s2">"2.0.0"</span>
  
  <span class="nx">scheduler_frequency</span> <span class="o">=</span> <span class="s2">"5"</span>
  
  <span class="nx">schedules</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nx">name</span>        <span class="o">=</span> <span class="s2">"business-hours"</span>
      <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Run instances during business hours only"</span>
      <span class="nx">timezone</span>    <span class="o">=</span> <span class="s2">"America/New_York"</span>
      
      <span class="nx">periods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nx">name</span>        <span class="o">=</span> <span class="s2">"weekdays"</span>
          <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Monday to Friday"</span>
          <span class="nx">begintime</span>   <span class="o">=</span> <span class="s2">"08:00"</span>
          <span class="nx">endtime</span>     <span class="o">=</span> <span class="s2">"18:00"</span>
          <span class="nx">weekdays</span>    <span class="o">=</span> <span class="s2">"mon-fri"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
  
  <span class="nx">tag_name</span> <span class="o">=</span> <span class="s2">"Schedule"</span>
<span class="p">}</span>

<span class="c1"># Spot Instance configuration</span>
<span class="nx">resource</span> <span class="s2">"aws_launch_template"</span> <span class="s2">"spot"</span> <span class="p">{</span>
  <span class="nx">name_prefix</span> <span class="o">=</span> <span class="s2">"${var.environment}-spot-"</span>
  
  <span class="nx">instance_market_options</span> <span class="p">{</span>
    <span class="nx">market_type</span> <span class="o">=</span> <span class="s2">"spot"</span>
    
    <span class="nx">spot_options</span> <span class="p">{</span>
      <span class="nx">max_price</span>                      <span class="o">=</span> <span class="s2">"0.5"</span>  <span class="c1"># 50% of on-demand price</span>
      <span class="nx">spot_instance_type</span>             <span class="o">=</span> <span class="s2">"persistent"</span>
      <span class="nx">instance_interruption_behavior</span> <span class="o">=</span> <span class="s2">"stop"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">tag_specifications</span> <span class="p">{</span>
    <span class="nx">resource_type</span> <span class="o">=</span> <span class="s2">"instance"</span>
    
    <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">Environment</span> <span class="o">=</span> <span class="nx">var</span><span class="p">.</span><span class="nx">environment</span>
      <span class="nx">InstanceType</span> <span class="o">=</span> <span class="s2">"spot"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># S3 lifecycle policies for cost optimization</span>
<span class="nx">resource</span> <span class="s2">"aws_s3_bucket_lifecycle_configuration"</span> <span class="s2">"logs"</span> <span class="p">{</span>
  <span class="nx">bucket</span> <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="p">.</span><span class="nx">logs</span><span class="p">.</span><span class="nx">id</span>
  
  <span class="nx">rule</span> <span class="p">{</span>
    <span class="nx">id</span>     <span class="o">=</span> <span class="s2">"transition-old-logs"</span>
    <span class="nx">status</span> <span class="o">=</span> <span class="s2">"Enabled"</span>
    
    <span class="nx">transition</span> <span class="p">{</span>
      <span class="nx">days</span>          <span class="o">=</span> <span class="mi">30</span>
      <span class="nx">storage_class</span> <span class="o">=</span> <span class="s2">"STANDARD_IA"</span>
    <span class="p">}</span>
    
    <span class="nx">transition</span> <span class="p">{</span>
      <span class="nx">days</span>          <span class="o">=</span> <span class="mi">90</span>
      <span class="nx">storage_class</span> <span class="o">=</span> <span class="s2">"GLACIER"</span>
    <span class="p">}</span>
    
    <span class="nx">transition</span> <span class="p">{</span>
      <span class="nx">days</span>          <span class="o">=</span> <span class="mi">180</span>
      <span class="nx">storage_class</span> <span class="o">=</span> <span class="s2">"DEEP_ARCHIVE"</span>
    <span class="p">}</span>
    
    <span class="nx">expiration</span> <span class="p">{</span>
      <span class="nx">days</span> <span class="o">=</span> <span class="mi">365</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">rule</span> <span class="p">{</span>
    <span class="nx">id</span>     <span class="o">=</span> <span class="s2">"delete-incomplete-uploads"</span>
    <span class="nx">status</span> <span class="o">=</span> <span class="s2">"Enabled"</span>
    
    <span class="nx">abort_incomplete_multipart_upload</span> <span class="p">{</span>
      <span class="nx">days_after_initiation</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Athena for cost analysis</span>
<span class="nx">resource</span> <span class="s2">"aws_athena_database"</span> <span class="s2">"cost_analysis"</span> <span class="p">{</span>
  <span class="nx">name</span>   <span class="o">=</span> <span class="s2">"${var.environment}_cost_analysis"</span>
  <span class="nx">bucket</span> <span class="o">=</span> <span class="nx">aws_s3_bucket</span><span class="p">.</span><span class="nx">cost_reports</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="nx">resource</span> <span class="s2">"aws_athena_workgroup"</span> <span class="s2">"cost_analysis"</span> <span class="p">{</span>
  <span class="nx">name</span> <span class="o">=</span> <span class="s2">"${var.environment}-cost-analysis"</span>
  
  <span class="nx">configuration</span> <span class="p">{</span>
    <span class="nx">enforce_workgroup_configuration</span>    <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">publish_cloudwatch_metrics_enabled</span> <span class="o">=</span> <span class="kc">true</span>
    
    <span class="nx">result_configuration</span> <span class="p">{</span>
      <span class="nx">output_location</span> <span class="o">=</span> <span class="s2">"s3://${aws_s3_bucket.cost_reports.id}/athena-results/"</span>
      
      <span class="nx">encryption_configuration</span> <span class="p">{</span>
        <span class="nx">encryption_option</span> <span class="o">=</span> <span class="s2">"SSE_S3"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># QuickSight for cost visualization</span>
<span class="nx">resource</span> <span class="s2">"aws_quicksight_data_source"</span> <span class="s2">"cost_data"</span> <span class="p">{</span>
  <span class="nx">data_source_id</span> <span class="o">=</span> <span class="s2">"${var.environment}-cost-data"</span>
  <span class="nx">name</span>           <span class="o">=</span> <span class="s2">"Cost and Usage Report"</span>
  
  <span class="nx">parameters</span> <span class="p">{</span>
    <span class="nx">athena</span> <span class="p">{</span>
      <span class="nx">work_group</span> <span class="o">=</span> <span class="nx">aws_athena_workgroup</span><span class="p">.</span><span class="nx">cost_analysis</span><span class="p">.</span><span class="nx">name</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">type</span> <span class="o">=</span> <span class="s2">"ATHENA"</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    for key in tag_schema.keys():
        self.ce_client.create_cost_category_definition(
            Name=f'CostCategory-{key}',
            Rules=[
                {
                    'Value': value,
                    'Rule': {
                        'Tags': {
                            'Key': key,
                            'Values': [value]
                        }
                    }
                } for value in tag_schema[key]
            ]
        )
</code></pre></div></div>

<h1 id="spot-instance-management">Spot Instance management</h1>
<p>class SpotInstanceManager:
    def <strong>init</strong>(self):
        self.ec2 = boto3.client(‘ec2’)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def create_spot_fleet(self,
                     target_capacity: int,
                     instance_types: List[str],
                     max_price: str,
                     subnets: List[str]) -&gt; str:
    """Create diversified Spot Fleet"""
    
    # Build launch specifications for each instance type
    launch_specs = []
    
    for instance_type in instance_types:
        for subnet in subnets:
            launch_specs.append({
                'InstanceType': instance_type,
                'ImageId': 'ami-12345678',  # Your AMI
                'KeyName': 'your-key-pair',
                'SecurityGroups': [{'GroupId': 'sg-12345678'}],
                'SubnetId': subnet,
                'IamInstanceProfile': {
                    'Arn': 'arn:aws:iam::account:instance-profile/role'
                },
                'TagSpecifications': [
                    {
                        'ResourceType': 'instance',
                        'Tags': [
                            {'Key': 'Name', 'Value': 'SpotFleet-Instance'},
                            {'Key': 'Type', 'Value': 'Spot'}
                        ]
                    }
                ]
            })
    
    response = self.ec2.request_spot_fleet(
        SpotFleetRequestConfig={
            'AllocationStrategy': 'diversified',
            'TargetCapacity': target_capacity,
            'SpotPrice': max_price,
            'IamFleetRole': 'arn:aws:iam::account:role/aws-ec2-spot-fleet-role',
            'LaunchSpecifications': launch_specs,
            'TerminateInstancesWithExpiration': True,
            'Type': 'maintain',
            'ReplaceUnhealthyInstances': True,
            'InstanceInterruptionBehavior': 'terminate',
            'TagSpecifications': [
                {
                    'ResourceType': 'spot-fleet-request',
                    'Tags': [
                        {'Key': 'Name', 'Value': 'MySpotFleet'}
                    ]
                }
            ]
        }
    )
    
    return response['SpotFleetRequestId'] ```
</code></pre></div></div>

<h2 id="infrastructure-as-code-never-click-again">Infrastructure as Code: Never Click Again</h2>

<p>The biggest shift in cloud operations? Treating infrastructure like software. Instead of clicking through the AWS console, you define infrastructure in code. This enables version control, peer review, and automated deployments.</p>

<h3 id="why-infrastructure-as-code-changes-everything">Why Infrastructure as Code Changes Everything</h3>

<p><strong>The Old Way</strong>:</p>
<ul>
  <li>Click through AWS console to create resources</li>
  <li>Document steps in a wiki (that nobody updates)</li>
  <li>Hope you can recreate it in another region</li>
  <li>Fear making changes that might break production</li>
</ul>

<p><strong>The IaC Way</strong>:</p>
<ul>
  <li>Define infrastructure in configuration files</li>
  <li>Version control shows exactly what changed and when</li>
  <li>Deploy identical environments with one command</li>
  <li>Test changes in staging before production</li>
</ul>

<h3 id="choosing-your-iac-tool">Choosing Your IaC Tool</h3>

<h4 id="cloudformation-aws-native">CloudFormation (AWS Native)</h4>
<ul>
  <li>
<strong>Pros</strong>: Deep AWS integration, no extra tools needed</li>
  <li>
<strong>Cons</strong>: Verbose syntax, AWS-only</li>
  <li>
<strong>Best for</strong>: Teams fully committed to AWS</li>
</ul>

<h4 id="terraform-multi-cloud">Terraform (Multi-Cloud)</h4>
<ul>
  <li>
<strong>Pros</strong>: Works across cloud providers, huge community</li>
  <li>
<strong>Cons</strong>: Requires learning HCL syntax</li>
  <li>
<strong>Best for</strong>: Multi-cloud strategies or teams wanting flexibility</li>
</ul>

<h4 id="aws-cdk-developer-friendly">AWS CDK (Developer-Friendly)</h4>
<ul>
  <li>
<strong>Pros</strong>: Use familiar programming languages (Python, TypeScript)</li>
  <li>
<strong>Cons</strong>: Newer tool, smaller community</li>
  <li>
<strong>Best for</strong>: Development teams wanting to use existing skills</li>
</ul>

<h3 id="real-world-iac-evolution">Real-World IaC Evolution</h3>

<p>A startup’s infrastructure journey:</p>

<ol>
  <li>
<strong>Month 1</strong>: Everything created via console clicks</li>
  <li>
<strong>Month 3</strong>: Production breaks, nobody remembers how to rebuild</li>
  <li>
<strong>Month 4</strong>: Team adopts Terraform, documents existing infrastructure</li>
  <li>
<strong>Month 6</strong>: All changes go through pull requests</li>
  <li>
<strong>Year 1</strong>: Disaster recovery test - entire production rebuilt in 30 minutes</li>
</ol>

<h3 id="advanced-patterns-that-save-your-sanity">Advanced Patterns That Save Your Sanity</h3>

<div class="language-hcl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">from</span> <span class="nx">aws_cdk</span> <span class="nx">import</span> <span class="err">(</span>
    <span class="nx">core</span> <span class="nx">as</span> <span class="nx">cdk</span><span class="err">,</span>
    <span class="nx">aws_ec2</span> <span class="nx">as</span> <span class="nx">ec2</span><span class="err">,</span>
    <span class="nx">aws_ecs</span> <span class="nx">as</span> <span class="nx">ecs</span><span class="err">,</span>
    <span class="nx">aws_ecs_patterns</span> <span class="nx">as</span> <span class="nx">ecs_patterns</span><span class="err">,</span>
    <span class="nx">aws_elasticloadbalancingv2</span> <span class="nx">as</span> <span class="nx">elbv2</span><span class="err">,</span>
    <span class="nx">aws_rds</span> <span class="nx">as</span> <span class="nx">rds</span><span class="err">,</span>
    <span class="nx">aws_secretsmanager</span> <span class="nx">as</span> <span class="nx">sm</span><span class="err">,</span>
    <span class="nx">aws_cloudwatch</span> <span class="nx">as</span> <span class="nx">cloudwatch</span><span class="err">,</span>
    <span class="nx">aws_cloudwatch_actions</span> <span class="nx">as</span> <span class="nx">cw_actions</span><span class="err">,</span>
    <span class="nx">aws_sns</span> <span class="nx">as</span> <span class="nx">sns</span><span class="err">,</span>
    <span class="nx">aws_lambda</span> <span class="nx">as</span> <span class="nx">lambda_</span><span class="err">,</span>
    <span class="nx">aws_apigateway</span> <span class="nx">as</span> <span class="nx">apigw</span><span class="err">,</span>
    <span class="nx">custom_resources</span> <span class="nx">as</span> <span class="nx">cr</span>
<span class="err">)</span>
<span class="nx">from</span> <span class="nx">constructs</span> <span class="nx">import</span> <span class="nx">Construct</span>
<span class="nx">import</span> <span class="nx">json</span>

<span class="nx">class</span> <span class="nx">MicroservicesStack</span><span class="err">(</span><span class="nx">cdk</span><span class="err">.</span><span class="nx">Stack</span><span class="err">)</span><span class="o">:</span>
    <span class="nx">def</span> <span class="nx">__init__</span><span class="err">(</span><span class="nx">self</span><span class="err">,</span> <span class="nx">scope</span><span class="o">:</span> <span class="nx">Construct</span><span class="err">,</span> <span class="nx">construct_id</span><span class="o">:</span> <span class="nx">str</span><span class="err">,</span> <span class="o">**</span><span class="nx">kwargs</span><span class="err">)</span> <span class="o">-&gt;</span> <span class="nx">None</span><span class="o">:</span>
        <span class="nx">super</span><span class="err">().</span><span class="nx">__init__</span><span class="err">(</span><span class="nx">scope</span><span class="err">,</span> <span class="nx">construct_id</span><span class="err">,</span> <span class="o">**</span><span class="nx">kwargs</span><span class="err">)</span>
        
        <span class="c1"># Create VPC with custom configuration</span>
        <span class="nx">vpc</span> <span class="o">=</span> <span class="nx">ec2</span><span class="err">.</span><span class="nx">Vpc</span><span class="err">(</span>
            <span class="nx">self</span><span class="err">,</span> <span class="s2">"MicroservicesVPC"</span><span class="err">,</span>
            <span class="nx">max_azs</span><span class="o">=</span><span class="mi">3</span><span class="err">,</span>
            <span class="nx">nat_gateways</span><span class="o">=</span><span class="mi">2</span><span class="err">,</span>
            <span class="nx">subnet_configuration</span><span class="o">=</span><span class="p">[</span>
                <span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetConfiguration</span><span class="p">(</span>
                    <span class="nx">name</span><span class="o">=</span><span class="s2">"Public"</span><span class="p">,</span>
                    <span class="nx">subnet_type</span><span class="o">=</span><span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetType</span><span class="p">.</span><span class="nx">PUBLIC</span><span class="p">,</span>
                    <span class="nx">cidr_mask</span><span class="o">=</span><span class="mi">24</span>
                <span class="p">),</span>
                <span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetConfiguration</span><span class="p">(</span>
                    <span class="nx">name</span><span class="o">=</span><span class="s2">"Private"</span><span class="p">,</span>
                    <span class="nx">subnet_type</span><span class="o">=</span><span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetType</span><span class="p">.</span><span class="nx">PRIVATE</span><span class="p">,</span>
                    <span class="nx">cidr_mask</span><span class="o">=</span><span class="mi">24</span>
                <span class="p">),</span>
                <span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetConfiguration</span><span class="p">(</span>
                    <span class="nx">name</span><span class="o">=</span><span class="s2">"Isolated"</span><span class="p">,</span>
                    <span class="nx">subnet_type</span><span class="o">=</span><span class="nx">ec2</span><span class="p">.</span><span class="nx">SubnetType</span><span class="p">.</span><span class="nx">ISOLATED</span><span class="p">,</span>
                    <span class="nx">cidr_mask</span><span class="o">=</span><span class="mi">24</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="err">)</span>
        
        <span class="c1"># Create ECS Cluster with capacity providers</span>
        <span class="nx">cluster</span> <span class="o">=</span> <span class="nx">ecs</span><span class="err">.</span><span class="nx">Cluster</span><span class="err">(</span>
            <span class="nx">self</span><span class="err">,</span> <span class="s2">"Cluster"</span><span class="err">,</span>
            <span class="nx">vpc</span><span class="o">=</span><span class="nx">vpc</span><span class="err">,</span>
            <span class="nx">container_insights</span><span class="o">=</span><span class="nx">True</span>
        <span class="err">)</span>
        
        <span class="c1"># Add Fargate Spot capacity provider</span>
        <span class="nx">cluster</span><span class="err">.</span><span class="nx">add_capacity_provider</span><span class="err">(</span>
            <span class="nx">ecs</span><span class="err">.</span><span class="nx">FargateCapacityProvider</span><span class="err">(</span>
                <span class="nx">self</span><span class="err">,</span> <span class="s2">"FargateSpotProvider"</span><span class="err">,</span>
                <span class="nx">spot</span><span class="o">=</span><span class="nx">True</span>
            <span class="err">)</span>
        <span class="err">)</span>
        
        <span class="c1"># Create RDS Aurora Serverless v2</span>
        <span class="nx">db_secret</span> <span class="o">=</span> <span class="nx">sm</span><span class="err">.</span><span class="nx">Secret</span><span class="err">(</span>
            <span class="nx">self</span><span class="err">,</span> <span class="s2">"DBSecret"</span><span class="err">,</span>
            <span class="nx">generate_secret_string</span><span class="o">=</span><span class="nx">sm</span><span class="err">.</span><span class="nx">SecretStringGenerator</span><span class="err">(</span>
                <span class="nx">secret_string_template</span><span class="o">=</span><span class="nx">json</span><span class="err">.</span><span class="nx">dumps</span><span class="err">(</span><span class="p">{</span><span class="s2">"username"</span><span class="o">:</span> <span class="s2">"admin"</span><span class="p">}</span><span class="err">),</span>
                <span class="nx">generate_string_key</span><span class="o">=</span><span class="s2">"password"</span><span class="err">,</span>
                <span class="nx">exclude_characters</span><span class="o">=</span><span class="s2">" %+~`#$&amp;*()|[]{}:;&lt;&gt;?!'/</span><span class="err">\</span><span class="se">\"</span><span class="s2">
            )
        )
        
        db_cluster = rds.DatabaseCluster(
            self, "</span><span class="nx">AuroraCluster</span><span class="s2">",
            engine=rds.DatabaseClusterEngine.aurora_mysql(
                version=rds.AuroraMysqlEngineVersion.VER_3_01_0
            ),
            serverless_v2_scaling_configuration=rds.ServerlessV2ScalingConfiguration(
                min_capacity=0.5,
                max_capacity=2
            ),
            credentials=rds.Credentials.from_secret(db_secret),
            vpc=vpc,
            vpc_subnets=ec2.SubnetSelection(
                subnet_type=ec2.SubnetType.ISOLATED
            ),
            backup=rds.BackupProps(
                retention=cdk.Duration.days(7)
            ),
            deletion_protection=True
        )
        
        # Create shared ALB
        alb = elbv2.ApplicationLoadBalancer(
            self, "</span><span class="nx">ALB</span><span class="s2">",
            vpc=vpc,
            internet_facing=True,
            http2_enabled=True
        )
        
        # Add CloudWatch alarms
        alarm = cloudwatch.Alarm(
            self, "</span><span class="nx">HighErrorRate</span><span class="s2">",
            metric=alb.metric_target_response_time(),
            threshold=1000,
            evaluation_periods=2
        )
        
        # SNS topic for alarms
        alarm_topic = sns.Topic(
            self, "</span><span class="nx">AlarmTopic</span><span class="s2">",
            display_name="</span><span class="nx">Microservices</span> <span class="nx">Alarms</span><span class="s2">"
        )
        
        alarm.add_alarm_action(cw_actions.SnsAction(alarm_topic))
        
        # Deploy microservices
        self.deploy_microservice(
            cluster=cluster,
            alb=alb,
            service_name="</span><span class="nx">users</span><span class="s2">",
            image="</span><span class="nx">users-service</span><span class="o">:</span><span class="nx">latest</span><span class="s2">",
            port=8080,
            priority=1,
            path_pattern="</span><span class="o">/</span><span class="nx">users</span><span class="cm">/*",
            environment={
                "DB_SECRET_ARN": db_secret.secret_arn,
                "DB_CLUSTER_ARN": db_cluster.cluster_arn
            }
        )
        
        self.deploy_microservice(
            cluster=cluster,
            alb=alb,
            service_name="orders",
            image="orders-service:latest",
            port=8081,
            priority=2,
            path_pattern="/orders/*",
            environment={
                "DB_SECRET_ARN": db_secret.secret_arn,
                "DB_CLUSTER_ARN": db_cluster.cluster_arn
            }
        )
        
        # Create API Gateway for serverless endpoints
        api = apigw.RestApi(
            self, "MicroservicesAPI",
            deploy_options=apigw.StageOptions(
                logging_level=apigw.MethodLoggingLevel.INFO,
                data_trace_enabled=True,
                tracing_enabled=True
            )
        )
        
        # Lambda function for async processing
        async_processor = lambda_.Function(
            self, "AsyncProcessor",
            runtime=lambda_.Runtime.PYTHON_3_9,
            handler="index.handler",
            code=lambda_.Code.from_asset("lambda"),
            vpc=vpc,
            environment={
                "DB_SECRET_ARN": db_secret.secret_arn
            },
            reserved_concurrent_executions=100,
            tracing=lambda_.Tracing.ACTIVE
        )
        
        # Grant permissions
        db_secret.grant_read(async_processor)
        db_cluster.grant_connect(async_processor)
        
        # Custom resource for database initialization
        db_init = cr.AwsCustomResource(
            self, "DBInit",
            on_create=cr.AwsSdkCall(
                service="RDS",
                action="executeStatement",
                parameters={
                    "resourceArn": db_cluster.cluster_arn,
                    "secretArn": db_secret.secret_arn,
                    "database": "mysql",
                    "sql": "CREATE DATABASE IF NOT EXISTS microservices;"
                },
                physical_resource_id=cr.PhysicalResourceId.of("DBInit")
            ),
            policy=cr.AwsCustomResourcePolicy.from_sdk_calls(
                resources=[db_cluster.cluster_arn]
            )
        )
        
        # Output values
        cdk.CfnOutput(
            self, "ALBDNSName",
            value=alb.load_balancer_dns_name,
            description="ALB DNS Name"
        )
        
        cdk.CfnOutput(
            self, "APIEndpoint",
            value=api.url,
            description="API Gateway Endpoint"
        )
    
    def deploy_microservice(self,
                           cluster: ecs.Cluster,
                           alb: elbv2.ApplicationLoadBalancer,
                           service_name: str,
                           image: str,
                           port: int,
                           priority: int,
                           path_pattern: str,
                           environment: dict):
        """Deploy a microservice to ECS"""
        
        # Create task definition
        task_definition = ecs.FargateTaskDefinition(
            self, f"{service_name}TaskDef",
            memory_limit_mib=512,
            cpu=256
        )
        
        # Add container
        container = task_definition.add_container(
            f"{service_name}Container",
            image=ecs.ContainerImage.from_registry(image),
            logging=ecs.LogDrivers.aws_logs(
                stream_prefix=service_name
            ),
            environment=environment,
            health_check=ecs.HealthCheck(
                command=["CMD-SHELL", f"curl -f http://localhost:{port}/health || exit 1"],
                interval=cdk.Duration.seconds(30),
                timeout=cdk.Duration.seconds(5),
                retries=3
            )
        )
        
        container.add_port_mappings(
            ecs.PortMapping(
                container_port=port,
                protocol=ecs.Protocol.TCP
            )
        )
        
        # Create service
        service = ecs.FargateService(
            self, f"{service_name}Service",
            cluster=cluster,
            task_definition=task_definition,
            desired_count=2,
            capacity_provider_strategies=[
                ecs.CapacityProviderStrategy(
                    capacity_provider="FARGATE_SPOT",
                    weight=2
                ),
                ecs.CapacityProviderStrategy(
                    capacity_provider="FARGATE",
                    weight=1
                )
            ],
            circuit_breaker=ecs.DeploymentCircuitBreaker(
                rollback=True
            )
        )
        
        # Configure auto-scaling
        scaling = service.auto_scale_task_count(
            min_capacity=2,
            max_capacity=10
        )
        
        scaling.scale_on_cpu_utilization(
            "CpuScaling",
            target_utilization_percent=70,
            scale_in_cooldown=cdk.Duration.seconds(60),
            scale_out_cooldown=cdk.Duration.seconds(60)
        )
        
        scaling.scale_on_request_count(
            "RequestScaling",
            requests_per_target=1000,
            target_group=alb.add_targets(
                f"{service_name}TG",
                port=port,
                targets=[service],
                health_check=elbv2.HealthCheck(
                    path=f"/{service_name}/health",
                    interval=cdk.Duration.seconds(30)
                )
            )
        )
        
        # Add ALB listener rule
        alb.add_listener(
            f"{service_name}Listener",
            port=80
        ).add_targets(
            f"{service_name}Targets",
            port=port,
            targets=[service],
            priority=priority,
            conditions=[
                elbv2.ListenerCondition.path_patterns([path_pattern])
            ]
        )
</span></code></pre></div></div>

<h2 id="aws-troubleshooting-guide-when-things-go-wrong">AWS Troubleshooting Guide: When Things Go Wrong</h2>

<p>Even experienced cloud architects encounter issues. This guide helps you diagnose and fix common AWS problems quickly.</p>

<h3 id="the-troubleshooting-mindset">The Troubleshooting Mindset</h3>

<p>Before diving into specific issues, adopt this systematic approach:</p>
<ol>
  <li>
<strong>Check the obvious first</strong> - Is it plugged in? (Is the service running?)</li>
  <li>
<strong>Isolate the problem</strong> - What changed recently?</li>
  <li>
<strong>Use AWS tools</strong> - CloudWatch Logs, X-Ray, Systems Manager</li>
  <li>
<strong>Document everything</strong> - Future you will thank present you</li>
</ol>

<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>

<h4 id="1-access-denied---the-most-common-aws-error">1. “Access Denied” - The Most Common AWS Error</h4>

<p><strong>Symptoms</strong>:</p>
<ul>
  <li>API calls fail with “Access Denied”</li>
  <li>Console shows “You don’t have permissions”</li>
  <li>Lambda functions can’t access resources</li>
</ul>

<p><strong>Diagnosis Checklist</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check who you are</span>
aws sts get-caller-identity

<span class="c"># Check attached policies</span>
aws iam list-attached-user-policies <span class="nt">--user-name</span> <span class="si">$(</span>aws sts get-caller-identity <span class="nt">--query</span> UserId <span class="nt">--output</span> text<span class="si">)</span>

<span class="c"># Test specific permissions</span>
aws iam simulate-principal-policy <span class="se">\</span>
  <span class="nt">--policy-source-arn</span> <span class="si">$(</span>aws sts get-caller-identity <span class="nt">--query</span> Arn <span class="nt">--output</span> text<span class="si">)</span> <span class="se">\</span>
  <span class="nt">--action-names</span> s3:GetObject <span class="se">\</span>
  <span class="nt">--resource-arns</span> arn:aws:s3:::my-bucket/<span class="k">*</span>
</code></pre></div></div>

<p><strong>Common Fixes</strong>:</p>

<ol>
  <li>
<strong>Wrong Region</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Check current region</span>
aws configure get region
   
<span class="c"># Set correct region</span>
<span class="nb">export </span><span class="nv">AWS_DEFAULT_REGION</span><span class="o">=</span>us-east-1
</code></pre></div>    </div>
  </li>
  <li>
<strong>Missing Resource Permissions</strong>
    <div class="language-json highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::my-bucket/*"</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">Don't</span><span class="w"> </span><span class="err">forget</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">/*</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
<strong>Service-Linked Roles</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># For Lambda accessing VPC</span>
aws iam create-service-linked-role <span class="nt">--aws-service-name</span> lambda.amazonaws.com
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="2-instance-connection-timeout---cant-ssh-to-ec2">2. “Instance Connection Timeout” - Can’t SSH to EC2</h4>

<p><strong>Symptoms</strong>:</p>
<ul>
  <li>SSH hangs or times out</li>
  <li>Can’t reach web server on instance</li>
  <li>Instance is running but unreachable</li>
</ul>

<p><strong>Systematic Diagnosis</strong>:</p>

<ol>
  <li>
<strong>Check Security Group</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># List security group rules</span>
aws ec2 describe-security-groups <span class="nt">--group-ids</span> sg-xxxxxx
   
<span class="c"># Fix: Allow SSH</span>
aws ec2 authorize-security-group-ingress <span class="se">\</span>
  <span class="nt">--group-id</span> sg-xxxxxx <span class="se">\</span>
  <span class="nt">--protocol</span> tcp <span class="se">\</span>
  <span class="nt">--port</span> 22 <span class="se">\</span>
  <span class="nt">--cidr</span> 0.0.0.0/0  <span class="c"># Use your IP for security</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Check Network ACLs</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Default NACLs allow all - custom ones might not</span>
aws ec2 describe-network-acls <span class="nt">--filters</span> <span class="s2">"Name=association.subnet-id,Values=subnet-xxxxx"</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Check Route Table</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Ensure route to Internet Gateway exists</span>
aws ec2 describe-route-tables <span class="nt">--filters</span> <span class="s2">"Name=association.subnet-id,Values=subnet-xxxxx"</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Check Instance Status</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Both checks should pass</span>
aws ec2 describe-instance-status <span class="nt">--instance-id</span> i-xxxxx
</code></pre></div>    </div>
  </li>
</ol>

<p><strong>Quick Fix Script</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="s2">"i-xxxxx"</span>
<span class="nv">SG_ID</span><span class="o">=</span><span class="si">$(</span>aws ec2 describe-instances <span class="nt">--instance-ids</span> <span class="nv">$INSTANCE_ID</span> <span class="nt">--query</span> <span class="s1">'Reservations[0].Instances[0].SecurityGroups[0].GroupId'</span> <span class="nt">--output</span> text<span class="si">)</span>

<span class="c"># Allow SSH from your IP</span>
<span class="nv">MY_IP</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-s</span> checkip.amazonaws.com<span class="si">)</span>
aws ec2 authorize-security-group-ingress <span class="se">\</span>
  <span class="nt">--group-id</span> <span class="nv">$SG_ID</span> <span class="se">\</span>
  <span class="nt">--protocol</span> tcp <span class="se">\</span>
  <span class="nt">--port</span> 22 <span class="se">\</span>
  <span class="nt">--cidr</span> <span class="nv">$MY_IP</span>/32

<span class="nb">echo</span> <span class="s2">"SSH access enabled from </span><span class="nv">$MY_IP</span><span class="s2">"</span>
</code></pre></div></div>

<h4 id="3-throttling-errors---rate-limit-exceeded">3. “Throttling Errors” - Rate Limit Exceeded</h4>

<p><strong>Symptoms</strong>:</p>
<ul>
  <li>“Rate exceeded” errors</li>
  <li>Intermittent API failures</li>
  <li>Bulk operations failing</li>
</ul>

<p><strong>Solutions</strong>:</p>

<ol>
  <li>
<strong>Implement Exponential Backoff</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="n">botocore.exceptions</span> <span class="kn">import</span> <span class="n">ClientError</span>
   
<span class="k">def</span> <span class="nf">retry_with_backoff</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">max_retries</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">func</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">.</span><span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Error</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">Code</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Throttling</span><span class="sh">'</span><span class="p">:</span>
                <span class="c1"># Exponential backoff with jitter
</span>                <span class="n">wait_time</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>
    <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Max retries (</span><span class="si">{</span><span class="n">max_retries</span><span class="si">}</span><span class="s">) exceeded</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Use Service Quotas</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Check current limits</span>
aws service-quotas get-service-quota <span class="se">\</span>
  <span class="nt">--service-code</span> ec2 <span class="se">\</span>
  <span class="nt">--quota-code</span> L-1216C47A  <span class="c"># Running On-Demand instances</span>
   
<span class="c"># Request increase</span>
aws service-quotas request-service-quota-increase <span class="se">\</span>
  <span class="nt">--service-code</span> ec2 <span class="se">\</span>
  <span class="nt">--quota-code</span> L-1216C47A <span class="se">\</span>
  <span class="nt">--desired-value</span> 100
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="4-out-of-memory---lambdacontainer-crashes">4. “Out of Memory” - Lambda/Container Crashes</h4>

<p><strong>Symptoms</strong>:</p>
<ul>
  <li>Lambda function fails with no clear error</li>
  <li>ECS tasks stopping unexpectedly</li>
  <li>Application becomes unresponsive</li>
</ul>

<p><strong>Diagnosis</strong>:</p>

<ol>
  <li>
<strong>Check Lambda Logs</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Find memory usage</span>
aws logs filter-log-events <span class="se">\</span>
  <span class="nt">--log-group-name</span> /aws/lambda/my-function <span class="se">\</span>
  <span class="nt">--filter-pattern</span> <span class="s2">"[REPORT]"</span> <span class="se">\</span>
  <span class="nt">--query</span> <span class="s1">'events[*].message'</span> <span class="se">\</span>
  <span class="nt">--output</span> text | <span class="nb">grep</span> <span class="s2">"Memory"</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Monitor with CloudWatch</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># Add memory tracking to Lambda
</span><span class="kn">import</span> <span class="n">resource</span>
   
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Track memory usage
</span>    <span class="n">memory_usage</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="nf">getrusage</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="n">RUSAGE_SELF</span><span class="p">).</span><span class="n">ru_maxrss</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Memory used: </span><span class="si">{</span><span class="n">memory_usage</span> <span class="o">/</span> <span class="mi">1024</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
       
    <span class="c1"># Your code here
</span></code></pre></div>    </div>
  </li>
  <li>
<strong>Fix: Increase Memory or Optimize</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Update Lambda memory</span>
aws lambda update-function-configuration <span class="se">\</span>
  <span class="nt">--function-name</span> my-function <span class="se">\</span>
  <span class="nt">--memory-size</span> 1024
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="5-slow-application-performance">5. “Slow Application Performance”</h4>

<p><strong>Symptoms</strong>:</p>
<ul>
  <li>API responses taking seconds</li>
  <li>Database queries timing out</li>
  <li>Users complaining about speed</li>
</ul>

<p><strong>Performance Troubleshooting Toolkit</strong>:</p>

<ol>
  <li>
<strong>Enable X-Ray Tracing</strong>
    <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">aws_xray_sdk.core</span> <span class="kn">import</span> <span class="n">xray_recorder</span>
<span class="kn">from</span> <span class="n">aws_xray_sdk.core</span> <span class="kn">import</span> <span class="n">patch_all</span>
   
<span class="nf">patch_all</span><span class="p">()</span>  <span class="c1"># Automatically trace AWS SDK calls
</span>   
<span class="nd">@xray_recorder.capture</span><span class="p">(</span><span class="sh">'</span><span class="s">process_order</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">):</span>
    <span class="c1"># X-Ray will show time spent in each service
</span>    <span class="nf">validate_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
    <span class="nf">charge_payment</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
    <span class="nf">update_inventory</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Analyze RDS Performance</strong>
    <div class="language-sql highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1">-- Enable Performance Insights</span>
<span class="c1">-- Then query slow operations</span>
<span class="k">SELECT</span> 
    <span class="n">query</span><span class="p">,</span>
    <span class="n">calls</span><span class="p">,</span>
    <span class="n">total_time</span><span class="p">,</span>
    <span class="n">mean_time</span><span class="p">,</span>
    <span class="n">max_time</span>
<span class="k">FROM</span> <span class="n">pg_stat_statements</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">mean_time</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>Check CloudFront Cache Hit Ratio</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Low cache hit = slow performance</span>
aws cloudwatch get-metric-statistics <span class="se">\</span>
  <span class="nt">--namespace</span> AWS/CloudFront <span class="se">\</span>
  <span class="nt">--metric-name</span> CacheHitRate <span class="se">\</span>
  <span class="nt">--dimensions</span> <span class="nv">Name</span><span class="o">=</span>DistributionId,Value<span class="o">=</span>XXXXX <span class="se">\</span>
  <span class="nt">--statistics</span> Average <span class="se">\</span>
  <span class="nt">--start-time</span> 2024-01-01T00:00:00Z <span class="se">\</span>
  <span class="nt">--end-time</span> 2024-01-02T00:00:00Z <span class="se">\</span>
  <span class="nt">--period</span> 3600
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="emergency-response-playbook">Emergency Response Playbook</h3>

<p>When production is down, follow this checklist:</p>

<h4 id="1-immediate-actions-first-5-minutes">1. Immediate Actions (First 5 Minutes)</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check service health</span>
aws health describe-events <span class="nt">--filter</span> <span class="nv">eventTypeCategories</span><span class="o">=</span>issue

<span class="c"># Check CloudWatch alarms</span>
aws cloudwatch describe-alarms <span class="nt">--state-value</span> ALARM

<span class="c"># Recent changes?</span>
aws cloudtrail lookup-events <span class="se">\</span>
  <span class="nt">--lookup-attributes</span> <span class="nv">AttributeKey</span><span class="o">=</span>EventName,AttributeValue<span class="o">=</span>UpdateStack <span class="se">\</span>
  <span class="nt">--max-items</span> 10
</code></pre></div></div>

<h4 id="2-common-quick-fixes">2. Common Quick Fixes</h4>

<p><strong>“Everything is Down!”</strong></p>
<ul>
  <li>Check Route 53 health checks</li>
  <li>Verify load balancer target health</li>
  <li>Check Auto Scaling group size</li>
</ul>

<p><strong>“Database Connection Errors”</strong></p>
<ul>
  <li>Check RDS security groups</li>
  <li>Verify connection limits not exceeded</li>
  <li>Check if automated backup is running</li>
</ul>

<p><strong>“API Gateway 5XX Errors”</strong></p>
<ul>
  <li>Check Lambda function errors</li>
  <li>Verify integration timeout settings</li>
  <li>Check concurrent execution limits</li>
</ul>

<h3 id="proactive-monitoring-setup">Proactive Monitoring Setup</h3>

<p>Prevent issues before they happen:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create comprehensive CloudWatch dashboard</span>
aws cloudwatch put-dashboard <span class="se">\</span>
  <span class="nt">--dashboard-name</span> ProductionHealth <span class="se">\</span>
  <span class="nt">--dashboard-body</span> file://dashboard.json

<span class="c"># Set up alerts for common issues</span>
<span class="c"># High error rate</span>
aws cloudwatch put-metric-alarm <span class="se">\</span>
  <span class="nt">--alarm-name</span> high-error-rate <span class="se">\</span>
  <span class="nt">--alarm-description</span> <span class="s2">"Alert when error rate exceeds 1%"</span> <span class="se">\</span>
  <span class="nt">--metric-name</span> 4XXError <span class="se">\</span>
  <span class="nt">--namespace</span> AWS/ApiGateway <span class="se">\</span>
  <span class="nt">--statistic</span> Sum <span class="se">\</span>
  <span class="nt">--period</span> 300 <span class="se">\</span>
  <span class="nt">--threshold</span> 50 <span class="se">\</span>
  <span class="nt">--comparison-operator</span> GreaterThanThreshold

<span class="c"># Database CPU</span>
aws cloudwatch put-metric-alarm <span class="se">\</span>
  <span class="nt">--alarm-name</span> rds-high-cpu <span class="se">\</span>
  <span class="nt">--alarm-description</span> <span class="s2">"RDS CPU above 80%"</span> <span class="se">\</span>
  <span class="nt">--metric-name</span> CPUUtilization <span class="se">\</span>
  <span class="nt">--namespace</span> AWS/RDS <span class="se">\</span>
  <span class="nt">--statistic</span> Average <span class="se">\</span>
  <span class="nt">--period</span> 300 <span class="se">\</span>
  <span class="nt">--threshold</span> 80 <span class="se">\</span>
  <span class="nt">--comparison-operator</span> GreaterThanThreshold
</code></pre></div></div>

<h3 id="tools-every-aws-developer-should-know">Tools Every AWS Developer Should Know</h3>

<ol>
  <li>
<strong>AWS CLI with Query Powers</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Find specific resources quickly</span>
aws ec2 describe-instances <span class="se">\</span>
  <span class="nt">--query</span> <span class="s1">'Reservations[*].Instances[?State.Name==`running`].[InstanceId,Tags[?Key==`Name`].Value|[0]]'</span> <span class="se">\</span>
  <span class="nt">--output</span> table
</code></pre></div>    </div>
  </li>
  <li>
<strong>Systems Manager Session Manager</strong>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Connect without SSH keys or bastion hosts</span>
aws ssm start-session <span class="nt">--target</span> i-xxxxx
</code></pre></div>    </div>
  </li>
  <li>
<strong>CloudWatch Logs Insights</strong>
    <div class="language-sql highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1">-- Find errors across all Lambda functions</span>
<span class="n">fields</span> <span class="o">@</span><span class="nb">timestamp</span><span class="p">,</span> <span class="o">@</span><span class="n">message</span>
<span class="o">|</span> <span class="n">filter</span> <span class="o">@</span><span class="n">message</span> <span class="k">like</span> <span class="o">/</span><span class="n">ERROR</span><span class="o">/</span>
<span class="o">|</span> <span class="n">stats</span> <span class="k">count</span><span class="p">()</span> <span class="k">by</span> <span class="n">bin</span><span class="p">(</span><span class="mi">5</span><span class="n">m</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
<strong>AWS Personal Health Dashboard</strong>
    <ul>
      <li>Check for AWS service issues affecting you</li>
      <li>Get advance notice of maintenance</li>
    </ul>
  </li>
</ol>

<p>Remember: Most AWS issues fall into these categories:</p>
<ul>
  <li>
<strong>Permissions</strong> (IAM)</li>
  <li>
<strong>Networking</strong> (Security Groups, NACLs)</li>
  <li>
<strong>Limits</strong> (Service Quotas)</li>
  <li>
<strong>Configuration</strong> (Wrong region, missing parameters)</li>
</ul>

<p>Master troubleshooting these four areas and you’ll solve 90% of AWS problems.</p>

<h2 id="your-cloud-journey-from-here-to-mastery">Your Cloud Journey: From Here to Mastery</h2>

<p>You’ve learned the core concepts, explored architecture patterns, and understand optimization strategies. Where do you go from here?</p>

<h3 id="the-path-forward">The Path Forward</h3>

<h4 id="next-30-days-build-your-foundation">Next 30 Days: Build Your Foundation</h4>
<ol>
  <li>
<strong>Get Hands-On</strong>: Launch your first EC2 instance, create an S3 bucket, set up a simple website</li>
  <li>
<strong>Break Things</strong>: Experiment in a sandbox account - failure is the best teacher</li>
  <li>
<strong>Automate One Thing</strong>: Convert a manual process to Lambda or use CloudFormation</li>
  <li>
<strong>Monitor Costs</strong>: Set up billing alerts and understand your first bill</li>
</ol>

<h4 id="next-90-days-develop-expertise">Next 90 Days: Develop Expertise</h4>
<ol>
  <li>
<strong>Build a Real Project</strong>: Create something you’ll actually use</li>
  <li>
<strong>Master One Service Deeply</strong>: Whether it’s Lambda, DynamoDB, or ECS</li>
  <li>
<strong>Practice Troubleshooting</strong>: Learn to read CloudWatch logs and traces</li>
  <li>
<strong>Join the Community</strong>: AWS user groups, re:Invent videos, forums</li>
</ol>

<h4 id="next-year-achieve-mastery">Next Year: Achieve Mastery</h4>
<ol>
  <li>
<strong>Design for Scale</strong>: Build systems that can grow 100x</li>
  <li>
<strong>Optimize Everything</strong>: Cost, performance, security, operations</li>
  <li>
<strong>Share Knowledge</strong>: Blog, speak, mentor others</li>
  <li>
<strong>Stay Current</strong>: AWS releases new features daily - follow what matters to you</li>
</ol>

<h3 id="emerging-trends-to-watch">Emerging Trends to Watch</h3>

<p><strong>Serverless Everything</strong>: The trend toward managed services accelerates. Focus on business logic, not infrastructure.</p>

<p><strong>AI-Powered Operations</strong>: From cost optimization to security, AI will automate routine cloud management tasks.</p>

<p><strong>Edge Computing</strong>: Processing moves closer to users. 5G and IoT drive computing to the edge.</p>

<p><strong>Sustainability Focus</strong>: Carbon-aware computing becomes standard. Green architectures will be the default.</p>

<h3 id="remember-cloud-is-a-journey-not-a-destination">Remember: Cloud is a Journey, Not a Destination</h3>

<p>AWS evolves constantly. The services you master today will have new features tomorrow. The architectures you build will need to adapt. That’s not a bug - it’s the feature that makes cloud computing exciting.</p>

<p>Start small, think big, and build amazing things. The cloud is your platform for innovation. What will you create?</p>

<hr>

<h2 id="see-also">See Also</h2>

<ul>
  <li>
<a href="./">AWS Hub</a> - Overview of all AWS documentation</li>
  <li>
<a href="compute.html">Compute Services</a> - EC2 and Lambda deployment</li>
  <li>
<a href="storage.html">Storage Services</a> - S3 and EBS management</li>
  <li>
<a href="databases.html">Database Services</a> - RDS and DynamoDB</li>
  <li>
<a href="../networking.html">Networking</a> - VPC and load balancers</li>
  <li>
<a href="security.html">Security</a> - Security automation and compliance</li>
  <li>
<a href="../terraform/">Terraform</a> - Alternative IaC approach</li>
  <li>
<a href="../docker/">Docker</a> - Containerization for deployments</li>
  <li>
<a href="../kubernetes/">Kubernetes</a> - Container orchestration</li>
</ul>

      </section>
    </div>
  </article>
</div>
</body>
</html>