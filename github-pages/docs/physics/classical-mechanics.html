<h1 id="classical-mechanics">Classical Mechanics</h1>

<html><header><link rel="stylesheet" href="https://andrewaltimit.github.io/Documentation/style.css" /></header></html>

<hr />

<p><strong>The Foundation of Physics: Understanding Motion and Forces</strong></p>

<p><em>Explore the fundamental principles that govern the motion of everyday objects</em></p>

<p>Classical mechanics is the branch of physics that deals with the motion of macroscopic objects from projectiles to parts of machinery, as well as astronomical objects such as spacecraft, planets, stars, and galaxies. It provides extremely accurate results when studying large objects that are not extremely massive and speeds that are not approaching the speed of light.</p>

<hr />

<h2 id="overview">Overview</h2>

<p><strong>Core Principles</strong></p>
<ul>
  <li><a href="#newtons-laws-of-motion">Newton’s Laws of Motion</a></li>
  <li><a href="#conservation-laws">Conservation Laws</a></li>
  <li><a href="#work-and-energy">Work and Energy</a></li>
</ul>

<p><strong>Motion Analysis</strong></p>
<ul>
  <li><a href="#kinematics">Kinematics</a></li>
  <li><a href="#projectile-motion">Projectile Motion</a></li>
  <li><a href="#simple-harmonic-motion">Simple Harmonic Motion</a></li>
</ul>

<p><strong>Advanced Topics</strong></p>
<ul>
  <li><a href="#rotational-motion">Rotational Motion</a></li>
  <li><a href="#gravitation">Gravitation</a></li>
  <li><a href="#oscillations-and-waves">Oscillations and Waves</a></li>
</ul>

<p><strong>Applications and Context</strong></p>
<ul>
  <li><a href="#engineering-applications">Engineering Applications</a></li>
  <li><a href="#problem-solving-strategies">Problem-Solving Strategies</a></li>
  <li><a href="#historical-context">Historical Context</a></li>
</ul>

<hr />

<h2 id="fundamental-concepts">Fundamental Concepts</h2>

<h3 id="newtons-laws-of-motion">Newton’s Laws of Motion</h3>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/file-pdf-fill.svg" class="icon" /><a href="https://www.newton.ac.uk/files/preprints/ni16002.pdf"> Paper: <b><i>Philosophiæ Naturalis Principia Mathematica</i></b> - Isaac Newton</a></p>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/play-btn-fill.svg" class="icon" /><a href="https://www.youtube.com/watch?v=kKKM8Y-u7ds"> Video: <b><i>Newton's Laws of Motion Explained</i></b></a></p>

<p>The foundation of classical mechanics is built upon Newton’s three laws of motion:</p>

<center>
<a href="https://andrewaltimit.github.io/Documentation/images/physics/newtons-laws-diagram.png">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/newtons-laws-diagram.png" alt="Newton's Three Laws of Motion" width="80%" />
</a>
<br />
<p class="referenceBoxes type2">
<a href="https://en.wikipedia.org/wiki/Newton%27s_laws_of_motion">
<img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /> Article: <b><i>Newton's Laws Visual Summary</i></b></a>
</p>
</center>

<h4 id="first-law-law-of-inertia">First Law (Law of Inertia)</h4>
<p>An object at rest stays at rest and an object in motion stays in motion with the same speed and in the same direction unless acted upon by an unbalanced force.</p>

<p><strong>Mathematical Expression:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If ΣF = 0, then v = constant
</code></pre></div></div>

<h4 id="second-law-law-of-acceleration">Second Law (Law of Acceleration)</h4>

<p><a href="https://andrewaltimit.github.io/Documentation/images/physics/f-equals-ma.gif">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/f-equals-ma.gif" alt="F=ma Animation" width="350px" style="float:right; margin: 20px;" />
</a></p>

<p>The acceleration of an object is directly proportional to the net force acting on it and inversely proportional to its mass.</p>

<p><strong>Mathematical Expression:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>F = ma
</code></pre></div></div>
<p>Where:</p>
<ul>
  <li>F = net force (N)</li>
  <li>m = mass (kg)</li>
  <li>a = acceleration (m/s²)</li>
</ul>

<h4 id="third-law-action-reaction">Third Law (Action-Reaction)</h4>
<p>For every action, there is an equal and opposite reaction.</p>

<p><strong>Mathematical Expression:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>F₁₂ = -F₂₁
</code></pre></div></div>

<h3 id="conservation-laws">Conservation Laws</h3>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /><a href="https://www.feynmanlectures.caltech.edu/I_04.html"> Lecture: <b><i>Conservation of Energy - Feynman Lectures</i></b></a></p>

<p>Classical mechanics is governed by several fundamental conservation laws:</p>

<details>
<summary><b>Click to expand: Interactive Conservation Laws Demonstration</b></summary>
<br />
<div style="background-color: #f0f0f0; padding: 20px; border-radius: 5px;">
<p>Conservation laws are fundamental principles that remain constant in isolated systems:</p>
<ul>
<li><b>Energy Conservation:</b> Total energy (kinetic + potential) remains constant</li>
<li><b>Momentum Conservation:</b> Total momentum is conserved in collisions</li>
<li><b>Angular Momentum Conservation:</b> Rotational momentum is preserved</li>
</ul>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/play-btn-fill.svg" class="icon" /><a href="https://phet.colorado.edu/en/simulation/energy-skate-park"> Interactive: <b><i>Energy Skate Park Simulation</i></b></a></p>
</div>
</details>

<h4 id="conservation-of-energy">Conservation of Energy</h4>
<p>The total energy of an isolated system remains constant over time.</p>

<p><strong>Types of Energy:</strong></p>
<ul>
  <li><strong>Kinetic Energy</strong>: KE = ½mv²</li>
  <li><strong>Potential Energy</strong>: PE = mgh (gravitational)</li>
  <li><strong>Elastic Potential Energy</strong>: PE = ½kx²</li>
</ul>

<p><strong>Conservation Equation:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>E_initial = E_final
KE_i + PE_i = KE_f + PE_f
</code></pre></div></div>

<h4 id="conservation-of-momentum">Conservation of Momentum</h4>

<center>
<a href="https://andrewaltimit.github.io/Documentation/images/physics/momentum-conservation.gif">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/momentum-conservation.gif" alt="Momentum Conservation in Collisions" width="70%" />
</a>
<br />
<p class="referenceBoxes type2">
<a href="https://www.physicsclassroom.com/class/momentum/Lesson-2/Momentum-Conservation-Principle">
<img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /> Tutorial: <b><i>Momentum Conservation in Collisions</i></b></a>
</p>
</center>

<p>The total momentum of an isolated system remains constant.</p>

<p><strong>Linear Momentum:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p = mv
</code></pre></div></div>

<p><strong>Conservation Equation:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Σp_initial = Σp_final
</code></pre></div></div>

<h4 id="conservation-of-angular-momentum">Conservation of Angular Momentum</h4>
<p>The total angular momentum of an isolated system remains constant.</p>

<p><strong>Angular Momentum:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>L = Iω = r × p
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li>I = moment of inertia</li>
  <li>ω = angular velocity</li>
  <li>r = position vector</li>
  <li>p = linear momentum</li>
</ul>

<h2 id="kinematics">Kinematics</h2>

<p>Kinematics describes the motion of objects without considering the forces that cause the motion.</p>

<h3 id="one-dimensional-motion">One-Dimensional Motion</h3>

<p><strong>Position:</strong> x(t)</p>

<p><strong>Velocity:</strong> v = dx/dt</p>

<p><strong>Acceleration:</strong> a = dv/dt = d²x/dt²</p>

<h3 id="equations-of-motion-constant-acceleration">Equations of Motion (Constant Acceleration)</h3>
<ol>
  <li>v = v₀ + at</li>
  <li>x = x₀ + v₀t + ½at²</li>
  <li>v² = v₀² + 2a(x - x₀)</li>
  <li>x = x₀ + ½(v + v₀)t</li>
</ol>

<h3 id="projectile-motion">Projectile Motion</h3>

<center>
<a href="https://andrewaltimit.github.io/Documentation/images/physics/projectile-motion.png">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/projectile-motion.png" alt="Projectile Motion Trajectory" width="75%" />
</a>
<br />
<p class="referenceBoxes type2">
<a href="https://www.geogebra.org/m/nJY8AYyY">
<img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /> Interactive: <b><i>Projectile Motion Simulator</i></b></a>
</p>
</center>

<p>For projectile motion under constant gravitational acceleration:</p>

<p><strong>Horizontal Motion:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x = v₀ₓt
vₓ = v₀ₓ (constant)
</code></pre></div></div>

<p><strong>Vertical Motion:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>y = v₀ᵧt - ½gt²
vᵧ = v₀ᵧ - gt
</code></pre></div></div>

<p><strong>Range Formula:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R = (v₀²sin(2θ))/g
</code></pre></div></div>

<p><strong>Maximum Height:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>H = (v₀²sin²(θ))/(2g)
</code></pre></div></div>

<h2 id="dynamics">Dynamics</h2>

<p>Dynamics studies the forces and their effects on motion.</p>

<h3 id="work-and-energy">Work and Energy</h3>

<p><strong>Work:</strong> The energy transferred to or from an object via the application of force along a displacement.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>W = F·d = Fd cos(θ)
</code></pre></div></div>

<p>For variable force:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>W = ∫F·dr
</code></pre></div></div>

<h3 id="power">Power</h3>

<p>Power is the rate at which work is done:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P = dW/dt = F·v
</code></pre></div></div>

<h3 id="simple-harmonic-motion">Simple Harmonic Motion</h3>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/git.svg" class="icon" /><a href="https://github.com/matplotlib/matplotlib/blob/main/galleries/examples/animation/simple_anim.py"> Code: <b><i>SHM Animation with Matplotlib</i></b></a></p>

<p><a href="https://andrewaltimit.github.io/Documentation/images/physics/shm-animation.gif">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/shm-animation.gif" alt="Simple Harmonic Motion" width="400px" style="float:right; margin: 20px;" />
</a></p>

<p>Objects that experience a restoring force proportional to displacement exhibit simple harmonic motion.</p>

<p><strong>Hooke’s Law:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>F = -kx
</code></pre></div></div>

<p><strong>Equation of Motion:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x(t) = A cos(ωt + φ)
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li>A = amplitude</li>
  <li>ω = angular frequency = √(k/m)</li>
  <li>φ = phase constant</li>
</ul>

<p><strong>Period:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>T = 2π/ω = 2π√(m/k)
</code></pre></div></div>

<h2 id="rotational-motion">Rotational Motion</h2>

<details>
<summary><b>Mermaid Diagram: Linear vs Rotational Motion Analogy</b></summary>
<br />

```mermaid
graph LR
    subgraph Linear Motion
        A[Position x] --&gt; B[Velocity v = dx/dt]
        B --&gt; C[Acceleration a = dv/dt]
        D[Mass m] --&gt; E[Force F = ma]
        F[Momentum p = mv]
    end
    
    subgraph Rotational Motion
        G[Angular Position θ] --&gt; H[Angular Velocity ω = dθ/dt]
        H --&gt; I[Angular Acceleration α = dω/dt]
        J[Moment of Inertia I] --&gt; K[Torque τ = Iα]
        L[Angular Momentum L = Iω]
    end
    
    A -.-&gt;|Analogy| G
    B -.-&gt;|Analogy| H
    C -.-&gt;|Analogy| I
    D -.-&gt;|Analogy| J
    E -.-&gt;|Analogy| K
    F -.-&gt;|Analogy| L
```

</details>

<h3 id="rotational-kinematics">Rotational Kinematics</h3>

<p>Analogous to linear motion:</p>
<ul>
  <li>Angular position: θ</li>
  <li>Angular velocity: ω = dθ/dt</li>
  <li>Angular acceleration: α = dω/dt</li>
</ul>

<h3 id="moment-of-inertia">Moment of Inertia</h3>

<center>
<a href="https://andrewaltimit.github.io/Documentation/images/physics/moment-of-inertia-shapes.png">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/moment-of-inertia-shapes.png" alt="Moment of Inertia for Common Shapes" width="80%" />
</a>
<br />
<p class="referenceBoxes type2">
<a href="https://hyperphysics.phy-astr.gsu.edu/hbase/mi.html">
<img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /> Reference: <b><i>Moment of Inertia Tables</i></b></a>
</p>
</center>

<p>The rotational equivalent of mass:</p>

<p><strong>Point Mass:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I = mr²
</code></pre></div></div>

<p><strong>Common Shapes:</strong></p>
<ul>
  <li>Solid sphere: I = (2/5)MR²</li>
  <li>Solid cylinder: I = (1/2)MR²</li>
  <li>Thin rod (center): I = (1/12)ML²</li>
</ul>

<h3 id="torque">Torque</h3>

<p>The rotational equivalent of force:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>τ = r × F = rF sin(θ)
</code></pre></div></div>

<p><strong>Rotational Newton’s Second Law:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>τ = Iα
</code></pre></div></div>

<h2 id="gravitation">Gravitation</h2>

<h3 id="newtons-law-of-universal-gravitation">Newton’s Law of Universal Gravitation</h3>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/file-pdf-fill.svg" class="icon" /><a href="https://www.wilbourhall.org/pdfs/NewtonPrincipia.pdf"> Paper: <b><i>Principia - Book III: The System of the World</i></b></a></p>

<center>
<a href="https://andrewaltimit.github.io/Documentation/images/physics/universal-gravitation.png">
<img src="https://andrewaltimit.github.io/Documentation/images/physics/universal-gravitation.png" alt="Universal Gravitation" width="60%" />
</a>
<br />
<p class="referenceBoxes type2">
<a href="https://www.physicsclassroom.com/class/circles/Lesson-3/Newton-s-Law-of-Universal-Gravitation">
<img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /> Tutorial: <b><i>Understanding Universal Gravitation</i></b></a>
</p>
</center>

<p>Every particle attracts every other particle with a force:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>F = G(m₁m₂)/r²
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li>G = 6.674 × 10⁻¹¹ N·m²/kg² (gravitational constant)</li>
  <li>m₁, m₂ = masses of the objects</li>
  <li>r = distance between centers</li>
</ul>

<h3 id="orbital-motion">Orbital Motion</h3>

<p>For circular orbits:</p>

<p><strong>Orbital Velocity:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>v = √(GM/r)
</code></pre></div></div>

<p><strong>Orbital Period:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>T = 2π√(r³/GM)
</code></pre></div></div>

<p>This is Kepler’s Third Law for circular orbits.</p>

<h2 id="oscillations-and-waves">Oscillations and Waves</h2>

<h3 id="damped-oscillations">Damped Oscillations</h3>

<p>When friction is present:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mẍ + bẋ + kx = 0
</code></pre></div></div>

<p>Solutions depend on the damping coefficient b:</p>
<ul>
  <li><strong>Underdamped:</strong> Oscillates with decreasing amplitude</li>
  <li><strong>Critically damped:</strong> Returns to equilibrium fastest</li>
  <li><strong>Overdamped:</strong> Returns to equilibrium without oscillating</li>
</ul>

<h3 id="wave-motion">Wave Motion</h3>

<p><strong>Wave Equation:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>∂²y/∂t² = v²(∂²y/∂x²)
</code></pre></div></div>

<p><strong>Wave Speed:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>v = fλ
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li>f = frequency</li>
  <li>λ = wavelength</li>
</ul>

<h2 id="lagrangian-mechanics">Lagrangian Mechanics</h2>

<h3 id="the-principle-of-least-action">The Principle of Least Action</h3>

<p>Nature minimizes the action integral:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S = ∫_{t₁}^{t₂} L(q, q̇, t) dt
</code></pre></div></div>

<p>Where L = T - V is the Lagrangian (kinetic minus potential energy).</p>

<p><strong>Euler-Lagrange Equations:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>d/dt(∂L/∂q̇ᵢ) - ∂L/∂qᵢ = 0
</code></pre></div></div>

<p>These equations provide a powerful alternative to Newton’s laws.</p>

<h3 id="generalized-coordinates">Generalized Coordinates</h3>

<p>For a system with n degrees of freedom:</p>
<ul>
  <li><strong>Configuration space:</strong> Q = {q₁, q₂, …, qₙ}</li>
  <li><strong>Phase space:</strong> Γ = {q₁, …, qₙ, p₁, …, pₙ}</li>
  <li><strong>Generalized momentum:</strong> pᵢ = ∂L/∂q̇ᵢ</li>
</ul>

<h3 id="constraints-and-lagrange-multipliers">Constraints and Lagrange Multipliers</h3>

<p><strong>Holonomic constraints:</strong> f(q₁, …, qₙ, t) = 0</p>

<p><strong>Modified Lagrangian with constraints:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>L' = L + Σᵢ λᵢfᵢ(q, t)
</code></pre></div></div>

<h3 id="noethers-theorem">Noether’s Theorem</h3>

<p>Every continuous symmetry corresponds to a conserved quantity:</p>

<table>
  <thead>
    <tr>
      <th>Symmetry</th>
      <th>Conservation Law</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Time translation</td>
      <td>Energy</td>
    </tr>
    <tr>
      <td>Space translation</td>
      <td>Linear momentum</td>
    </tr>
    <tr>
      <td>Rotation</td>
      <td>Angular momentum</td>
    </tr>
    <tr>
      <td>Gauge invariance</td>
      <td>Charge</td>
    </tr>
  </tbody>
</table>

<p><strong>Mathematical Statement:</strong>
If the action is invariant under qᵢ → qᵢ + εξᵢ(q), then:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q = Σᵢ (∂L/∂q̇ᵢ)ξᵢ = constant
</code></pre></div></div>

<h3 id="example-double-pendulum">Example: Double Pendulum</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">double_pendulum_lagrangian</span><span class="p">(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">theta1_dot</span><span class="p">,</span> <span class="n">theta2_dot</span><span class="p">,</span> 
                                <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Lagrangian for double pendulum</span><span class="sh">"""</span>
    <span class="c1"># Kinetic energy
</span>    <span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m1</span><span class="o">*</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">theta1_dot</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m2</span><span class="o">*</span><span class="p">((</span><span class="n">l1</span><span class="o">*</span><span class="n">theta1_dot</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> 
        <span class="p">(</span><span class="n">l2</span><span class="o">*</span><span class="n">theta2_dot</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">theta1_dot</span><span class="o">*</span><span class="n">theta2_dot</span><span class="o">*</span>
        <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span><span class="o">-</span><span class="n">theta2</span><span class="p">))</span>
    
    <span class="c1"># Potential energy
</span>    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">m1</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> 
        <span class="n">l2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">T</span> <span class="o">-</span> <span class="n">V</span>
</code></pre></div></div>

<h2 id="hamiltonian-mechanics">Hamiltonian Mechanics</h2>

<h3 id="hamiltons-equations">Hamilton’s Equations</h3>

<p>The Hamiltonian represents total energy:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>H(q, p, t) = Σᵢ pᵢq̇ᵢ - L(q, q̇, t)
</code></pre></div></div>

<p><strong>Hamilton’s Canonical Equations:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>q̇ᵢ = ∂H/∂pᵢ
ṗᵢ = -∂H/∂qᵢ
</code></pre></div></div>

<h3 id="phase-space-and-liouvilles-theorem">Phase Space and Liouville’s Theorem</h3>

<p><strong>Liouville’s Theorem:</strong> Phase space volume is conserved:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dρ/dt + {ρ, H} = 0
</code></pre></div></div>

<p>Where {·,·} denotes the Poisson bracket.</p>

<h3 id="poisson-brackets">Poisson Brackets</h3>

<p>Fundamental algebraic structure of classical mechanics:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{f, g} = Σᵢ (∂f/∂qᵢ ∂g/∂pᵢ - ∂f/∂pᵢ ∂g/∂qᵢ)
</code></pre></div></div>

<p><strong>Properties:</strong></p>
<ul>
  <li>Antisymmetry: {f, g} = -{g, f}</li>
  <li>Linearity: {af + bg, h} = a{f, h} + b{g, h}</li>
  <li>Jacobi identity: {f, {g, h}} + {g, {h, f}} + {h, {f, g}} = 0</li>
</ul>

<p><strong>Time evolution:</strong> df/dt = {f, H} + ∂f/∂t</p>

<h3 id="canonical-transformations">Canonical Transformations</h3>

<p>Transformations preserving Hamilton’s equations:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q = Q(q, p, t)
P = P(q, p, t)
</code></pre></div></div>

<p><strong>Generating functions:</strong></p>
<ul>
  <li>Type 1: F₁(q, Q, t) → p = ∂F₁/∂q, P = -∂F₁/∂Q</li>
  <li>Type 2: F₂(q, P, t) → p = ∂F₂/∂q, Q = ∂F₂/∂P</li>
  <li>Type 3: F₃(p, Q, t) → q = -∂F₃/∂p, P = -∂F₃/∂Q</li>
  <li>Type 4: F₄(p, P, t) → q = -∂F₄/∂p, Q = ∂F₄/∂P</li>
</ul>

<p><strong>Symplectic structure:</strong> Canonical transformations preserve:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Σᵢ dpᵢ ∧ dqᵢ = Σᵢ dPᵢ ∧ dQᵢ
</code></pre></div></div>

<h3 id="action-angle-variables">Action-Angle Variables</h3>

<p>For integrable systems, transform to (I, θ) where:</p>
<ul>
  <li><strong>Action variables:</strong> Iᵢ = ∮ pᵢ dqᵢ/(2π)</li>
  <li><strong>Angle variables:</strong> θᵢ with period 2π</li>
  <li><strong>Hamilton’s equations:</strong> İᵢ = 0, θ̇ᵢ = ωᵢ(I) = ∂H/∂Iᵢ</li>
</ul>

<h2 id="hamilton-jacobi-theory">Hamilton-Jacobi Theory</h2>

<h3 id="hamilton-jacobi-equation">Hamilton-Jacobi Equation</h3>

<p>The action S(q, t) satisfies:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>∂S/∂t + H(q, ∂S/∂q, t) = 0
</code></pre></div></div>

<p><strong>Complete solution:</strong> S = S(q, α, t) + const</p>

<p>Where α are n constants of integration.</p>

<p><strong>New momenta:</strong> Pᵢ = αᵢ = constant
<strong>New coordinates:</strong> Qᵢ = ∂S/∂αᵢ = βᵢ + ωᵢt</p>

<h3 id="separation-of-variables">Separation of Variables</h3>

<p>For separable systems:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S = W(q) - Et
</code></pre></div></div>

<p><strong>Time-independent HJ equation:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>H(q, ∂W/∂q) = E
</code></pre></div></div>

<h3 id="connection-to-quantum-mechanics">Connection to Quantum Mechanics</h3>

<p>In the limit ℏ → 0:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ψ = exp(iS/ℏ)
</code></pre></div></div>

<p>Leads to the Schrödinger equation from Hamilton-Jacobi theory.</p>

<h2 id="chaos-theory-and-nonlinear-dynamics">Chaos Theory and Nonlinear Dynamics</h2>

<h3 id="lyapunov-exponents">Lyapunov Exponents</h3>

<p>Measure of sensitivity to initial conditions:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>λ = lim_{t→∞} (1/t) ln(|δZ(t)|/|δZ₀|)
</code></pre></div></div>

<p><strong>Chaotic system:</strong> At least one positive Lyapunov exponent.</p>

<h3 id="poincaré-sections">Poincaré Sections</h3>

<p>Reduce continuous dynamics to discrete map:</p>
<ul>
  <li>Choose surface of section Σ</li>
  <li>Record intersections of trajectory with Σ</li>
  <li>Study resulting discrete map</li>
</ul>

<h3 id="kam-theory">KAM Theory</h3>

<p><strong>Kolmogorov-Arnold-Moser theorem:</strong> Under small perturbations, most invariant tori survive if:</p>
<ul>
  <li>System is nearly integrable</li>
  <li>Frequencies satisfy diophantine condition</li>
  <li>Perturbation is sufficiently smooth</li>
</ul>

<p><strong>Arnold diffusion:</strong> In systems with n ≥ 3, trajectories can diffuse through destroyed tori.</p>

<h3 id="strange-attractors">Strange Attractors</h3>

<p><strong>Lorenz system:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ẋ = σ(y - x)
ẏ = x(ρ - z) - y
ż = xy - βz
</code></pre></div></div>

<p><strong>Properties:</strong></p>
<ul>
  <li>Fractal dimension</li>
  <li>Sensitive dependence on initial conditions</li>
  <li>Bounded but non-periodic</li>
</ul>

<h2 id="geometric-mechanics">Geometric Mechanics</h2>

<h3 id="symplectic-geometry">Symplectic Geometry</h3>

<p><strong>Symplectic manifold:</strong> (M, ω) where ω is a closed, non-degenerate 2-form.</p>

<p><strong>Canonical coordinates:</strong> ω = Σᵢ dpᵢ ∧ dqᵢ</p>

<p><strong>Darboux’s theorem:</strong> All symplectic manifolds locally look the same.</p>

<h3 id="fiber-bundles-and-gauge-theory">Fiber Bundles and Gauge Theory</h3>

<p><strong>Configuration space:</strong> Q (base manifold)
<strong>Phase space:</strong> T*Q (cotangent bundle)
<strong>Lagrangian mechanics:</strong> On TQ (tangent bundle)</p>

<p><strong>Connection 1-form:</strong> Describes parallel transport
<strong>Curvature 2-form:</strong> F = dA + A ∧ A</p>

<h3 id="geometric-phases">Geometric Phases</h3>

<p><strong>Berry phase:</strong> For cyclic evolution:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>γ = i∮ ⟨ψ|∇_R|ψ⟩ · dR
</code></pre></div></div>

<p><strong>Hannay angle:</strong> Classical analog of Berry phase
<strong>Foucault pendulum:</strong> Example of geometric phase</p>

<h2 id="modern-applications">Modern Applications</h2>

<h3 id="molecular-dynamics">Molecular Dynamics</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">verlet_integration</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Velocity Verlet algorithm for MD simulation</span><span class="sh">"""</span>
    <span class="c1"># Update positions
</span>    <span class="n">positions</span> <span class="o">+=</span> <span class="n">velocities</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">forces</span><span class="o">/</span><span class="n">mass</span> <span class="o">*</span> <span class="n">dt</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="c1"># Calculate new forces
</span>    <span class="n">forces_new</span> <span class="o">=</span> <span class="nf">calculate_forces</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    
    <span class="c1"># Update velocities
</span>    <span class="n">velocities</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">forces</span> <span class="o">+</span> <span class="n">forces_new</span><span class="p">)</span><span class="o">/</span><span class="n">mass</span> <span class="o">*</span> <span class="n">dt</span>
    
    <span class="k">return</span> <span class="n">positions</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces_new</span>
</code></pre></div></div>

<h3 id="celestial-mechanics">Celestial Mechanics</h3>

<p><strong>N-body problem:</strong> No general analytical solution for N ≥ 3</p>

<p><strong>Restricted three-body problem:</strong></p>
<ul>
  <li>Lagrange points (L1-L5)</li>
  <li>Stable (L4, L5) and unstable (L1-L3) equilibria</li>
  <li>Applications: space mission design</li>
</ul>

<h3 id="plasma-physics">Plasma Physics</h3>

<p><strong>Vlasov equation:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>∂f/∂t + v·∇_x f + (q/m)(E + v×B)·∇_v f = 0
</code></pre></div></div>

<p><strong>Kinetic theory:</strong> Bridge between particle and fluid descriptions</p>

<h2 id="computational-methods">Computational Methods</h2>

<h3 id="symplectic-integrators">Symplectic Integrators</h3>

<p>Preserve phase space structure:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">symplectic_euler</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">First-order symplectic integrator</span><span class="sh">"""</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="nf">grad_q</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">q_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="nf">grad_p</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p_new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_new</span>

<span class="k">def</span> <span class="nf">stormer_verlet</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Second-order symplectic integrator</span><span class="sh">"""</span>
    <span class="n">p_half</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span> <span class="o">*</span> <span class="nf">grad_q</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">q_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="nf">grad_p</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p_half</span><span class="p">)</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">p_half</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span> <span class="o">*</span> <span class="nf">grad_q</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_half</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_new</span>
</code></pre></div></div>

<h3 id="variational-integrators">Variational Integrators</h3>

<p>Discretize the action principle:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S_d = Σₖ L_d(qₖ, qₖ₊₁, h)
</code></pre></div></div>

<p><strong>Discrete Euler-Lagrange equations:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D₂L_d(qₖ₋₁, qₖ) + D₁L_d(qₖ, qₖ₊₁) = 0
</code></pre></div></div>

<h2 id="research-frontiers">Research Frontiers</h2>

<h3 id="quantum-classical-correspondence">Quantum-Classical Correspondence</h3>

<p><strong>Ehrenfest theorem:</strong> ⟨x⟩ satisfies classical equations
<strong>WKB approximation:</strong> Semi-classical limit
<strong>Coherent states:</strong> Minimal uncertainty wave packets</p>

<h3 id="integrability-and-solitons">Integrability and Solitons</h3>

<p><strong>Lax pairs:</strong> L̇ = [L, M]
<strong>Inverse scattering:</strong> Solve nonlinear PDEs
<strong>Toda lattice:</strong> Exactly solvable many-body system</p>

<h3 id="topological-mechanics">Topological Mechanics</h3>

<p><strong>Topological invariants:</strong> Chern numbers, winding numbers
<strong>Edge states:</strong> Protected by topology
<strong>Applications:</strong> Mechanical metamaterials</p>

<h3 id="machine-learning-in-classical-mechanics">Machine Learning in Classical Mechanics</h3>

<p><strong>Neural ODEs:</strong> Learn dynamics from data
<strong>Hamiltonian neural networks:</strong> Preserve conservation laws
<strong>Physics-informed neural networks:</strong> Incorporate physical constraints</p>

<h2 id="advanced-mathematical-tools">Advanced Mathematical Tools</h2>

<h3 id="differential-geometry">Differential Geometry</h3>

<p><strong>Tangent bundle:</strong> TM = ∪ₓ TₓM
<strong>Cotangent bundle:</strong> T<em>M = ∪ₓ T</em>ₓM
<strong>Lie derivatives:</strong> ℒ_X Y = [X, Y]</p>

<h3 id="lie-groups-and-algebras">Lie Groups and Algebras</h3>

<p><strong>Momentum map:</strong> J: M → g*
<strong>Coadjoint orbits:</strong> Symplectic manifolds
<strong>Reduction:</strong> Quotient by symmetry group</p>

<h3 id="category-theory">Category Theory</h3>

<p><strong>Classical mechanics as functor:</strong></p>
<ul>
  <li>Objects: Configuration spaces</li>
  <li>Morphisms: Canonical transformations</li>
  <li>Composition: Sequential transformations</li>
</ul>

<h2 id="references-and-further-reading">References and Further Reading</h2>

<h3 id="graduate-textbooks">Graduate Textbooks</h3>
<ol>
  <li><strong>Goldstein, Poole &amp; Safko</strong> - <em>Classical Mechanics</em> (3rd Edition)</li>
  <li><strong>Arnold</strong> - <em>Mathematical Methods of Classical Mechanics</em></li>
  <li><strong>Landau &amp; Lifshitz</strong> - <em>Mechanics</em> (Course of Theoretical Physics Vol. 1)</li>
  <li><strong>José &amp; Saletan</strong> - <em>Classical Dynamics: A Contemporary Approach</em></li>
</ol>

<h3 id="research-monographs">Research Monographs</h3>
<ol>
  <li><strong>Marsden &amp; Ratiu</strong> - <em>Introduction to Mechanics and Symmetry</em></li>
  <li><strong>Abraham &amp; Marsden</strong> - <em>Foundations of Mechanics</em></li>
  <li><strong>Ott</strong> - <em>Chaos in Dynamical Systems</em></li>
  <li><strong>Tabor</strong> - <em>Chaos and Integrability in Nonlinear Dynamics</em></li>
</ol>

<h3 id="recent-research-directions">Recent Research Directions</h3>
<ol>
  <li><strong>Geometric Mechanics:</strong> Port-Hamiltonian systems, discrete mechanics</li>
  <li><strong>Quantum-Classical Hybrid Systems:</strong> Decoherence, measurement</li>
  <li><strong>Machine Learning:</strong> Data-driven discovery of conservation laws</li>
  <li><strong>Topological Mechanics:</strong> Mechanical metamaterials, protected states</li>
  <li><strong>Stochastic Mechanics:</strong> Noise-induced phenomena, large deviations</li>
</ol>

<h2 id="applications">Applications</h2>

<h3 id="engineering-applications">Engineering Applications</h3>
<ul>
  <li><strong>Bridge Design:</strong> Using statics to calculate load distributions</li>
  <li><strong>Vehicle Dynamics:</strong> Analyzing forces during acceleration and turning</li>
  <li><strong>Machinery:</strong> Designing gears, pulleys, and mechanical systems</li>
</ul>

<h3 id="everyday-examples">Everyday Examples</h3>
<ul>
  <li><strong>Sports:</strong> Trajectory of a basketball, golf ball, or baseball</li>
  <li><strong>Transportation:</strong> Car acceleration, braking distances</li>
  <li><strong>Amusement Parks:</strong> Forces experienced on roller coasters</li>
</ul>

<h3 id="astronomical-applications">Astronomical Applications</h3>
<ul>
  <li><strong>Satellite Orbits:</strong> Calculating orbital parameters</li>
  <li><strong>Planetary Motion:</strong> Predicting positions of planets</li>
  <li><strong>Space Missions:</strong> Trajectory planning for spacecraft</li>
</ul>

<h2 id="limitations-of-classical-mechanics">Limitations of Classical Mechanics</h2>

<p>Classical mechanics breaks down in several regimes:</p>

<ol>
  <li><strong>High Speeds:</strong> When velocities approach the speed of light, relativistic effects become important</li>
  <li><strong>Small Scales:</strong> At atomic and subatomic scales, quantum mechanical effects dominate</li>
  <li><strong>Strong Gravitational Fields:</strong> Near massive objects like black holes, general relativity is needed</li>
  <li><strong>Extreme Precision:</strong> GPS satellites require relativistic corrections for accurate positioning</li>
</ol>

<h2 id="advanced-code-examples">Advanced Code Examples</h2>

<h3 id="double-pendulum-chaos-visualization">Double Pendulum Chaos Visualization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="k">def</span> <span class="nf">double_pendulum_derivatives</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Compute derivatives for double pendulum using Lagrangian mechanics</span><span class="sh">"""</span>
    <span class="n">theta1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">state</span>
    
    <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span> <span class="o">-</span> <span class="n">theta2</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta1</span> <span class="o">-</span> <span class="n">theta2</span><span class="p">)</span>
    
    <span class="n">den1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">l1</span> <span class="o">-</span> <span class="n">m2</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span>
    <span class="n">den2</span> <span class="o">=</span> <span class="p">(</span><span class="n">l2</span><span class="o">/</span><span class="n">l1</span><span class="p">)</span><span class="o">*</span><span class="n">den1</span>
    
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    
    <span class="n">dydt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">z1</span>  <span class="c1"># dtheta1/dt
</span>    <span class="n">dydt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">z2</span>  <span class="c1"># dtheta2/dt
</span>    
    <span class="c1"># Lagrangian dynamics
</span>    <span class="n">num1</span> <span class="o">=</span> <span class="o">-</span><span class="n">m2</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="n">m2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> \
           <span class="n">m2</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>
    <span class="n">dydt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">num1</span><span class="o">/</span><span class="n">den1</span>
    
    <span class="n">num2</span> <span class="o">=</span> <span class="o">-</span><span class="n">m2</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> \
           <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="p">(</span><span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
    <span class="n">dydt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">num2</span><span class="o">/</span><span class="n">den2</span>
    
    <span class="k">return</span> <span class="n">dydt</span>

<span class="c1"># Parameters
</span><span class="n">m1</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>

<span class="c1"># Initial conditions - small perturbation shows chaos
</span><span class="n">theta1_0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">theta2_0</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">z1_0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">z2_0</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Solve for two slightly different initial conditions
</span><span class="n">state0_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta1_0</span><span class="p">,</span> <span class="n">z1_0</span><span class="p">,</span> <span class="n">theta2_0</span><span class="p">,</span> <span class="n">z2_0</span><span class="p">]</span>
<span class="n">state0_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta1_0</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">z1_0</span><span class="p">,</span> <span class="n">theta2_0</span><span class="p">,</span> <span class="n">z2_0</span><span class="p">]</span>  <span class="c1"># Small perturbation
</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">t_span</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

<span class="n">sol1</span> <span class="o">=</span> <span class="nf">solve_ivp</span><span class="p">(</span><span class="n">double_pendulum_derivatives</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">state0_1</span><span class="p">,</span> 
                 <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span> 
                 <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">DOP853</span><span class="sh">'</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

<span class="n">sol2</span> <span class="o">=</span> <span class="nf">solve_ivp</span><span class="p">(</span><span class="n">double_pendulum_derivatives</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">state0_2</span><span class="p">,</span> 
                 <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span> 
                 <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">DOP853</span><span class="sh">'</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

<span class="c1"># Plot phase space and divergence
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Phase space trajectories
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Original</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">sol2</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol2</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Perturbed</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\theta_1$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\dot{\theta}_1$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Phase Space: Pendulum 1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Poincaré section
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Sample when theta2 crosses zero with positive velocity
</span><span class="n">crossings</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">diff</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">crossings</span><span class="p">],</span> <span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">crossings</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\theta_1$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\dot{\theta}_1$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Poincaré Section</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Lyapunov exponent estimation
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">divergence</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">((</span><span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">sol2</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> 
                    <span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sol2</span><span class="p">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">log_divergence</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">divergence</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">semilogy</span><span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">t</span><span class="p">,</span> <span class="n">divergence</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time (s)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Phase Space Distance</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Sensitive Dependence on Initial Conditions</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Energy conservation check
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Calculate total energy
</span><span class="n">theta1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">.</span><span class="n">y</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span> <span class="o">-</span> <span class="n">theta2</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m1</span><span class="o">*</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">z1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m2</span><span class="o">*</span><span class="p">((</span><span class="n">l1</span><span class="o">*</span><span class="n">z1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">l2</span><span class="o">*</span><span class="n">z2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> 
    <span class="mi">2</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">m1</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">l1</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">l2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">))</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">sol1</span><span class="p">.</span><span class="n">t</span><span class="p">,</span> <span class="n">E</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="sh">'</span><span class="s">g-</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time (s)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Error</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Conservation</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># Estimate Lyapunov exponent
</span><span class="kn">from</span> <span class="n">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="c1"># Linear fit to log divergence in growth region
</span><span class="n">t_fit</span> <span class="o">=</span> <span class="n">sol1</span><span class="p">.</span><span class="n">t</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>  <span class="c1"># Avoid initial transient and saturation
</span><span class="n">log_div_fit</span> <span class="o">=</span> <span class="n">log_divergence</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="nf">linregress</span><span class="p">(</span><span class="n">t_fit</span><span class="p">,</span> <span class="n">log_div_fit</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Estimated Lyapunov exponent: </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> s^-1</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">R-squared: </span><span class="si">{</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="symplectic-integration-comparison">Symplectic Integration Comparison</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hamiltonian_pendulum</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Hamiltonian for simple pendulum</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">euler_step</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Standard Euler method (not symplectic)</span><span class="sh">"""</span>
    <span class="n">dH_dq</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">dH_dp</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    
    <span class="n">q_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dp</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dq</span>
    <span class="k">return</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_new</span>

<span class="k">def</span> <span class="nf">symplectic_euler_step</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Symplectic Euler method</span><span class="sh">"""</span>
    <span class="n">dH_dq</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dq</span>
    
    <span class="n">dH_dp</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p_new</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p_new</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">q_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dp</span>
    <span class="k">return</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_new</span>

<span class="k">def</span> <span class="nf">leapfrog_step</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Leapfrog/Störmer-Verlet method</span><span class="sh">"""</span>
    <span class="n">dH_dq</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">p_half</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dq</span>
    
    <span class="n">dH_dp</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p_half</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p_half</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">q_new</span> <span class="o">=</span> <span class="n">q</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dp</span>
    
    <span class="n">dH_dq_new</span> <span class="o">=</span> <span class="p">(</span><span class="nc">H</span><span class="p">(</span><span class="n">q_new</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">p_half</span><span class="p">)</span> <span class="o">-</span> <span class="nc">H</span><span class="p">(</span><span class="n">q_new</span><span class="p">,</span> <span class="n">p_half</span><span class="p">))</span><span class="o">/</span><span class="mf">1e-8</span>
    <span class="n">p_new</span> <span class="o">=</span> <span class="n">p_half</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span> <span class="o">*</span> <span class="n">dH_dq_new</span>
    <span class="k">return</span> <span class="n">q_new</span><span class="p">,</span> <span class="n">p_new</span>

<span class="c1"># Compare integrators
</span><span class="n">q0</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span>  <span class="c1"># Large amplitude
</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Storage for trajectories
</span><span class="n">trajectories</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">Euler</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">q0</span><span class="p">],</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">p0</span><span class="p">],</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]},</span>
    <span class="sh">'</span><span class="s">Symplectic Euler</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">q0</span><span class="p">],</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">p0</span><span class="p">],</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]},</span>
    <span class="sh">'</span><span class="s">Leapfrog</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">q0</span><span class="p">],</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">p0</span><span class="p">],</span> <span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]}</span>
<span class="p">}</span>

<span class="c1"># Run simulations
</span><span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">integrator</span> <span class="ow">in</span> <span class="p">[(</span><span class="sh">'</span><span class="s">Euler</span><span class="sh">'</span><span class="p">,</span> <span class="n">euler_step</span><span class="p">),</span> 
                           <span class="p">(</span><span class="sh">'</span><span class="s">Symplectic Euler</span><span class="sh">'</span><span class="p">,</span> <span class="n">symplectic_euler_step</span><span class="p">),</span>
                           <span class="p">(</span><span class="sh">'</span><span class="s">Leapfrog</span><span class="sh">'</span><span class="p">,</span> <span class="n">leapfrog_step</span><span class="p">)]:</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">integrator</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">hamiltonian_pendulum</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="nf">hamiltonian_pendulum</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

<span class="c1"># Plot results
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Phase space
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[(</span><span class="sh">'</span><span class="s">Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">),</span> <span class="p">(</span><span class="sh">'</span><span class="s">Symplectic Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">g-</span><span class="sh">'</span><span class="p">),</span> 
                     <span class="p">(</span><span class="sh">'</span><span class="s">Leapfrog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">)]:</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">],</span> <span class="n">traj</span><span class="p">[</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">],</span> <span class="n">style</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\theta$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$p_\theta$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Phase Space Trajectories</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Energy conservation
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">E0</span> <span class="o">=</span> <span class="nf">hamiltonian_pendulum</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[(</span><span class="sh">'</span><span class="s">Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">),</span> <span class="p">(</span><span class="sh">'</span><span class="s">Symplectic Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">g-</span><span class="sh">'</span><span class="p">),</span> 
                     <span class="p">(</span><span class="sh">'</span><span class="s">Leapfrog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">)]:</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">E0</span><span class="p">]</span> <span class="o">+</span> <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">][</span><span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">E</span> <span class="o">-</span> <span class="n">E0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-16</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Error</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Conservation</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Phase space area preservation
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="p">[(</span><span class="sh">'</span><span class="s">Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">),</span> <span class="p">(</span><span class="sh">'</span><span class="s">Symplectic Euler</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">),</span> 
                     <span class="p">(</span><span class="sh">'</span><span class="s">Leapfrog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">)]:</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">trajectories</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
    <span class="c1"># Sample points in phase space
</span>    <span class="n">q_vals</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">][::</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">p_vals</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">][::</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">q_vals</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">p_vals</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> 
              <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s"> (early)</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">q_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">p_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> 
              <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s"> (late)</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$\theta$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$p_\theta$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Phase Space Volume Preservation</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper left</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="simulating-projectile-motion-with-python">Simulating Projectile Motion with Python</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="k">def</span> <span class="nf">projectile_motion</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Simulate projectile motion</span><span class="sh">"""</span>
    <span class="c1"># Convert angle to radians
</span>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    
    <span class="c1"># Initial conditions
</span>    <span class="n">vx</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">vy</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    
    <span class="c1"># Lists to store trajectory
</span>    <span class="n">x_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">t_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Simulate until projectile hits ground
</span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">vx</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">vy</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">vy</span> <span class="o">-=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">dt</span>
        
        <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
            
        <span class="n">x_vals</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y_vals</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">t_vals</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">x_vals</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">t_vals</span><span class="p">)</span>

<span class="c1"># Create visualization
</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Plot trajectory for different angles
</span><span class="n">angles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">75</span><span class="p">]</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Initial velocity (m/s)
</span>
<span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="nf">projectile_motion</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s">°</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="c1"># Calculate range and max height
</span>    <span class="n">range_val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">max_height</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Angle: </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s">°, Range: </span><span class="si">{</span><span class="n">range_val</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">m, Max Height: </span><span class="si">{</span><span class="n">max_height</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">m</span><span class="sh">"</span><span class="p">)</span>

<span class="n">ax1</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Distance (m)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Height (m)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Projectile Motion for Different Launch Angles</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Energy conservation demonstration
</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="nf">projectile_motion</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">vx</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">radians</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
<span class="n">vy_initial</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">radians</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
<span class="n">vy</span> <span class="o">=</span> <span class="n">vy_initial</span> <span class="o">-</span> <span class="mf">9.81</span> <span class="o">*</span> <span class="n">t</span>

<span class="c1"># Calculate energies
</span><span class="n">mass</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># kg
</span><span class="n">KE</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">PE</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">*</span> <span class="mf">9.81</span> <span class="o">*</span> <span class="n">y</span>
<span class="n">TE</span> <span class="o">=</span> <span class="n">KE</span> <span class="o">+</span> <span class="n">PE</span>

<span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">KE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Kinetic Energy</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">PE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Potential Energy</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Total Energy</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time (s)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy (J)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Energy Conservation in Projectile Motion</span><span class="sh">'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<details>
<summary><b>Expected Output</b></summary>
<br />
The code produces two plots:
<ol>
<li>Left plot shows parabolic trajectories for different launch angles (30°, 45°, 60°, 75°)</li>
<li>Right plot demonstrates energy conservation with constant total energy throughout the motion</li>
</ol>
Console output shows range and maximum height for each angle.
</details>

<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/git.svg" class="icon" /><a href="https://github.com/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/04.08-Multiple-Subplots.ipynb"> Tutorial: <b><i>Advanced Matplotlib Plotting Techniques</i></b></a></p>

<h2 id="problem-solving-strategies">Problem-Solving Strategies</h2>

<details>
<summary><b>Interactive Problem-Solving Flowchart</b></summary>
<br />

```mermaid
flowchart TD
    A[Start: Physics Problem] --&gt; B{Identify System}
    B --&gt; C[List Known Variables]
    C --&gt; D[List Unknown Variables]
    D --&gt; E{Choose Method}
    
    E --&gt;|Forces| F[Draw Free Body Diagram]
    E --&gt;|Energy| G[Identify Energy Types]
    E --&gt;|Momentum| H[Check if Isolated System]
    
    F --&gt; I[Apply Newton's Laws]
    G --&gt; J[Apply Conservation of Energy]
    H --&gt; K[Apply Conservation of Momentum]
    
    I --&gt; L[Solve Equations]
    J --&gt; L
    K --&gt; L
    
    L --&gt; M{Check Units}
    M --&gt;|Wrong| N[Fix Unit Errors]
    N --&gt; L
    M --&gt;|Correct| O{Is Answer Reasonable?}
    
    O --&gt;|No| P[Review Assumptions]
    P --&gt; B
    O --&gt;|Yes| Q[Solution Complete!]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style Q fill:#9f9,stroke:#333,stroke-width:2px
```

</details>

<ol>
  <li><strong>Identify the System:</strong> Clearly define what objects are involved</li>
  <li><strong>Draw Diagrams:</strong> Free body diagrams for forces, motion diagrams for kinematics</li>
  <li><strong>Choose Coordinate System:</strong> Select axes that simplify the problem</li>
  <li><strong>List Known/Unknown:</strong> Organize given information and what needs to be found</li>
  <li><strong>Select Appropriate Equations:</strong> Use conservation laws when applicable</li>
  <li><strong>Check Units:</strong> Ensure dimensional consistency</li>
  <li><strong>Verify Reasonableness:</strong> Does the answer make physical sense?</li>
</ol>

<h2 id="historical-context">Historical Context</h2>

<p>Classical mechanics was developed over centuries:</p>
<ul>
  <li><strong>Galileo Galilei (1564-1642):</strong> Studied motion and inertia</li>
  <li><strong>Isaac Newton (1643-1727):</strong> Formulated the laws of motion and gravitation</li>
  <li><strong>Leonhard Euler (1707-1783):</strong> Developed analytical mechanics</li>
  <li><strong>Joseph-Louis Lagrange (1736-1813):</strong> Created Lagrangian mechanics</li>
  <li><strong>William Rowan Hamilton (1805-1865):</strong> Developed Hamiltonian mechanics</li>
</ul>

<p>These developments laid the foundation for modern physics and engineering.</p>

<hr />

<h2 id="essential-resources">Essential Resources</h2>

<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /><a href="https://www.feynmanlectures.caltech.edu/I_toc.html"> Book: <b><i>The Feynman Lectures on Physics, Volume I</i></b></a></p>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/file-text-fill.svg" class="icon" /><a href="https://ocw.mit.edu/courses/physics/8-01sc-classical-mechanics-fall-2016/"> Course: <b><i>MIT 8.01 Classical Mechanics</i></b></a></p>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/play-btn-fill.svg" class="icon" /><a href="https://www.youtube.com/playlist?list=PLyQSN7X0ro203puVhQsmCj9qhlFQ-As8e"> Video Series: <b><i>Classical Mechanics - Walter Lewin</i></b></a></p>
<p class="referenceBoxes type3"><img src="https://andrewaltimit.github.io/Documentation/images/git.svg" class="icon" /><a href="https://github.com/sympy/sympy"> Library: <b><i>SymPy - Symbolic Mathematics in Python</i></b></a></p>

<hr />

<h2 id="see-also">See Also</h2>
<ul>
  <li><a href="thermodynamics.html">Thermodynamics</a> - Energy and heat in mechanical systems</li>
  <li><a href="statistical-mechanics.html">Statistical Mechanics</a> - From microscopic to macroscopic</li>
  <li><a href="relativity.html">Relativity</a> - Extensions at high velocities</li>
  <li><a href="quantum-mechanics.html">Quantum Mechanics</a> - Behavior at small scales</li>
  <li><a href="condensed-matter.html">Condensed Matter Physics</a> - Applications to materials</li>
</ul>
