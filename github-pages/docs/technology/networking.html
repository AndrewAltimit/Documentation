<h1 id="networking">Networking</h1>

<html><header><link rel="stylesheet" href="https://andrewaltimit.github.io/Documentation/style.css" /></header></html>

<p>Computer networking is the practice of connecting computers and devices to share resources and communicate. Understanding networking fundamentals is essential for system administration, security, and modern application development.</p>

<h2 id="mathematical-foundations-of-networking">Mathematical Foundations of Networking</h2>

<h3 id="queueing-theory">Queueing Theory</h3>

<h4 id="mm1-queue-analysis">M/M/1 Queue Analysis</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">class</span> <span class="nc">MM1Queue</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">M/M/1 queueing model for network performance analysis</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arrival_rate</span><span class="p">,</span> <span class="n">service_rate</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">lambda_</span> <span class="o">=</span> <span class="n">arrival_rate</span>  <span class="c1"># λ
</span>        <span class="n">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">service_rate</span>       <span class="c1"># μ
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">arrival_rate</span> <span class="o">/</span> <span class="n">service_rate</span>  <span class="c1"># ρ = λ/μ
</span>        
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">System is unstable (ρ &gt;= 1)</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">average_customers</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">L = ρ / (1 - ρ)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">average_queue_length</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Lq = ρ² / (1 - ρ)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">average_waiting_time</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">W = 1 / (μ - λ)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">lambda_</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">average_queue_time</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Wq = ρ / (μ - λ)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">rho</span> <span class="o">/</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">lambda_</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">response_time_distribution</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">P(T ≤ t) = 1 - e^(-(μ-λ)t)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">lambda_</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Discrete event simulation</span><span class="sh">"""</span>
        <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">customers_in_system</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="c1"># Next arrival
</span>            <span class="n">inter_arrival</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">exponential</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">lambda_</span><span class="p">)</span>
            <span class="n">arrival_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">inter_arrival</span>
            
            <span class="c1"># Service time
</span>            <span class="n">service_time</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">exponential</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">mu</span><span class="p">)</span>
            
            <span class="n">events</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">:</span> <span class="n">arrival_time</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">arrival</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">service_time</span><span class="sh">'</span><span class="p">:</span> <span class="n">service_time</span>
            <span class="p">})</span>
            
            <span class="n">current_time</span> <span class="o">=</span> <span class="n">arrival_time</span>
            
        <span class="k">return</span> <span class="n">events</span>

<span class="c1"># Example: Router buffer analysis
</span><span class="n">router</span> <span class="o">=</span> <span class="nc">MM1Queue</span><span class="p">(</span><span class="n">arrival_rate</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">service_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># packets/second
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Average queue length: </span><span class="si">{</span><span class="n">router</span><span class="p">.</span><span class="nf">average_queue_length</span><span class="p">()</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> packets</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Average waiting time: </span><span class="si">{</span><span class="n">router</span><span class="p">.</span><span class="nf">average_queue_time</span><span class="p">()</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> ms</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="network-of-queues-jackson-network">Network of Queues (Jackson Network)</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">JacksonNetwork</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Open Jackson network for multi-hop analysis</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="n">num_nodes</span>
        <span class="n">self</span><span class="p">.</span><span class="n">routing_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">))</span>
        <span class="n">self</span><span class="p">.</span><span class="n">external_arrivals</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">service_rates</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">set_routing</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">,</span> <span class="n">probability</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Set routing probability between nodes</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">routing_matrix</span><span class="p">[</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">]</span> <span class="o">=</span> <span class="n">probability</span>
        
    <span class="k">def</span> <span class="nf">solve_traffic_equations</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Solve λᵢ = γᵢ + Σⱼ λⱼ * Pⱼᵢ</span><span class="sh">"""</span>
        <span class="c1"># Form system: (I - P^T)λ = γ
</span>        <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">eye</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">num_nodes</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">I</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">routing_matrix</span><span class="p">.</span><span class="n">T</span>
        
        <span class="c1"># Solve for arrival rates at each node
</span>        <span class="n">arrival_rates</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">external_arrivals</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">arrival_rates</span>
    
    <span class="k">def</span> <span class="nf">analyze_performance</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Analyze performance metrics for each node</span><span class="sh">"""</span>
        <span class="n">arrival_rates</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">solve_traffic_equations</span><span class="p">()</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">num_nodes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">arrival_rates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">service_rates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">queue</span> <span class="o">=</span> <span class="nc">MM1Queue</span><span class="p">(</span><span class="n">arrival_rates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">service_rates</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">metrics</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">'</span><span class="s">node</span><span class="sh">'</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">utilization</span><span class="sh">'</span><span class="p">:</span> <span class="n">queue</span><span class="p">.</span><span class="n">rho</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">avg_delay</span><span class="sh">'</span><span class="p">:</span> <span class="n">queue</span><span class="p">.</span><span class="nf">average_waiting_time</span><span class="p">(),</span>
                    <span class="sh">'</span><span class="s">avg_queue</span><span class="sh">'</span><span class="p">:</span> <span class="n">queue</span><span class="p">.</span><span class="nf">average_customers</span><span class="p">()</span>
                <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">metrics</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">'</span><span class="s">node</span><span class="sh">'</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">utilization</span><span class="sh">'</span><span class="p">:</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">),</span>
                    <span class="sh">'</span><span class="s">avg_delay</span><span class="sh">'</span><span class="p">:</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">),</span>
                    <span class="sh">'</span><span class="s">avg_queue</span><span class="sh">'</span><span class="p">:</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
                <span class="p">})</span>
                
        <span class="k">return</span> <span class="n">metrics</span>
</code></pre></div></div>

<h3 id="graph-theory-for-networks">Graph Theory for Networks</h3>

<h4 id="shortest-path-algorithms">Shortest Path Algorithms</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">heapq</span>
<span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">NetworkGraph</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Advanced graph algorithms for network routing</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">graph</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">add_edge</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Add edge with weight and optional metrics</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
            <span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">:</span> <span class="n">weight</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">:</span> <span class="n">metrics</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="p">})</span>
        <span class="n">self</span><span class="p">.</span><span class="n">vertices</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">vertices</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">dijkstra_multi_metric</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Dijkstra with configurable metric</span><span class="sh">"""</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">{</span><span class="n">vertex</span><span class="p">:</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">infinity</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">vertices</span><span class="p">}</span>
        <span class="n">distances</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">predecessors</span> <span class="o">=</span> <span class="p">{</span><span class="n">vertex</span><span class="p">:</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">vertices</span><span class="p">}</span>
        
        <span class="n">pq</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source</span><span class="p">)]</span>
        
        <span class="k">while</span> <span class="n">pq</span><span class="p">:</span>
            <span class="n">current_distance</span><span class="p">,</span> <span class="n">current_vertex</span> <span class="o">=</span> <span class="n">heapq</span><span class="p">.</span><span class="nf">heappop</span><span class="p">(</span><span class="n">pq</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">current_distance</span> <span class="o">&gt;</span> <span class="n">distances</span><span class="p">[</span><span class="n">current_vertex</span><span class="p">]:</span>
                <span class="k">continue</span>
                
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">current_vertex</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">:</span>
                    <span class="n">edge_weight</span> <span class="o">=</span> <span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edge_weight</span> <span class="o">=</span> <span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">].</span><span class="nf">get</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">))</span>
                    
                <span class="n">distance</span> <span class="o">=</span> <span class="n">current_distance</span> <span class="o">+</span> <span class="n">edge_weight</span>
                
                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">]]:</span>
                    <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">distance</span>
                    <span class="n">predecessors</span><span class="p">[</span><span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">current_vertex</span>
                    <span class="n">heapq</span><span class="p">.</span><span class="nf">heappush</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span> <span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">[</span><span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">]))</span>
                    
        <span class="k">return</span> <span class="n">distances</span><span class="p">,</span> <span class="n">predecessors</span>
    
    <span class="k">def</span> <span class="nf">k_shortest_paths</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Yen</span><span class="sh">'</span><span class="s">s algorithm for k-shortest paths</span><span class="sh">"""</span>
        <span class="c1"># First shortest path
</span>        <span class="n">distances</span><span class="p">,</span> <span class="n">predecessors</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">dijkstra_multi_metric</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">distances</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">==</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">infinity</span><span class="sh">'</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
            
        <span class="c1"># Reconstruct first path
</span>        <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="nf">_reconstruct_path</span><span class="p">(</span><span class="n">predecessors</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)]</span>
        <span class="n">B</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">k_iter</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k_iter</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">spur_node</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">k_iter</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">root_path</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">k_iter</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="c1"># Remove edges used in previous paths
</span>                <span class="n">removed_edges</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">path</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">root_path</span><span class="p">:</span>
                        <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                        <span class="c1"># Temporarily remove edge
</span>                        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="sh">'</span><span class="s">vertex</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
                                <span class="n">removed_edges</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">edge</span><span class="p">))</span>
                                
                <span class="c1"># Find spur path
</span>                <span class="n">spur_distances</span><span class="p">,</span> <span class="n">spur_pred</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">dijkstra_multi_metric</span><span class="p">(</span><span class="n">spur_node</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">spur_distances</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">infinity</span><span class="sh">'</span><span class="p">):</span>
                    <span class="n">spur_path</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_reconstruct_path</span><span class="p">(</span><span class="n">spur_pred</span><span class="p">,</span> <span class="n">spur_node</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
                    <span class="n">total_path</span> <span class="o">=</span> <span class="n">root_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">spur_path</span>
                    
                    <span class="k">if</span> <span class="n">total_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">B</span><span class="p">:</span>
                        <span class="n">B</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">total_path</span><span class="p">)</span>
                        
                <span class="c1"># Restore edges
</span>                <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">removed_edges</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="nf">insert</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">edge</span><span class="p">)</span>
                    
            <span class="k">if</span> <span class="ow">not</span> <span class="n">B</span><span class="p">:</span>
                <span class="k">break</span>
                
            <span class="c1"># Sort B by path cost
</span>            <span class="n">B</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_path_cost</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="n">A</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">A</span>
</code></pre></div></div>

<h3 id="network-flow-algorithms">Network Flow Algorithms</h3>

<h4 id="maximum-flow-implementation">Maximum Flow Implementation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MaxFlow</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Ford-Fulkerson with Edmonds-Karp implementation</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="n">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">BFS to find augmenting path</span><span class="sh">"""</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">n</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
                    <span class="n">queue</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">sink</span><span class="p">:</span>
                        <span class="k">return</span> <span class="bp">True</span>
                        
        <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">max_flow</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Find maximum flow from source to sink</span><span class="sh">"""</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">n</span>
        <span class="n">max_flow_value</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Create residual graph
</span>        <span class="n">residual</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">)]</span> 
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">)]</span>
        
        <span class="k">while</span> <span class="n">self</span><span class="p">.</span><span class="nf">bfs</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
            <span class="c1"># Find minimum residual capacity
</span>            <span class="n">path_flow</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sink</span>
            
            <span class="k">while</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">source</span><span class="p">:</span>
                <span class="n">path_flow</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">path_flow</span><span class="p">,</span> <span class="n">residual</span><span class="p">[</span><span class="n">parent</span><span class="p">[</span><span class="n">s</span><span class="p">]][</span><span class="n">s</span><span class="p">])</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
                
            <span class="c1"># Update residual capacities
</span>            <span class="n">v</span> <span class="o">=</span> <span class="n">sink</span>
            <span class="k">while</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">source</span><span class="p">:</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                <span class="n">residual</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">-=</span> <span class="n">path_flow</span>
                <span class="n">residual</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">path_flow</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                
            <span class="n">max_flow_value</span> <span class="o">+=</span> <span class="n">path_flow</span>
            
        <span class="k">return</span> <span class="n">max_flow_value</span><span class="p">,</span> <span class="n">residual</span>
    
    <span class="k">def</span> <span class="nf">min_cut</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">residual</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Find minimum cut after max flow</span><span class="sh">"""</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">n</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="ow">and</span> <span class="n">residual</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">queue</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    
        <span class="c1"># Find edges in cut
</span>        <span class="n">cut_edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">cut_edges</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                    
        <span class="k">return</span> <span class="n">cut_edges</span>
</code></pre></div></div>

<h2 id="osi-model">OSI Model</h2>

<p>The Open Systems Interconnection model conceptualizes network communication in seven layers:</p>

<h3 id="layer-7-application">Layer 7: Application</h3>
<p>User-facing protocols and services.</p>
<ul>
  <li>HTTP/HTTPS</li>
  <li>FTP</li>
  <li>SMTP</li>
  <li>DNS</li>
  <li>SSH</li>
</ul>

<h3 id="layer-6-presentation">Layer 6: Presentation</h3>
<p>Data formatting, encryption, compression.</p>
<ul>
  <li>SSL/TLS</li>
  <li>JPEG, GIF</li>
  <li>ASCII, Unicode</li>
</ul>

<h3 id="layer-5-session">Layer 5: Session</h3>
<p>Establishes, manages, and terminates connections.</p>
<ul>
  <li>SQL</li>
  <li>RPC</li>
  <li>NetBIOS</li>
</ul>

<h3 id="layer-4-transport">Layer 4: Transport</h3>
<p>Reliable data transfer and error recovery.</p>
<ul>
  <li>TCP (Transmission Control Protocol)</li>
  <li>UDP (User Datagram Protocol)</li>
  <li>Port numbers</li>
</ul>

<h3 id="layer-3-network">Layer 3: Network</h3>
<p>Routing and logical addressing.</p>
<ul>
  <li>IP (Internet Protocol)</li>
  <li>ICMP</li>
  <li>Routing protocols (OSPF, BGP)</li>
</ul>

<h3 id="layer-2-data-link">Layer 2: Data Link</h3>
<p>Node-to-node delivery, error detection.</p>
<ul>
  <li>Ethernet</li>
  <li>MAC addresses</li>
  <li>Switches</li>
  <li>ARP</li>
</ul>

<h3 id="layer-1-physical">Layer 1: Physical</h3>
<p>Bits over physical medium.</p>
<ul>
  <li>Cables, fiber optics</li>
  <li>Hubs</li>
  <li>Signal encoding</li>
</ul>

<h2 id="tcpip-stack">TCP/IP Stack</h2>

<p>Practical four-layer model used in modern networks:</p>

<ol>
  <li><strong>Application Layer</strong>: HTTP, FTP, SSH, DNS</li>
  <li><strong>Transport Layer</strong>: TCP, UDP</li>
  <li><strong>Internet Layer</strong>: IP, ICMP, ARP</li>
  <li><strong>Network Access Layer</strong>: Ethernet, Wi-Fi</li>
</ol>

<h2 id="ip-addressing">IP Addressing</h2>

<h3 id="ipv4">IPv4</h3>
<p>32-bit addresses, written as four octets (e.g., 192.168.1.1)</p>

<p><strong>Address Classes</strong>:</p>
<ul>
  <li>Class A: 1.0.0.0 to 126.255.255.255 (/8)</li>
  <li>Class B: 128.0.0.0 to 191.255.255.255 (/16)</li>
  <li>Class C: 192.0.0.0 to 223.255.255.255 (/24)</li>
</ul>

<p><strong>Private Address Ranges</strong>:</p>
<ul>
  <li>10.0.0.0/8</li>
  <li>172.16.0.0/12</li>
  <li>192.168.0.0/16</li>
</ul>

<h3 id="ipv6">IPv6</h3>
<p>128-bit addresses, written in hexadecimal (e.g., 2001:db8::1)</p>

<p><strong>Address Types</strong>:</p>
<ul>
  <li>Unicast: Single interface</li>
  <li>Multicast: Group of interfaces</li>
  <li>Anycast: Nearest of group</li>
</ul>

<p><strong>Special Addresses</strong>:</p>
<ul>
  <li>::1 - Loopback</li>
  <li>fe80::/10 - Link-local</li>
  <li>2000::/3 - Global unicast</li>
</ul>

<h3 id="subnetting">Subnetting</h3>
<p>Dividing networks into smaller segments.</p>

<p><strong>CIDR Notation</strong>: 192.168.1.0/24</p>
<ul>
  <li>Network: 192.168.1.0</li>
  <li>Broadcast: 192.168.1.255</li>
  <li>Usable hosts: 254</li>
</ul>

<p><strong>Subnet Calculation</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Network bits: 24
Host bits: 32 - 24 = 8
Total addresses: 2^8 = 256
Usable addresses: 256 - 2 = 254
</code></pre></div></div>

<h2 id="advanced-protocol-analysis">Advanced Protocol Analysis</h2>

<h3 id="tcp-congestion-control-algorithms">TCP Congestion Control Algorithms</h3>

<h4 id="tcp-reno-implementation">TCP Reno Implementation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TCPReno</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">TCP Reno congestion control algorithm</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">mss</span><span class="o">=</span><span class="mi">1460</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">mss</span> <span class="o">=</span> <span class="n">mss</span>  <span class="c1"># Maximum Segment Size
</span>        <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">mss</span>  <span class="c1"># Congestion window
</span>        <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># Slow start threshold
</span>        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">'</span><span class="s">slow_start</span><span class="sh">'</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rtt_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># Smoothed RTT
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rttvar</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># RTT variance
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rto</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Retransmission timeout
</span>        
    <span class="k">def</span> <span class="nf">on_ack</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ack_num</span><span class="p">,</span> <span class="n">is_duplicate</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Handle ACK reception</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">is_duplicate</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">dup_ack_count</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">dup_ack_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># Fast retransmit/recovery
</span>                <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span><span class="p">)</span>
                <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span>
                <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">'</span><span class="s">fast_recovery</span><span class="sh">'</span>
                <span class="k">return</span> <span class="sh">'</span><span class="s">fast_retransmit</span><span class="sh">'</span>
                
            <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">fast_recovery</span><span class="sh">'</span><span class="p">:</span>
                <span class="c1"># Inflate window
</span>                <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">slow_start</span><span class="sh">'</span><span class="p">:</span>
                <span class="c1"># Exponential increase
</span>                <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span>
                
                <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">'</span><span class="s">congestion_avoidance</span><span class="sh">'</span>
                    
            <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">congestion_avoidance</span><span class="sh">'</span><span class="p">:</span>
                <span class="c1"># Additive increase
</span>                <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mss</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span><span class="p">)</span> <span class="o">/</span> <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span>
                
            <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="sh">'</span><span class="s">fast_recovery</span><span class="sh">'</span><span class="p">:</span>
                <span class="c1"># Exit fast recovery
</span>                <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span>
                <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">'</span><span class="s">congestion_avoidance</span><span class="sh">'</span>
                
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">on_timeout</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Handle retransmission timeout</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="sh">'</span><span class="s">slow_start</span><span class="sh">'</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Back off RTO
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rto</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">rto</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">update_rtt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">measured_rtt</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Update RTT estimates (RFC 6298)</span><span class="sh">"""</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.125</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">K</span> <span class="o">=</span> <span class="mi">4</span>
        
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># First measurement
</span>            <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">=</span> <span class="n">measured_rtt</span>
            <span class="n">self</span><span class="p">.</span><span class="n">rttvar</span> <span class="o">=</span> <span class="n">measured_rtt</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Update estimates
</span>            <span class="n">self</span><span class="p">.</span><span class="n">rttvar</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">rttvar</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="nf">abs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">-</span> <span class="n">measured_rtt</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">measured_rtt</span>
            
        <span class="c1"># Calculate RTO
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rto</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">srtt</span> <span class="o">+</span> <span class="n">K</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">rttvar</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rto</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">rto</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Minimum 1 second
</span></code></pre></div></div>

<h4 id="tcp-bbr-bottleneck-bandwidth-and-rtt">TCP BBR (Bottleneck Bandwidth and RTT)</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TCPBBR</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Google</span><span class="sh">'</span><span class="s">s BBR congestion control</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="sh">'</span><span class="s">startup</span><span class="sh">'</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pacing_rate</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">min_rtt</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">min_rtt_stamp</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">btl_bw</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Bottleneck bandwidth
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rtprop</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Min RTT
</span>        <span class="n">self</span><span class="p">.</span><span class="n">bandwidth_samples</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">delivered</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">rtt</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Update bandwidth and RTT model</span><span class="sh">"""</span>
        <span class="c1"># Update bandwidth estimate
</span>        <span class="k">if</span> <span class="n">interval</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bandwidth</span> <span class="o">=</span> <span class="n">delivered</span> <span class="o">/</span> <span class="n">interval</span>
            <span class="n">self</span><span class="p">.</span><span class="n">bandwidth_samples</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">bandwidth</span><span class="p">)</span>
            
            <span class="c1"># Use windowed max filter
</span>            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">bandwidth_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">bandwidth_samples</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                
            <span class="n">self</span><span class="p">.</span><span class="n">btl_bw</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">bandwidth_samples</span><span class="p">)</span>
            
        <span class="c1"># Update RTT estimate
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rtprop</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">rtprop</span><span class="p">,</span> <span class="n">rtt</span><span class="p">)</span> <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">rtprop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">rtt</span>
        
    <span class="k">def</span> <span class="nf">calculate_pacing_rate</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Calculate pacing rate based on model</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">==</span> <span class="sh">'</span><span class="s">startup</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># High gain to quickly discover bandwidth
</span>            <span class="n">pacing_gain</span> <span class="o">=</span> <span class="mf">2.89</span>  <span class="c1"># 2/ln(2)
</span>        <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">==</span> <span class="sh">'</span><span class="s">drain</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># Drain queue built during startup
</span>            <span class="n">pacing_gain</span> <span class="o">=</span> <span class="mf">0.35</span>  <span class="c1"># 1/2.89
</span>        <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">==</span> <span class="sh">'</span><span class="s">probe_bw</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># Cycle through different gains
</span>            <span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">pacing_gain</span> <span class="o">=</span> <span class="n">gains</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">cycle_index</span> <span class="o">%</span> <span class="nf">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># probe_rtt
</span>            <span class="n">pacing_gain</span> <span class="o">=</span> <span class="mi">1</span>
            
        <span class="n">self</span><span class="p">.</span><span class="n">pacing_rate</span> <span class="o">=</span> <span class="n">pacing_gain</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">btl_bw</span>
        
    <span class="k">def</span> <span class="nf">update_cwnd</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Update congestion window</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">==</span> <span class="sh">'</span><span class="s">probe_rtt</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># Minimal cwnd to measure RTT
</span>            <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># BDP + headroom for probing
</span>            <span class="n">bdp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">btl_bw</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">rtprop</span>
            <span class="n">self</span><span class="p">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">bdp</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">cwnd_gain</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">mss</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="advanced-routing-protocols">Advanced Routing Protocols</h3>

<h4 id="bgp-implementation">BGP Implementation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BGPRouter</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Simplified BGP implementation</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">as_number</span><span class="p">,</span> <span class="n">router_id</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">as_number</span> <span class="o">=</span> <span class="n">as_number</span>
        <span class="n">self</span><span class="p">.</span><span class="n">router_id</span> <span class="o">=</span> <span class="n">router_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">peers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rib_in</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Received routes
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rib_loc</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Local routes
</span>        <span class="n">self</span><span class="p">.</span><span class="n">rib_out</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Advertised routes
</span>        <span class="n">self</span><span class="p">.</span><span class="n">best_paths</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Best path selection
</span>        
    <span class="k">def</span> <span class="nf">add_peer</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">peer_ip</span><span class="p">,</span> <span class="n">peer_as</span><span class="p">,</span> <span class="n">peer_type</span><span class="o">=</span><span class="sh">'</span><span class="s">ebgp</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Add BGP peer</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">peers</span><span class="p">[</span><span class="n">peer_ip</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">as_number</span><span class="sh">'</span><span class="p">:</span> <span class="n">peer_as</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="n">peer_type</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">idle</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">hold_timer</span><span class="sh">'</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">keepalive_timer</span><span class="sh">'</span><span class="p">:</span> <span class="mi">30</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">process_update</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">peer_ip</span><span class="p">,</span> <span class="n">nlri</span><span class="p">,</span> <span class="n">attributes</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Process BGP UPDATE message</span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">nlri</span><span class="p">:</span>
            <span class="n">route_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">peer_ip</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
            
            <span class="c1"># Store in RIB-In
</span>            <span class="n">self</span><span class="p">.</span><span class="n">rib_in</span><span class="p">[</span><span class="n">route_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">prefix</span><span class="sh">'</span><span class="p">:</span> <span class="n">prefix</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">peer</span><span class="sh">'</span><span class="p">:</span> <span class="n">peer_ip</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">attributes</span><span class="sh">'</span><span class="p">:</span> <span class="n">attributes</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="p">}</span>
            
        <span class="c1"># Run best path selection
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">best_path_selection</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">best_path_selection</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">BGP best path selection algorithm</span><span class="sh">"""</span>
        <span class="n">prefix_routes</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        
        <span class="c1"># Group routes by prefix
</span>        <span class="nf">for </span><span class="p">(</span><span class="n">peer</span><span class="p">,</span> <span class="n">prefix</span><span class="p">),</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">rib_in</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">prefix_routes</span><span class="p">[</span><span class="n">prefix</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">routes</span> <span class="ow">in</span> <span class="n">prefix_routes</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="c1"># Apply BGP decision process
</span>            <span class="n">best_route</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">select_best_route</span><span class="p">(</span><span class="n">routes</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">best_route</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">best_paths</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_route</span>
                
                <span class="c1"># Install in RIB-Loc if best
</span>                <span class="n">self</span><span class="p">.</span><span class="n">rib_loc</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_route</span>
                
                <span class="c1"># Advertise to other peers
</span>                <span class="n">self</span><span class="p">.</span><span class="nf">advertise_route</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">best_route</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">select_best_route</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">routes</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Apply BGP decision criteria</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">routes</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
            
        <span class="c1"># Sort by BGP decision criteria
</span>        <span class="k">def</span> <span class="nf">route_preference</span><span class="p">(</span><span class="n">route</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">route</span><span class="p">[</span><span class="sh">'</span><span class="s">attributes</span><span class="sh">'</span><span class="p">]</span>
            <span class="nf">return </span><span class="p">(</span>
                <span class="o">-</span><span class="n">attrs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">local_pref</span><span class="sh">'</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># Higher is better
</span>                <span class="nf">len</span><span class="p">(</span><span class="n">attrs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">as_path</span><span class="sh">'</span><span class="p">,</span> <span class="p">[])),</span>   <span class="c1"># Shorter is better
</span>                <span class="n">attrs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">origin</span><span class="sh">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>          <span class="c1"># Lower is better (IGP &lt; EGP &lt; Incomplete)
</span>                <span class="n">attrs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">med</span><span class="sh">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>             <span class="c1"># Lower is better
</span>                <span class="n">self</span><span class="p">.</span><span class="n">peers</span><span class="p">[</span><span class="n">route</span><span class="p">[</span><span class="sh">'</span><span class="s">peer</span><span class="sh">'</span><span class="p">]][</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">ebgp</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># Prefer eBGP
</span>                <span class="n">attrs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">next_hop</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">),</span>       <span class="c1"># Lower IP is better
</span>                <span class="n">route</span><span class="p">[</span><span class="sh">'</span><span class="s">peer</span><span class="sh">'</span><span class="p">]</span>                    <span class="c1"># Lower peer IP is better
</span>            <span class="p">)</span>
            
        <span class="k">return</span> <span class="nf">min</span><span class="p">(</span><span class="n">routes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">route_preference</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="ospf-link-state-implementation">OSPF Link State Implementation</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">OSPFRouter</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">OSPF link state routing protocol</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">router_id</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">router_id</span> <span class="o">=</span> <span class="n">router_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">lsdb</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Link State Database
</span>        <span class="n">self</span><span class="p">.</span><span class="n">neighbors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">interfaces</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">routing_table</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span> <span class="nf">generate_lsa</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Generate Router LSA</span><span class="sh">"""</span>
        <span class="n">lsa</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Router LSA
</span>            <span class="sh">'</span><span class="s">router_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">router_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">sequence</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_next_sequence</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">links</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">intf_id</span><span class="p">,</span> <span class="n">intf</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">interfaces</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="n">intf</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">],</span>  <span class="c1"># p2p, transit, stub
</span>                <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="n">intf</span><span class="p">[</span><span class="sh">'</span><span class="s">neighbor_id</span><span class="sh">'</span><span class="p">]</span> <span class="k">if</span> <span class="n">intf</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">p2p</span><span class="sh">'</span> <span class="k">else</span> <span class="n">intf_id</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="n">intf</span><span class="p">[</span><span class="sh">'</span><span class="s">ip_address</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">metric</span><span class="sh">'</span><span class="p">:</span> <span class="n">intf</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">lsa</span><span class="p">[</span><span class="sh">'</span><span class="s">links</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">lsa</span>
    
    <span class="k">def</span> <span class="nf">dijkstra_spf</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Calculate shortest paths using Dijkstra</span><span class="sh">"""</span>
        <span class="c1"># Build graph from LSDB
</span>        <span class="n">graph</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">build_topology_graph</span><span class="p">()</span>
        
        <span class="c1"># Initialize
</span>        <span class="n">distances</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">}</span>
        <span class="n">distances</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">router_id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">predecessors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">unvisited</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">graph</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span>
        
        <span class="k">while</span> <span class="n">unvisited</span><span class="p">:</span>
            <span class="c1"># Find minimum distance node
</span>            <span class="n">current</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">unvisited</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">distances</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
            <span class="n">unvisited</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">distances</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">==</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">):</span>
                <span class="k">break</span>
                
            <span class="c1"># Update neighbors
</span>            <span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">current</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">unvisited</span><span class="p">:</span>
                    <span class="n">alt_distance</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">+</span> <span class="n">cost</span>
                    
                    <span class="k">if</span> <span class="n">alt_distance</span> <span class="o">&lt;</span> <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
                        <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">alt_distance</span>
                        <span class="n">predecessors</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">current</span>
                        
        <span class="c1"># Build routing table
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">build_routing_table</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">predecessors</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="tcp-vs-udp">TCP vs UDP</h2>

<h3 id="tcp-transmission-control-protocol">TCP (Transmission Control Protocol)</h3>
<p><strong>Characteristics</strong>:</p>
<ul>
  <li>Connection-oriented</li>
  <li>Reliable delivery</li>
  <li>Ordered packets</li>
  <li>Flow control</li>
  <li>Congestion control</li>
</ul>

<p><strong>Three-way Handshake</strong>:</p>
<ol>
  <li>SYN →</li>
  <li>← SYN-ACK</li>
  <li>ACK →</li>
</ol>

<p><strong>Use Cases</strong>:</p>
<ul>
  <li>Web browsing (HTTP)</li>
  <li>Email (SMTP)</li>
  <li>File transfer (FTP)</li>
  <li>SSH</li>
</ul>

<h3 id="udp-user-datagram-protocol">UDP (User Datagram Protocol)</h3>
<p><strong>Characteristics</strong>:</p>
<ul>
  <li>Connectionless</li>
  <li>No delivery guarantee</li>
  <li>No ordering</li>
  <li>Lower overhead</li>
  <li>Faster</li>
</ul>

<p><strong>Use Cases</strong>:</p>
<ul>
  <li>DNS queries</li>
  <li>VoIP</li>
  <li>Video streaming</li>
  <li>Gaming</li>
  <li>DHCP</li>
</ul>

<h2 id="common-protocols">Common Protocols</h2>

<h3 id="httphttps">HTTP/HTTPS</h3>
<p>Web communication protocol.</p>

<p><strong>HTTP Methods</strong>:</p>
<ul>
  <li>GET: Retrieve resource</li>
  <li>POST: Submit data</li>
  <li>PUT: Update resource</li>
  <li>DELETE: Remove resource</li>
  <li>HEAD: Headers only</li>
  <li>OPTIONS: Available methods</li>
</ul>

<p><strong>Status Codes</strong>:</p>
<ul>
  <li>1xx: Informational</li>
  <li>2xx: Success (200 OK)</li>
  <li>3xx: Redirection (301 Moved)</li>
  <li>4xx: Client error (404 Not Found)</li>
  <li>5xx: Server error (500 Internal Error)</li>
</ul>

<h3 id="dns-domain-name-system">DNS (Domain Name System)</h3>
<p>Translates domain names to IP addresses.</p>

<p><strong>Record Types</strong>:</p>
<ul>
  <li>A: IPv4 address</li>
  <li>AAAA: IPv6 address</li>
  <li>CNAME: Canonical name (alias)</li>
  <li>MX: Mail exchange</li>
  <li>TXT: Text information</li>
  <li>NS: Name server</li>
  <li>SOA: Start of authority</li>
</ul>

<p><strong>DNS Query Process</strong>:</p>
<ol>
  <li>Check local cache</li>
  <li>Query recursive resolver</li>
  <li>Query root server</li>
  <li>Query TLD server</li>
  <li>Query authoritative server</li>
</ol>

<h3 id="dhcp-dynamic-host-configuration-protocol">DHCP (Dynamic Host Configuration Protocol)</h3>
<p>Automatically assigns IP addresses.</p>

<p><strong>DORA Process</strong>:</p>
<ol>
  <li><strong>Discover</strong>: Client broadcasts request</li>
  <li><strong>Offer</strong>: Server offers configuration</li>
  <li><strong>Request</strong>: Client requests offered config</li>
  <li><strong>Acknowledge</strong>: Server confirms</li>
</ol>

<h3 id="ssh-secure-shell">SSH (Secure Shell)</h3>
<p>Encrypted remote access protocol.</p>

<p><strong>Key-based Authentication</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate key pair</span>
ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096

<span class="c"># Copy public key to server</span>
ssh-copy-id user@server

<span class="c"># Connect using key</span>
ssh <span class="nt">-i</span> ~/.ssh/id_rsa user@server
</code></pre></div></div>

<h2 id="routing">Routing</h2>

<h3 id="static-routing">Static Routing</h3>
<p>Manually configured routes.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add route</span>
ip route add 10.0.0.0/8 via 192.168.1.1

<span class="c"># Delete route</span>
ip route del 10.0.0.0/8

<span class="c"># Show routing table</span>
ip route show
</code></pre></div></div>

<h3 id="dynamic-routing-protocols">Dynamic Routing Protocols</h3>

<p><strong>Interior Gateway Protocols (IGP)</strong>:</p>
<ul>
  <li><strong>RIP</strong>: Distance vector, hop count metric</li>
  <li><strong>OSPF</strong>: Link state, cost metric</li>
  <li><strong>EIGRP</strong>: Hybrid, Cisco proprietary</li>
</ul>

<p><strong>Exterior Gateway Protocol (EGP)</strong>:</p>
<ul>
  <li><strong>BGP</strong>: Path vector, used between ISPs</li>
</ul>

<h3 id="nat-network-address-translation">NAT (Network Address Translation)</h3>
<p>Translates private IPs to public IPs.</p>

<p><strong>Types</strong>:</p>
<ul>
  <li>Static NAT: One-to-one mapping</li>
  <li>Dynamic NAT: Pool of public IPs</li>
  <li>PAT/Overload: Many-to-one using ports</li>
</ul>

<h2 id="vlans">VLANs</h2>

<p>Virtual LANs segment networks logically.</p>

<p><strong>Benefits</strong>:</p>
<ul>
  <li>Security isolation</li>
  <li>Broadcast domain reduction</li>
  <li>Flexible network design</li>
  <li>QoS implementation</li>
</ul>

<p><strong>Configuration Example</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create VLAN
vlan 10
 name Sales

# Assign port to VLAN
interface GigabitEthernet0/1
 switchport mode access
 switchport access vlan 10

# Configure trunk
interface GigabitEthernet0/24
 switchport mode trunk
 switchport trunk allowed vlan 10,20,30
</code></pre></div></div>

<h2 id="network-security">Network Security</h2>

<h3 id="firewalls">Firewalls</h3>
<p>Filter traffic based on rules.</p>

<p><strong>Types</strong>:</p>
<ul>
  <li>Packet filtering</li>
  <li>Stateful inspection</li>
  <li>Application layer</li>
  <li>Next-generation (NGFW)</li>
</ul>

<h3 id="vpn-virtual-private-network">VPN (Virtual Private Network)</h3>
<p>Creates encrypted tunnels.</p>

<p><strong>Types</strong>:</p>
<ul>
  <li>Site-to-site</li>
  <li>Remote access</li>
  <li>SSL/TLS VPN</li>
  <li>IPSec</li>
</ul>

<h3 id="access-control-lists-acls">Access Control Lists (ACLs)</h3>
<p>Define permitted/denied traffic.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Cisco ACL example
access-list 100 permit tcp any host 192.168.1.10 eq 80
access-list 100 deny ip any any
</code></pre></div></div>

<h2 id="quality-of-service-qos">Quality of Service (QoS)</h2>

<p>Prioritizes network traffic.</p>

<p><strong>Methods</strong>:</p>
<ul>
  <li>Classification and marking</li>
  <li>Queuing</li>
  <li>Policing and shaping</li>
  <li>Congestion avoidance</li>
</ul>

<p><strong>Common QoS Models</strong>:</p>
<ul>
  <li>Best Effort</li>
  <li>IntServ (Integrated Services)</li>
  <li>DiffServ (Differentiated Services)</li>
</ul>

<h2 id="network-troubleshooting">Network Troubleshooting</h2>

<h3 id="common-tools">Common Tools</h3>

<p><strong>ping</strong>: Test connectivity</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ping <span class="nt">-c</span> 4 google.com
</code></pre></div></div>

<p><strong>traceroute</strong>: Show path to destination</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>traceroute google.com
</code></pre></div></div>

<p><strong>netstat</strong>: Display connections</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat <span class="nt">-tulpn</span>
</code></pre></div></div>

<p><strong>tcpdump</strong>: Capture packets</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tcpdump <span class="nt">-i</span> eth0 <span class="nt">-w</span> capture.pcap
</code></pre></div></div>

<p><strong>nmap</strong>: Network discovery</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-p</span> 1-1000 192.168.1.0/24
</code></pre></div></div>

<p><strong>dig</strong>: DNS lookup</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dig @8.8.8.8 example.com
</code></pre></div></div>

<h3 id="common-issues">Common Issues</h3>

<p><strong>No Connectivity</strong>:</p>
<ol>
  <li>Check physical connection</li>
  <li>Verify IP configuration</li>
  <li>Test default gateway</li>
  <li>Check DNS resolution</li>
  <li>Verify firewall rules</li>
</ol>

<p><strong>Slow Performance</strong>:</p>
<ol>
  <li>Check bandwidth utilization</li>
  <li>Look for packet loss</li>
  <li>Measure latency</li>
  <li>Check for duplex mismatch</li>
  <li>Verify MTU settings</li>
</ol>

<h2 id="advanced-topics">Advanced Topics</h2>

<h3 id="sdn-software-defined-networking">SDN (Software-Defined Networking)</h3>
<p>Separates control plane from data plane.</p>

<p><strong>Components</strong>:</p>
<ul>
  <li>Controller: Centralized management</li>
  <li>Southbound API: Controller to switches (OpenFlow)</li>
  <li>Northbound API: Applications to controller</li>
</ul>

<h3 id="network-function-virtualization-nfv">Network Function Virtualization (NFV)</h3>
<p>Virtualizes network services.</p>

<p><strong>Examples</strong>:</p>
<ul>
  <li>Virtual routers</li>
  <li>Virtual firewalls</li>
  <li>Virtual load balancers</li>
</ul>

<h3 id="mpls-multiprotocol-label-switching">MPLS (Multiprotocol Label Switching)</h3>
<p>Forwards packets based on labels.</p>

<p><strong>Benefits</strong>:</p>
<ul>
  <li>Traffic engineering</li>
  <li>QoS support</li>
  <li>VPN services</li>
  <li>Reduced routing lookups</li>
</ul>

<h3 id="ipv6-transition">IPv6 Transition</h3>
<p><strong>Mechanisms</strong>:</p>
<ul>
  <li>Dual stack</li>
  <li>Tunneling (6to4, Teredo)</li>
  <li>Translation (NAT64)</li>
</ul>

<h2 id="cloud-networking">Cloud Networking</h2>

<h3 id="virtual-private-cloud-vpc">Virtual Private Cloud (VPC)</h3>
<p>Isolated network in cloud.</p>

<p><strong>Components</strong>:</p>
<ul>
  <li>Subnets</li>
  <li>Route tables</li>
  <li>Internet gateway</li>
  <li>NAT gateway</li>
  <li>Security groups</li>
</ul>

<h3 id="load-balancing">Load Balancing</h3>
<p>Distributes traffic across servers.</p>

<p><strong>Types</strong>:</p>
<ul>
  <li>Layer 4 (Transport)</li>
  <li>Layer 7 (Application)</li>
  <li>Global vs Regional</li>
</ul>

<p><strong>Algorithms</strong>:</p>
<ul>
  <li>Round robin</li>
  <li>Least connections</li>
  <li>IP hash</li>
  <li>Weighted</li>
</ul>

<h3 id="content-delivery-networks-cdn">Content Delivery Networks (CDN)</h3>
<p>Caches content at edge locations.</p>

<p><strong>Benefits</strong>:</p>
<ul>
  <li>Reduced latency</li>
  <li>Decreased bandwidth costs</li>
  <li>Improved availability</li>
  <li>DDoS protection</li>
</ul>

<h2 id="advanced-sdn-and-network-programmability">Advanced SDN and Network Programmability</h2>

<h3 id="openflow-controller-implementation">OpenFlow Controller Implementation</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SDNController</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Software-Defined Network Controller</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">switches</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">topology</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nc">Graph</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">flow_tables</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">packet_in_handlers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">statistics</span> <span class="o">=</span> <span class="nf">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">packets</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sh">'</span><span class="s">bytes</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
        
    <span class="k">def</span> <span class="nf">handle_switch_connect</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">switch_id</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Handle switch connection</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">switches</span><span class="p">[</span><span class="n">switch_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">features</span><span class="sh">'</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ports</span><span class="sh">'</span><span class="p">:</span> <span class="n">features</span><span class="p">[</span><span class="sh">'</span><span class="s">ports</span><span class="sh">'</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">flow_table_size</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
        
        <span class="c1"># Install default flows
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">install_default_flows</span><span class="p">(</span><span class="n">switch_id</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">install_flow</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">switch_id</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">idle_timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Install OpenFlow rule</span><span class="sh">"""</span>
        <span class="n">flow_mod</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">match</span><span class="sh">'</span><span class="p">:</span> <span class="n">match</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">actions</span><span class="sh">'</span><span class="p">:</span> <span class="n">actions</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">priority</span><span class="sh">'</span><span class="p">:</span> <span class="n">priority</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">idle_timeout</span><span class="sh">'</span><span class="p">:</span> <span class="n">idle_timeout</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">cookie</span><span class="sh">'</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">flow_tables</span><span class="p">[</span><span class="n">switch_id</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">flow_mod</span><span class="p">)</span>
        
        <span class="c1"># Send to switch
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">send_flow_mod</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">flow_mod</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">handle_packet_in</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">switch_id</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">packet_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Handle packet not matching any flow</span><span class="sh">"""</span>
        <span class="c1"># Parse packet
</span>        <span class="n">packet</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">parse_packet</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span>
        
        <span class="c1"># Learn source MAC
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">mac_learning</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">packet</span><span class="p">[</span><span class="sh">'</span><span class="s">src_mac</span><span class="sh">'</span><span class="p">],</span> <span class="n">port</span><span class="p">)</span>
        
        <span class="c1"># Find destination
</span>        <span class="n">out_port</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">find_destination</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">packet</span><span class="p">[</span><span class="sh">'</span><span class="s">dst_mac</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">out_port</span><span class="p">:</span>
            <span class="c1"># Install flow for future packets
</span>            <span class="n">match</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">eth_dst</span><span class="sh">'</span><span class="p">:</span> <span class="n">packet</span><span class="p">[</span><span class="sh">'</span><span class="s">dst_mac</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">eth_src</span><span class="sh">'</span><span class="p">:</span> <span class="n">packet</span><span class="p">[</span><span class="sh">'</span><span class="s">src_mac</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[{</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">output</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">port</span><span class="sh">'</span><span class="p">:</span> <span class="n">out_port</span><span class="p">}]</span>
            
            <span class="n">self</span><span class="p">.</span><span class="nf">install_flow</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                            <span class="n">idle_timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
            
            <span class="c1"># Send current packet
</span>            <span class="n">self</span><span class="p">.</span><span class="nf">packet_out</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">packet_data</span><span class="p">,</span> <span class="n">out_port</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Flood
</span>            <span class="n">self</span><span class="p">.</span><span class="nf">packet_out</span><span class="p">(</span><span class="n">switch_id</span><span class="p">,</span> <span class="n">packet_data</span><span class="p">,</span> <span class="sh">'</span><span class="s">FLOOD</span><span class="sh">'</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">calculate_paths</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Calculate all shortest paths in topology</span><span class="sh">"""</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">topology</span><span class="p">.</span><span class="nf">nodes</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">dst</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">topology</span><span class="p">.</span><span class="nf">nodes</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">dst</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Primary path
</span>                        <span class="n">path</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">shortest_path</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> 
                                              <span class="n">weight</span><span class="o">=</span><span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">)</span>
                        
                        <span class="c1"># Backup path (node-disjoint)
</span>                        <span class="n">temp_graph</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">topology</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
                        <span class="c1"># Remove intermediate nodes from primary path
</span>                        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="n">temp_graph</span><span class="p">.</span><span class="nf">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                            
                        <span class="n">backup_path</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">backup_path</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">shortest_path</span><span class="p">(</span><span class="n">temp_graph</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span>
                                                         <span class="n">weight</span><span class="o">=</span><span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">)</span>
                        <span class="k">except</span> <span class="n">nx</span><span class="p">.</span><span class="n">NetworkXNoPath</span><span class="p">:</span>
                            <span class="k">pass</span>
                            
                        <span class="n">paths</span><span class="p">[(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="sh">'</span><span class="s">primary</span><span class="sh">'</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">backup</span><span class="sh">'</span><span class="p">:</span> <span class="n">backup_path</span>
                        <span class="p">}</span>
                    <span class="k">except</span> <span class="n">nx</span><span class="p">.</span><span class="n">NetworkXNoPath</span><span class="p">:</span>
                        <span class="n">paths</span><span class="p">[(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">primary</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="sh">'</span><span class="s">backup</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
                        
        <span class="k">return</span> <span class="n">paths</span>
</code></pre></div></div>

<h3 id="p4-programmable-data-plane">P4 Programmable Data Plane</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">P4DataPlane</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">P4 programmable switch implementation</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tables</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">parsers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span> <span class="nf">define_parser</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Define packet parser in P4 style</span><span class="sh">"""</span>
        <span class="n">parser_def</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
        parser MyParser(packet_in packet,
                       out headers hdr,
                       inout metadata meta,
                       inout standard_metadata_t standard_metadata) {
            
            state start {
                transition parse_ethernet;
            }
            
            state parse_ethernet {
                packet.extract(hdr.ethernet);
                transition select(hdr.ethernet.etherType) {
                    0x0800: parse_ipv4;
                    0x86DD: parse_ipv6;
                    default: accept;
                }
            }
            
            state parse_ipv4 {
                packet.extract(hdr.ipv4);
                transition select(hdr.ipv4.protocol) {
                    6: parse_tcp;
                    17: parse_udp;
                    default: accept;
                }
            }
            
            state parse_tcp {
                packet.extract(hdr.tcp);
                transition accept;
            }
        }
        </span><span class="sh">'''</span>
        <span class="k">return</span> <span class="n">parser_def</span>
        
    <span class="k">def</span> <span class="nf">define_match_action_table</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">match_fields</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Define match-action table</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">match_fields</span><span class="sh">'</span><span class="p">:</span> <span class="n">match_fields</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">actions</span><span class="sh">'</span><span class="p">:</span> <span class="n">actions</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">entries</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">default_action</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">size</span><span class="sh">'</span><span class="p">:</span> <span class="n">size</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">add_table_entry</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">match_values</span><span class="p">,</span> <span class="n">action_name</span><span class="p">,</span> <span class="n">action_params</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Add entry to match-action table</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">tables</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Table </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s"> not found</span><span class="sh">"</span><span class="p">)</span>
            
        <span class="c1"># Create match key
</span>        <span class="n">match_key</span> <span class="o">=</span> <span class="nf">tuple</span><span class="p">(</span><span class="n">match_values</span><span class="p">)</span>
        
        <span class="c1"># Add entry
</span>        <span class="n">self</span><span class="p">.</span><span class="n">tables</span><span class="p">[</span><span class="n">table_name</span><span class="p">][</span><span class="sh">'</span><span class="s">entries</span><span class="sh">'</span><span class="p">][</span><span class="n">match_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">:</span> <span class="n">action_name</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">params</span><span class="sh">'</span><span class="p">:</span> <span class="n">action_params</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">process_packet</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">packet</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Process packet through P4 pipeline</span><span class="sh">"""</span>
        <span class="c1"># Parse packet
</span>        <span class="n">headers</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">parse_packet</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">ingress_port</span><span class="sh">'</span><span class="p">:</span> <span class="n">packet</span><span class="p">.</span><span class="n">ingress_port</span><span class="p">}</span>
        
        <span class="c1"># Ingress pipeline
</span>        <span class="n">headers</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">ingress_pipeline</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
        
        <span class="c1"># Egress decision
</span>        <span class="k">if</span> <span class="n">metadata</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">drop</span><span class="sh">'</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>
            
        <span class="c1"># Egress pipeline
</span>        <span class="n">headers</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">egress_pipeline</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
        
        <span class="c1"># Deparse
</span>        <span class="n">output_packet</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">deparse_packet</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">output_packet</span><span class="p">,</span> <span class="n">metadata</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">egress_port</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="network-function-virtualization">Network Function Virtualization</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">VirtualNetworkFunction</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Base class for VNFs</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cpu_cores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">memory_mb</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cpu_cores</span> <span class="o">=</span> <span class="n">cpu_cores</span>
        <span class="n">self</span><span class="p">.</span><span class="n">memory_mb</span> <span class="o">=</span> <span class="n">memory_mb</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rx_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nc">Queue</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tx_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nc">Queue</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">statistics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">packets_processed</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">packets_dropped</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">processing_time_ms</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">process_packet</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">packet</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Override in subclasses</span><span class="sh">"""</span>
        <span class="k">raise</span> <span class="nb">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Main processing loop</span><span class="sh">"""</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">packet</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rx_queue</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
                
                <span class="c1"># Process packet
</span>                <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">process_packet</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">tx_queue</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">statistics</span><span class="p">[</span><span class="sh">'</span><span class="s">packets_processed</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">statistics</span><span class="p">[</span><span class="sh">'</span><span class="s">packets_dropped</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    
                <span class="c1"># Record processing time
</span>                <span class="n">proc_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
                <span class="n">self</span><span class="p">.</span><span class="n">statistics</span><span class="p">[</span><span class="sh">'</span><span class="s">processing_time_ms</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">proc_time</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="n">queue</span><span class="p">.</span><span class="n">Empty</span><span class="p">:</span>
                <span class="k">continue</span>

<span class="k">class</span> <span class="nc">VirtualFirewall</span><span class="p">(</span><span class="n">VirtualNetworkFunction</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Stateful firewall VNF</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">rules_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">load_rules</span><span class="p">(</span><span class="n">rules_file</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection_table</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection_timeout</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># seconds
</span>        
    <span class="k">def</span> <span class="nf">process_packet</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">packet</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Apply firewall rules</span><span class="sh">"""</span>
        <span class="c1"># Check established connections
</span>        <span class="n">conn_key</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_connection_key</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">conn_key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">connection_table</span><span class="p">:</span>
            <span class="c1"># Update timestamp
</span>            <span class="n">self</span><span class="p">.</span><span class="n">connection_table</span><span class="p">[</span><span class="n">conn_key</span><span class="p">][</span><span class="sh">'</span><span class="s">last_seen</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">packet</span>
            
        <span class="c1"># Check rules
</span>        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">match_rule</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">rule</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">allow</span><span class="sh">'</span><span class="p">:</span>
                    <span class="c1"># Add to connection table
</span>                    <span class="n">self</span><span class="p">.</span><span class="n">connection_table</span><span class="p">[</span><span class="n">conn_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="sh">'</span><span class="s">created</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">(),</span>
                        <span class="sh">'</span><span class="s">last_seen</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">(),</span>
                        <span class="sh">'</span><span class="s">packets</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span>
                    <span class="p">}</span>
                    <span class="k">return</span> <span class="n">packet</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">None</span>  <span class="c1"># Drop
</span>                    
        <span class="c1"># Default deny
</span>        <span class="k">return</span> <span class="bp">None</span>

<span class="k">class</span> <span class="nc">ServiceFunctionChain</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Chain multiple VNFs</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">vnfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">add_vnf</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">vnf</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Add VNF to chain</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">vnfs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">vnf</span><span class="p">)</span>
        
        <span class="c1"># Create link queues
</span>        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">vnfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">link_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nc">Queue</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="n">links</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link_queue</span><span class="p">)</span>
            
            <span class="c1"># Connect previous VNF output to current input
</span>            <span class="n">self</span><span class="p">.</span><span class="n">vnfs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">].</span><span class="n">tx_queue</span> <span class="o">=</span> <span class="n">link_queue</span>
            <span class="n">self</span><span class="p">.</span><span class="n">vnfs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">rx_queue</span> <span class="o">=</span> <span class="n">link_queue</span>
            
    <span class="k">def</span> <span class="nf">deploy</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Deploy service chain</span><span class="sh">"""</span>
        <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">vnf</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">vnfs</span><span class="p">:</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">vnf</span><span class="p">.</span><span class="n">run</span><span class="p">)</span>
            <span class="n">thread</span><span class="p">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">thread</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
            <span class="n">threads</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">threads</span>
</code></pre></div></div>

<h2 id="network-performance-analysis">Network Performance Analysis</h2>

<h3 id="advanced-traffic-modeling">Advanced Traffic Modeling</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TrafficGenerator</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Generate realistic network traffic patterns</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">poisson</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">poisson_traffic</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">self_similar</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">self_similar_traffic</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">mmpp</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">mmpp_traffic</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">heavy_tail</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">heavy_tail_traffic</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">poisson_traffic</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">duration</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Generate Poisson traffic</span><span class="sh">"""</span>
        <span class="n">timestamps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">exponential</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">rate</span><span class="p">)</span>
            <span class="n">current_time</span> <span class="o">+=</span> <span class="n">interval</span>
            <span class="k">if</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
                <span class="n">timestamps</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">timestamps</span>
    
    <span class="k">def</span> <span class="nf">self_similar_traffic</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">FGN</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Generate self-similar traffic using Fractional Gaussian Noise</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="sh">'</span><span class="s">FGN</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># Generate FGN with Hurst parameter H
</span>            <span class="n">n</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
            
            <span class="c1"># Covariance matrix
</span>            <span class="n">cov_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">cov_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">H</span><span class="p">)</span> <span class="o">+</span> 
                                              <span class="nf">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">H</span><span class="p">)</span> <span class="o">-</span> 
                                              <span class="mi">2</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">H</span><span class="p">))</span>
                    
            <span class="c1"># Generate using Cholesky decomposition
</span>            <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">cholesky</span><span class="p">(</span><span class="n">cov_matrix</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">fgn</span> <span class="o">=</span> <span class="n">L</span> <span class="o">@</span> <span class="n">z</span>
            
            <span class="c1"># Convert to arrival process
</span>            <span class="n">arrivals</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">fgn</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">arrivals</span>
</code></pre></div></div>

<h2 id="network-monitoring">Network Monitoring</h2>

<h3 id="snmp-simple-network-management-protocol">SNMP (Simple Network Management Protocol)</h3>
<p>Monitor and manage network devices.</p>

<p><strong>Components</strong>:</p>
<ul>
  <li>Manager: Monitoring system</li>
  <li>Agent: Device software</li>
  <li>MIB: Management Information Base</li>
</ul>

<h3 id="netflowsflow">NetFlow/sFlow</h3>
<p>Collect traffic flow data.</p>

<p><strong>Use Cases</strong>:</p>
<ul>
  <li>Traffic analysis</li>
  <li>Security monitoring</li>
  <li>Capacity planning</li>
  <li>Billing</li>
</ul>

<h3 id="network-performance-metrics">Network Performance Metrics</h3>
<ul>
  <li><strong>Bandwidth</strong>: Maximum data rate</li>
  <li><strong>Throughput</strong>: Actual data rate</li>
  <li><strong>Latency</strong>: Delay in transmission</li>
  <li><strong>Jitter</strong>: Variation in latency</li>
  <li><strong>Packet loss</strong>: Dropped packets</li>
</ul>

<h2 id="best-practices">Best Practices</h2>

<h3 id="network-design">Network Design</h3>
<ul>
  <li>Follow hierarchical model (core, distribution, access)</li>
  <li>Implement redundancy</li>
  <li>Use standard protocols</li>
  <li>Document everything</li>
  <li>Plan for growth</li>
</ul>

<h3 id="security">Security</h3>
<ul>
  <li>Implement defense in depth</li>
  <li>Use strong encryption</li>
  <li>Regular security audits</li>
  <li>Keep firmware updated</li>
  <li>Monitor for anomalies</li>
</ul>

<h3 id="performance">Performance</h3>
<ul>
  <li>Optimize routing paths</li>
  <li>Implement QoS appropriately</li>
  <li>Monitor utilization</li>
  <li>Use caching where possible</li>
  <li>Regular capacity planning</li>
</ul>

<h2 id="research-frontiers-in-networking">Research Frontiers in Networking</h2>

<h3 id="information-centric-networking-icn">Information-Centric Networking (ICN)</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NamedDataNetworking</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">NDN/CCN implementation</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">content_store</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Cache
</span>        <span class="n">self</span><span class="p">.</span><span class="n">pit</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Pending Interest Table
</span>        <span class="n">self</span><span class="p">.</span><span class="n">fib</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Forwarding Information Base
</span>        
    <span class="k">def</span> <span class="nf">handle_interest</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">incoming_face</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Process Interest packet</span><span class="sh">"""</span>
        <span class="c1"># Check content store
</span>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">content_store</span><span class="p">:</span>
            <span class="c1"># Cache hit - return data
</span>            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">content_store</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            
        <span class="c1"># Check PIT
</span>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">pit</span><span class="p">:</span>
            <span class="c1"># Add incoming face to existing entry
</span>            <span class="n">self</span><span class="p">.</span><span class="n">pit</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="sh">'</span><span class="s">faces</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">incoming_face</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create new PIT entry
</span>            <span class="n">self</span><span class="p">.</span><span class="n">pit</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">faces</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="n">incoming_face</span><span class="p">},</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="p">}</span>
            
        <span class="c1"># Forward based on FIB
</span>        <span class="n">next_hops</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">fib_lookup</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">next_hop</span> <span class="ow">in</span> <span class="n">next_hops</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">next_hop</span> <span class="o">!=</span> <span class="n">incoming_face</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="nf">forward_interest</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">next_hop</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h3 id="network-coding">Network Coding</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NetworkCoding</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Random Linear Network Coding</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">field_size</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">field_size</span> <span class="o">=</span> <span class="n">field_size</span>
        
    <span class="k">def</span> <span class="nf">encode_generation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">packets</span><span class="p">,</span> <span class="n">num_coded</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Create coded packets from generation</span><span class="sh">"""</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">packets</span><span class="p">)</span>
        <span class="n">coded_packets</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_coded</span><span class="p">):</span>
            <span class="c1"># Random coefficients
</span>            <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">field_size</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            
            <span class="c1"># Linear combination in finite field
</span>            <span class="n">coded_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros_like</span><span class="p">(</span><span class="n">packets</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">packet</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">packets</span><span class="p">):</span>
                <span class="n">coded_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">coded_data</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">packet</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">field_size</span>
                
            <span class="n">coded_packets</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">coefficients</span><span class="sh">'</span><span class="p">:</span> <span class="n">coeffs</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">:</span> <span class="n">coded_data</span>
            <span class="p">})</span>
            
        <span class="k">return</span> <span class="n">coded_packets</span>
    
    <span class="k">def</span> <span class="nf">decode_generation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">coded_packets</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Decode using Gaussian elimination</span><span class="sh">"""</span>
        <span class="c1"># Build coefficient matrix
</span>        <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">coded_packets</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">pkt</span><span class="p">[</span><span class="sh">'</span><span class="s">coefficients</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">pkt</span> <span class="ow">in</span> <span class="n">coded_packets</span><span class="p">])</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">pkt</span><span class="p">[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">pkt</span> <span class="ow">in</span> <span class="n">coded_packets</span><span class="p">])</span>
        
        <span class="c1"># Solve in finite field
</span>        <span class="n">decoded</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">gaussian_elimination_gf</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">decoded</span>
</code></pre></div></div>

<h3 id="quantum-networking">Quantum Networking</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QuantumNetwork</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Quantum network protocols</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">quantum_teleportation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">alice_qubit</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Teleport quantum state</span><span class="sh">"""</span>
        <span class="c1"># Create entangled pair
</span>        <span class="n">bell_pair</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_bell_pair</span><span class="p">()</span>
        
        <span class="c1"># Alice performs Bell measurement
</span>        <span class="n">measurement</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">bell_measurement</span><span class="p">(</span><span class="n">alice_qubit</span><span class="p">,</span> <span class="n">bell_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="c1"># Send classical bits to Bob
</span>        <span class="n">classical_bits</span> <span class="o">=</span> <span class="n">measurement</span>
        
        <span class="c1"># Bob applies corrections
</span>        <span class="n">bob_qubit</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">apply_corrections</span><span class="p">(</span><span class="n">bell_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">classical_bits</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">bob_qubit</span>
    
    <span class="k">def</span> <span class="nf">quantum_key_distribution</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">BB84 QKD protocol</span><span class="sh">"""</span>
        <span class="c1"># Alice prepares random bits in random bases
</span>        <span class="n">alice_bits</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
        <span class="n">alice_bases</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
        
        <span class="c1"># Bob measures in random bases
</span>        <span class="n">bob_bases</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
        
        <span class="c1"># Sift key
</span>        <span class="n">matching_bases</span> <span class="o">=</span> <span class="n">alice_bases</span> <span class="o">==</span> <span class="n">bob_bases</span>
        <span class="n">sifted_key</span> <span class="o">=</span> <span class="n">alice_bits</span><span class="p">[</span><span class="n">matching_bases</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">sifted_key</span>
</code></pre></div></div>

<h2 id="references-and-further-reading">References and Further Reading</h2>

<h3 id="graduate-level-textbooks">Graduate-Level Textbooks</h3>
<ol>
  <li><strong>Peterson &amp; Davie</strong> - “Computer Networks: A Systems Approach” (6th Edition)</li>
  <li><strong>Kurose &amp; Ross</strong> - “Computer Networking: A Top-Down Approach” (8th Edition)</li>
  <li><strong>Bertsekas &amp; Gallager</strong> - “Data Networks” (2nd Edition)</li>
  <li><strong>Kleinrock</strong> - “Queueing Systems” (Volumes 1 &amp; 2)</li>
</ol>

<h3 id="research-papers">Research Papers</h3>
<ol>
  <li><strong>Congestion Control</strong>
    <ul>
      <li>Jacobson (1988) - “Congestion Avoidance and Control”</li>
      <li>Cardwell et al. (2016) - “BBR: Congestion-Based Congestion Control”</li>
    </ul>
  </li>
  <li><strong>Software-Defined Networking</strong>
    <ul>
      <li>McKeown et al. (2008) - “OpenFlow: Enabling Innovation in Campus Networks”</li>
      <li>Kreutz et al. (2015) - “Software-Defined Networking: A Comprehensive Survey”</li>
    </ul>
  </li>
  <li><strong>Network Coding</strong>
    <ul>
      <li>Ahlswede et al. (2000) - “Network Information Flow”</li>
      <li>Ho et al. (2006) - “A Random Linear Network Coding Approach”</li>
    </ul>
  </li>
  <li><strong>Future Internet Architectures</strong>
    <ul>
      <li>Jacobson et al. (2009) - “Networking Named Content”</li>
      <li>Clark et al. (2018) - “The Design Philosophy of the DARPA Internet Protocols”</li>
    </ul>
  </li>
</ol>

<h3 id="advanced-research-topics">Advanced Research Topics</h3>
<ol>
  <li><strong>Programmable Networks</strong> - P4, eBPF, XDP</li>
  <li><strong>Time-Sensitive Networking</strong> - Deterministic latency</li>
  <li><strong>Network Verification</strong> - Formal methods for networks</li>
  <li><strong>Machine Learning for Networks</strong> - AI-driven optimization</li>
  <li><strong>Edge Computing</strong> - MEC, fog computing architectures</li>
</ol>

<h2 id="see-also">See Also</h2>
<ul>
  <li><a href="cybersecurity.html">Cybersecurity</a> - Network security details</li>
  <li><a href="aws.html">AWS</a> - Cloud networking</li>
  <li><a href="docker.html">Docker</a> - Container networking</li>
  <li><a href="kubernetes.html">Kubernetes</a> - Cluster networking</li>
  <li><a href="quantumcomputing.html">Quantum Computing</a> - Quantum communication</li>
</ul>
